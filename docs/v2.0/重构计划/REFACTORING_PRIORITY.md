# æ¨¡å—é‡æ„ä¼˜å…ˆçº§æ’åºæ¨¡å‹

> ç‰ˆæœ¬ï¼šv1.0
> æ—¥æœŸï¼š2026-02-18

---

## ä¸€ã€ä¼˜å…ˆçº§è®¡ç®—å…¬å¼

```
ä¼˜å…ˆçº§ = (é£é™© Ã— å½±å“é¢ Ã— ä¿®æ”¹éš¾åº¦ç³»æ•°)
```

| å› å­ | è¯´æ˜ |
|:-----|:-----|
| é£é™© | å½“å‰æ¨¡å—é£é™©ç­‰çº§ (1-5) |
| å½±å“é¢ | å½±å“å…¶ä»–æ¨¡å—æ•°é‡ (1-5) |
| ä¿®æ”¹éš¾åº¦ | é‡æ„éš¾åº¦ (1-5ï¼Œè¶Šé«˜è¶Šéš¾) |

---

## äºŒã€å…¸å‹æ¨¡å—é£é™©æ’åº

### ğŸ”´ ç¬¬ä¸€ä¼˜å…ˆçº§ï¼šExecutor

**åŸå› **ï¼š
- æ€§èƒ½æ ¸å¿ƒ
- æœ€å®¹æ˜“å˜æˆ"ä¸Šå¸æ¨¡å—"
- ä¸ planner/storage é«˜è€¦åˆ

**å¿…é¡»**ï¼š
- æŠ½è±¡ trait
- å¼•å…¥ PhysicalPlan
- å»æ‰ä¸šåŠ¡é€»è¾‘æ‚ç³…

**è¯„åˆ†**ï¼š

| å› å­ | åˆ†å€¼ | è¯´æ˜ |
|:-----|:-----|:-----|
| é£é™© | 5 | é«˜è€¦åˆé£é™© |
| å½±å“é¢ | 5 | å½±å“æ‰€æœ‰æŸ¥è¯¢ |
| ä¿®æ”¹éš¾åº¦ | 4 | é‡æ„è¾ƒå¤æ‚ |
| **ä¼˜å…ˆçº§** | **100** | æœ€é«˜ä¼˜å…ˆçº§ |

---

### ğŸŸ  ç¬¬äºŒä¼˜å…ˆçº§ï¼šPlanner

**åŸå› **ï¼š
- å†³å®šæ‰§è¡Œç­–ç•¥
- å½±å“æ‰©å±•æ€§

**å¿…é¡»**ï¼š
- è¾“å‡º IR
- ä¸ä¾èµ– storage

**è¯„åˆ†**ï¼š

| å› å­ | åˆ†å€¼ | è¯´æ˜ |
|:-----|:-----|:-----|
| é£é™© | 4 | å½±å“æ‰§è¡Œæ•ˆç‡ |
| å½±å“é¢ | 4 | å½±å“æ‰€æœ‰æŸ¥è¯¢ |
| ä¿®æ”¹éš¾åº¦ | 3 | ä¸­ç­‰éš¾åº¦ |
| **ä¼˜å…ˆçº§** | **48** | é«˜ä¼˜å…ˆçº§ |

---

### ğŸŸ¡ ç¬¬ä¸‰ä¼˜å…ˆçº§ï¼šStorage

**åŸå› **ï¼š
- æœªæ¥è¦æ”¯æŒå¤šåç«¯

**å¿…é¡»**ï¼š
- StorageEngine trait
- é€‚é…å™¨æ¨¡å¼

**è¯„åˆ†**ï¼š

| å› å­ | åˆ†å€¼ | è¯´æ˜ |
|:-----|:-----|:-----|
| é£é™© | 3 | å½±å“æŒä¹…åŒ– |
| å½±å“é¢ | 4 | å½±å“æ‰€æœ‰æ“ä½œ |
| ä¿®æ”¹éš¾åº¦ | 3 | ä¸­ç­‰éš¾åº¦ |
| **ä¼˜å…ˆçº§** | **36** | ä¸­ä¼˜å…ˆçº§ |

---

### ğŸŸ¢ ç¬¬å››ä¼˜å…ˆçº§ï¼šParser

**åŸå› **ï¼š
- é€šå¸¸é£é™©æœ€ä½

**è¯„åˆ†**ï¼š

| å› å­ | åˆ†å€¼ | è¯´æ˜ |
|:-----|:-----|:-----|
| é£é™© | 2 | ç›¸å¯¹ç‹¬ç«‹ |
| å½±å“é¢ | 3 | å½±å“æŸ¥è¯¢è§£æ |
| ä¿®æ”¹éš¾åº¦ | 2 | è¾ƒç®€å• |
| **ä¼˜å…ˆçº§** | **12** | ä½ä¼˜å…ˆçº§ |

---

## ä¸‰ã€æ¨èé‡æ„é¡ºåº

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          é‡æ„ä¼˜å…ˆçº§æ’åº                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   ä¼˜å…ˆçº§  æ¨¡å—        åˆ†æ•°    åŸå›                                            â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚   P0      Executor    100    æ€§èƒ½æ ¸å¿ƒï¼Œé«˜è€¦åˆ                                â”‚
â”‚   P1      Planner     48     å†³å®šæ‰§è¡Œç­–ç•¥                                    â”‚
â”‚   P2      Storage     36     å¤šåç«¯æ”¯æŒ                                      â”‚
â”‚   P3      API å±‚      24     æ¥å£ç¨³å®šæ€§                                      â”‚
â”‚   P4      Parser      12     ç›¸å¯¹ç‹¬ç«‹                                        â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å››ã€å„æ¨¡å—é‡æ„è¯¦ç»†è®¡åˆ’

### 4.1 Executor é‡æ„

**å½“å‰é—®é¢˜**ï¼š
```rust
âŒ fn execute(query: Query) {
    if query.type == SELECT { ... }
    if query.type == INSERT { ... }
    // å·¨å‹å‡½æ•°
}
```

**ç›®æ ‡ç»“æ„**ï¼š
```rust
âœ… pub trait ExecutionEngine {
    fn execute(&self, plan: PhysicalPlan) -> Result<QueryResult>;
}

âœ… pub struct DefaultExecutor;
âœ… pub struct ParallelExecutor;
```

**æ­¥éª¤**ï¼š
1. å®šä¹‰ ExecutionEngine trait
2. æå– PhysicalPlan
3. å®ç°é»˜è®¤æ‰§è¡Œå™¨
4. æ·»åŠ æµ‹è¯•

---

### 4.2 Planner é‡æ„

**å½“å‰é—®é¢˜**ï¼š
- ç›´æ¥è¾“å‡ºæ‰§è¡Œé€»è¾‘
- æ—  IR ä¸­é—´è¡¨ç¤º

**ç›®æ ‡ç»“æ„**ï¼š
```rust
pub struct LogicalPlan { ... }
pub struct PhysicalPlan { ... }

pub trait Optimizer {
    fn optimize(&self, plan: LogicalPlan) -> PhysicalPlan;
}
```

**æ­¥éª¤**ï¼š
1. å®šä¹‰ LogicalPlan
2. å®šä¹‰ PhysicalPlan
3. å®ç° Optimizer trait
4. è§£è€¦ storage ä¾èµ–

---

### 4.3 Storage é‡æ„

**å½“å‰é—®é¢˜**ï¼š
- å•ä¸€å­˜å‚¨å®ç°
- æ— æŠ½è±¡æ¥å£

**ç›®æ ‡ç»“æ„**ï¼š
```rust
pub trait StorageEngine {
    fn create_table(&mut self, name: &str, schema: Schema) -> Result<()>;
    fn insert(&mut self, table: &str, row: Row) -> Result<()>;
    fn scan(&self, table: &str) -> Result<Vec<Row>>;
}

pub struct MemoryStorage { ... }
pub struct FileStorage { ... }
```

**æ­¥éª¤**ï¼š
1. å®šä¹‰ StorageEngine trait
2. é‡æ„ç°æœ‰å®ç°
3. æ·»åŠ  MemoryStorage é€‚é…å™¨
4. æ·»åŠ  FileStorage é€‚é…å™¨

---

## äº”ã€é‡æ„éªŒæ”¶æ ‡å‡†

| æ¨¡å— | éªŒæ”¶æ ‡å‡† |
|:-----|:---------|
| Executor | trait æŠ½è±¡å®Œæˆï¼Œæ— å·¨å‹å‡½æ•° |
| Planner | IR è¾“å‡ºå®Œæˆï¼Œæ—  storage ä¾èµ– |
| Storage | trait æŠ½è±¡å®Œæˆï¼Œå¤šåç«¯æ”¯æŒ |
| API | å…¬å…±æ¥å£å†»ç»“ |
| Parser | ä¿æŒç¨³å®š |

---

*æœ¬æ–‡æ¡£ç”± TRAE (GLM-5.0) åˆ›å»º*
