# Technical Debt Policy

> 技术债管理制度

---

## 债务分类

| 类型 | 描述 | 处理规则 |
|------|------|----------|
| A 类 | 影响稳定性 | 必须立即修复，禁止发布 |
| B 类 | 影响可维护性 | 记录在 backlog，v1.x 处理 |
| C 类 | 架构优化类 | 延后到 v2.0 |

---

## A 类债务示例

- 生产代码中的 unwrap
- 生产代码中的 panic
- CI 检查失败
- 覆盖率低于阈值

**处理**：必须在发布前清零

---

## B 类债务示例

- 错误信息不统一
- 文档缺失
- 测试覆盖不足
- 代码重复

**处理**：记录在 backlog，按优先级处理

---

## C 类债务示例

- Row-based 执行模型
- 无 CBO 优化器
- 无向量化执行
- 存储引擎未抽象

**处理**：延后到 v2.0，不在 1.x 处理

---

## 债务登记

每个 PR 如引入 debt 必须登记到 `TECH_DEBT.md`：

```markdown
| ID | 类型 | 模块 | 描述 | 等级 | 计划版本 | 状态 |
|----|------|------|------|------|----------|------|
| 1  | 错误 | executor | 生产代码中存在 unwrap | A | v1.0 | 待修复 |
| 2  | 架构 | executor | Row-based 执行模型 | C | v2.0 | 记录 |
```

---

## 处理规则

1. 每个 PR 如引入 debt 必须登记
2. A 类 debt 禁止发布
3. 1.x 不处理 C 类 debt
4. 每月盘点一次

---

## 债务统计

```markdown
| 等级 | 数量 | 说明 |
|------|------|------|
| A 类 | 0 | 必须在发布前清零 |
| B 类 | 3 | 可在 v1.x 期间处理 |
| C 类 | 2 | 延后到 v2.0 |
```

---

## 处理记录

每次处理债务后记录：

```markdown
| 日期 | ID | 处理方式 | PR |
|------|-----|----------|-----|
| 2026-02-20 | 1 | 替换为 ok_or | #45 |
```

---

## 禁止事项

- ❌ 带着 A 类债发布
- ❌ 在 1.x 期间做大规模重构
- ❌ 隐瞒技术债
- ❌ 不登记就引入债务

---

## 债务清理优先级

```
A 类 → 立即处理
B 类 → 按 backlog 优先级
C 类 → v2.0 规划
```
