---
marp: true
theme: gaia
paginate: true
backgroundColor: #fff
color: #333
---

<!-- _class: lead -->

# 第十三讲：安全扫描与审计

## AI增强的软件工程

---

# 课程大纲

1. **软件安全概述**（25分钟）
2. **依赖扫描**（25分钟）
3. **代码扫描**（25分钟）
4. **实践练习**（15分钟）

---

# Part 1: 软件安全概述

---

## 1.1 What：什么是软件安全

### 定义

保护软件系统免受恶意攻击和未授权访问

### 安全目标

- **机密性**：防止信息泄露
- **完整性**：防止信息被篡改
- **可用性**：保证系统可用

### 常见安全威胁

- SQL注入
- 缓冲区溢出
- 跨站脚本（XSS）
- 跨站请求伪造（CSRF）

---

## 1.2 Why：为什么需要安全扫描

### 数据保护

- 保护用户数据
- 防止数据泄露
- 符合隐私法规

### 业务连续性

- 防止攻击导致服务中断
- 保证业务正常运行
- 降低安全风险

### 合规要求

- 满足安全合规要求
- 通过安全审计
- 避免法律风险

---

## 1.3 How：安全扫描方法

### 静态分析（SAST）

- 分析源代码
- 发现潜在漏洞
- 早期发现安全问题

### 动态分析（DAST）

- 运行时分析
- 模拟攻击
- 发现运行时漏洞

### 依赖扫描（SCA）

- 扫描第三方依赖
- 发现已知漏洞
- 及时更新依赖

---

# Part 2: 依赖扫描

---

## 2.1 What：什么是依赖扫描

### 定义

扫描项目依赖的第三方库，发现已知安全漏洞

### 扫描内容

- 直接依赖
- 间接依赖
- 许可证合规

---

## 2.2 Why：为什么需要依赖扫描

### 供应链攻击

- 第三方库可能包含漏洞
- 依赖越多，风险越大
- 供应链攻击日益增多

### 已知漏洞

- CVE数据库记录已知漏洞
- 及时发现和修复漏洞
- 降低安全风险

---

## 2.3 How：依赖扫描工具

### cargo-audit

```bash
cargo install cargo-audit
cargo audit
```

### Dependabot

- GitHub自动依赖更新
- 自动创建PR
- 自动更新依赖

### Snyk

- 依赖漏洞扫描
- 许可证合规检查
- 自动修复建议

---

## 2.4 SQLRustGo依赖扫描

### Cargo.toml依赖

```toml
[dependencies]
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
thiserror = "1.0"
```

### 扫描结果

```
Crate:     serde_json
Version:   1.0.108
Title:     Uncontrolled recursion in serde_json
Date:      2024-01-01
ID:        CVE-2024-XXXX
Solution:  Upgrade to >= 1.0.109
```

---

# Part 3: 代码扫描

---

## 3.1 What：什么是代码扫描

### 定义

分析源代码，发现潜在的安全漏洞

### 扫描内容

- SQL注入
- 缓冲区溢出
- 敏感信息泄露
- 不安全的加密

---

## 3.2 Why：为什么需要代码扫描

### 早期发现

- 在开发阶段发现问题
- 降低修复成本
- 提高代码质量

### 自动化

- 自动扫描代码
- 减少人工审查
- 提高效率

---

## 3.3 How：代码扫描工具

### Clippy安全检查

```bash
cargo clippy -- -W clippy::all
```

### SonarQube

- 代码质量和安全扫描
- 支持多种语言
- 集成CI/CD

### CodeQL

- GitHub代码扫描
- 查询语言
- 自定义规则

---

## 3.4 SQLRustGo代码扫描

### SQL注入检查

```rust
// ❌ 不安全
fn query(user_input: &str) -> Result<QueryResult> {
    let sql = format!("SELECT * FROM users WHERE name = '{}'", user_input);
    execute(&sql)
}

// ✅ 安全
fn query(user_input: &str) -> Result<QueryResult> {
    let sql = "SELECT * FROM users WHERE name = ?";
    execute_with_params(sql, &[user_input])
}
```

---

## 3.4 SQLRustGo代码扫描（续）

### 敏感信息检查

```rust
// ❌ 不安全
let password = "hardcoded_password";

// ✅ 安全
let password = std::env::var("DB_PASSWORD")?;
```

### 加密检查

```rust
// ❌ 不安全
use md5;

// ✅ 安全
use sha2::{Sha256, Digest};
```

---

# Part 4: 实践练习

---

## 4.1 依赖扫描实践

### 任务

1. 安装cargo-audit
2. 扫描项目依赖
3. 修复发现的漏洞

### 命令

```bash
cargo install cargo-audit
cargo audit
```

---

## 4.2 代码扫描实践

### 任务

1. 运行Clippy安全检查
2. 修复发现的问题
3. 提交修复代码

### 命令

```bash
cargo clippy -- -W clippy::all
```

---

# 核心知识点总结

---

## 1. 软件安全

- **What**：保护软件系统免受攻击
- **Why**：数据保护、业务连续性、合规要求
- **How**：SAST、DAST、SCA

## 2. 依赖扫描

- **What**：扫描第三方依赖漏洞
- **Why**：供应链攻击、已知漏洞
- **How**：cargo-audit、Dependabot、Snyk

## 3. 代码扫描

- **What**：分析源代码发现漏洞
- **Why**：早期发现、自动化
- **How**：Clippy、SonarQube、CodeQL

---

# 课后作业

---

## 任务

1. 执行依赖扫描
2. 执行代码扫描
3. 修复发现的安全问题

## 预习

- 发布门禁与检查清单
- RC版本验收

---

<!-- _class: lead -->

# 谢谢！

## 下节课：发布门禁与检查清单
