# SQLRustGo 版本演化规划

> 版本：v1.0.1
> 日期：2026-02-16
> 状态：设计评审中

---

## 一、版本发布流程

每个 Release 版本经历严格的发布阶段：

```
Alpha 阶段 → Beta 阶段 → Release 阶段

┌─────────────────────────────────────────────────────────────┐
│  Alpha 阶段                                               │
│  - 测试覆盖率 >= 90% (强制要求)                            │
│  - 所有单元测试通过                                        │
│  - 集成测试通过                                            │
│  - 无编译警告 (clippy --all-features -- -D warnings)       │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  Beta 阶段                                                 │
│  - API 文档完整 (所有 pub 接口有文档注释)                  │
│  - 用户手册更新                                            │
│  - CHANGELOG 更新                                          │
│  - 示例代码可用                                            │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  Release 阶段                                              │
│  - 基准测试通过                                            │
│  - 性能基线建立                                            │
│  - 安全扫描通过                                            │
│  - 版本标签发布                                            │
└─────────────────────────────────────────────────────────────┘
```

---

## 二、版本规划

### 2.1 当前状态

| 版本 | 状态 | 说明 |
|:-----|:-----|:-----|
| v1.0.0 | ✅ 已发布 | 基础功能完成，测试覆盖率 ~60-70% |
| v1.0.1 | 🔄 开发中 | 错误修正 + CI + 文档，目标是 90% 覆盖 |

### 2.2 未来版本规划

| 版本 | 阶段 | SQL 重点 | 质量目标 | 预计时间 |
|:-----|:-----|:---------|:---------|:---------|
| **v1.0.1** | 开发中 | 无新功能 | 90% 覆盖 + CI 完善 + 文档 | 1周 |
| **v1.1.0** | 规划 | 聚合函数, ORDER BY, LIMIT | Alpha→Beta→Release | 2周 |
| **v1.2.0** | 规划 | JOIN, GROUP BY | Alpha→Beta→Release | 2周 |
| **v1.3.0** | 规划 | 子查询, 视图 | Alpha→Beta→Release | 2周 |
| **v2.0.0** | 规划 | 完整 SQL-92 + 企业特性 | Alpha→Beta→Release | 2周 |

---

## 三、SQL-92 功能演进路线

### 3.1 功能矩阵

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         SQL-92 功能演进                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  v1.0.0 (已发布)                                                            │
│  ├── DML                                                                      │
│  │   ├── SELECT (基础)                                                       │
│  │   ├── INSERT                                                             │
│  │   ├── UPDATE                                                             │
│  │   └── DELETE                                                             │
│  └── DDL                                                                     │
│      └── CREATE TABLE (基础)                                                 │
│                                                                              │
│  v1.1.0                                                                      │
│  ├── 聚合函数 ───────────────┐                                               │
│  │   ├── COUNT              │                                               │
│  │   ├── SUM                │                                               │
│  │   ├── AVG                │                                               │
│  │   ├── MIN                │                                               │
│  │   └── MAX                │                                               │
│  ├── 排序 ──────────────────┤                                               │
│  │   ├── ORDER BY ASC       │                                               │
│  │   └── ORDER BY DESC     │                                               │
│  ├── 限制 ──────────────────┤                                               │
│  │   ├── LIMIT              │                                               │
│  │   └── OFFSET             │                                               │
│  └── WHERE 增强 ────────────┘                                               │
│      ├── BETWEEN...AND...                                                    │
│      ├── IN                                                                  │
│      └── LIKE (%, _)                                                        │
│                                                                              │
│  v1.2.0                                                                      │
│  ├── JOIN ──────────────────┐                                               │
│  │   ├── INNER JOIN         │                                               │
│  │   ├── LEFT OUTER JOIN   │                                               │
│  │   └── RIGHT OUTER JOIN  │                                               │
│  ├── 分组 ──────────────────┤                                               │
│  │   ├── GROUP BY          │                                               │
│  │   └── HAVING            │                                               │
│  └── 集合操作 ──────────────┘                                               │
│      ├── UNION                                                              │
│      ├── INTERSECT                                                          │
│      └── EXCEPT                                                             │
│                                                                              │
│  v1.3.0                                                                      │
│  ├── 子查询 ───────────────┐                                               │
│  │   ├── 标量子查询        │                                               │
│  │   ├── 表子查询          │                                               │
│  │   └── 关联子查询        │                                               │
│  ├── 视图 ─────────────────┤                                               │
│  │   ├── CREATE VIEW      │                                               │
│  │   └── DROP VIEW        │                                               │
│  ├── 约束增强 ─────────────┤                                               │
│  │   ├── CHECK            │                                               │
│  │   ├── UNIQUE          │                                               │
│  │   └── DEFAULT         │                                               │
│  └── 索引管理 ─────────────┘                                               │
│      ├── CREATE INDEX                                                       │
│      └── DROP INDEX                                                         │
│                                                                              │
│  v2.0.0                                                                      │
│  ├── 完整 SQL-92 支持                                                        │
│  ├── 事务增强 ───────────────┐                                              │
│  │   ├── SAVEPOINT          │                                              │
│  │   └── 隔离级别           │                                              │
│  ├── 存储过程 (基础) ────────┤                                              │
│  └── 企业特性 ───────────────┤                                              │
│      ├── 用户认证            │                                              │
│      ├── SSL/TLS            │                                              │
│      └── 审计日志            │                                              │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 功能优先级说明

| 优先级 | 功能 | 理由 |
|:-------|:-----|:-----|
| P0 | 聚合函数, ORDER BY, LIMIT | 实用度最高，教学和业务常用 |
| P1 | WHERE 增强, JOIN, GROUP BY | 复杂查询必需 |
| P2 | 子查询, 视图, 约束 | 进阶功能 |
| P3 | 事务增强, 企业特性 | 生产环境必需 |

---

## 四、质量门槛标准

### 4.1 每个版本必须达标

| 阶段 | 门槛 | 验证命令 |
|:-----|:-----|:---------|
| **Alpha** | 测试覆盖率 >= 90% | `cargo tarpaulin` |
| Alpha | 所有测试通过 | `cargo test --all-features` |
| Alpha | 无 clippy 警告 | `cargo clippy -- -D warnings` |
| **Beta** | API 文档完整 | `cargo doc --no-deps` |
| Beta | CHANGELOG 更新 | 手动检查 |
| **Release** | 基准测试通过 | `cargo bench` |
| Release | 安全扫描通过 | `cargo audit` |

### 4.2 测试覆盖率要求

```
┌─────────────────────────────────────────────────────────────┐
│                    测试覆盖率要求                            │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  最低要求: >= 90%  (每个版本必须达到)                        │
│                                                              │
│  模块        │ 覆盖率要求  │ 说明                           │
│  ────────────┼────────────┼────────────────────────────    │
│  lexer       │   >= 95%   │ 词法分析相对稳定               │
│  parser      │   >= 90%   │ 语法解析逻辑清晰               │
│  executor    │   >= 90%   │ 执行器是核心                   │
│  storage     │   >= 85%   │ 存储引擎逻辑复杂               │
│  transaction │   >= 90%   │ 事务必须可靠                   │
│  network     │   >= 85%   │ 网络协议需要充分测试           │
│  types       │   >= 95%   │ 类型系统必须稳定               │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 五、并行开发策略

### 5.1 分支管理

```
main (保护)
  ↑
baseline (合并点)
  ↑
  ├── feature/v1.x-error-fix     (错误修正分支)
  ├── feature/v1.x-sql-xxx      (SQL功能分支)
  └── feature/v1.x-docs-ci       (文档CI分支)
```

### 5.2 并行开发示例

**当前可并行的工作**：

| 分支 | 任务 | 依赖 | 可并行 |
|:-----|:-----|:-----|:-------|
| error-fix | unwrap 替换 | 无 | ✅ |
| docs-ci | 文档补全 | 无 | ✅ |
| sql-aggregate | 聚合函数 | parser 基础 | 需要先完成 parser 扩展 |

### 5.3 多实例协作

当有多个 Claude 实例时：

1. **实例 A**: 处理 error-fix 分支
2. **实例 B**: 处理 docs-ci 分支

每个实例独立工作在独立分支，最后合并到 baseline。

---

## 六、当前任务分配

### 6.1 v1.0.1 任务（错误修正 + 质量提升）

| 任务 | 状态 | 负责人 | 优先级 |
|:-----|:-----|:-------|:-------|
| 测试覆盖率提升到 90%+ | 🔄 进行中 | Claude 实例1 | P0 |
| unwrap 替换 (executor) | ⏳ 待开始 | Claude 实例2 | P0 |
| unwrap 替换 (parser) | ⏳ 待开始 | - | P1 |
| unwrap 替换 (storage) | ⏳ 待开始 | - | P1 |
| unwrap 替换 (transaction) | ⏳ 待开始 | - | P1 |
| CI 流水线完善 | ⏳ 待开始 | - | P1 |
| API 文档补全 | ⏳ 待开始 | - | P2 |
| CHANGELOG 生成 | ⏳ 待开始 | - | P2 |

### 6.2 v1.1.0 任务（SQL 功能）

| 任务 | 优先级 | 依赖 |
|:-----|:-------|:-----|
| 聚合函数 (COUNT) | P0 | 无 |
| 聚合函数 (SUM/AVG) | P0 | COUNT |
| 聚合函数 (MIN/MAX) | P0 | COUNT |
| ORDER BY | P0 | 无 |
| LIMIT | P0 | 无 |
| OFFSET | P1 | LIMIT |
| WHERE 增强 (BETWEEN) | P1 | 无 |
| WHERE 增强 (IN) | P1 | 无 |
| WHERE 增强 (LIKE) | P1 | 无 |

---

## 七、发布检查清单

### 7.1 Alpha 阶段检查清单

```markdown
## Alpha 发布检查

- [ ] 测试覆盖率 >= 90%
- [ ] `cargo test --all-features` 全部通过
- [ ] `cargo clippy --all-features -- -D warnings` 无警告
- [ ] `cargo fmt --check --all` 格式正确
- [ ] 无未解决的 Issue 标签为 bug
- [ ] 代码无新增 unwrap/expect
```

### 7.2 Beta 阶段检查清单

```markdown
## Beta 发布检查

- [ ] `cargo doc --no-deps` 生成成功
- [ ] 所有 pub 函数有文档注释
- [ ] CHANGELOG.md 更新
- [ ] 示例代码可运行
- [ ] 无重大文档缺失
```

### 7.3 Release 阶段检查清单

```markdown
## Release 发布检查

- [ ] 基准测试建立 (SELECT/INSERT/UPDATE/DELETE)
- [ ] `cargo audit` 无安全漏洞
- [ ] 版本标签创建 (vX.Y.Z)
- [ ] GitHub Release 发布
- [ ] 通知相关人员
```

---

## 八、附录

### 8.1 相关文档

- [v1.0.0 评估报告](./v1.0.0评估改进/01-AI协作开发评估.md)
- [综合改进计划](./v1.0.0评估改进/综合改进计划.md)

### 8.2 版本历史

| 版本 | 日期 | 变更 |
|:-----|:-----|:-----|
| v1.0.1 | 2026-02-16 | 初始版本规划 |

---

> 本规划为 SQLRustGo 版本演化指导文档，每个版本发布需遵循 Alpha/Beta/Release 流程。
