# RC1 分支保护规则

## 保护状态

**分支**: `v1.0.0-rc1`
**状态**: ✅ **已启用保护**
**保护时间**: 2026-02-20

## 核心保护规则

### ❌ 禁止操作
- **禁止直接提交**: 不允许直接 `git push` 到 `v1.0.0-rc1` 分支
- **禁止强制推送**: 不允许 `git push --force` 操作
- **禁止删除分支**: 不允许删除 `v1.0.0-rc1` 分支
- **禁止绕过审查**: 所有变更必须通过 PR 流程

### ✅ 强制要求
- **必须通过 PR**: 所有变更必须通过 Pull Request
- **至少一个审核者**: 每个 PR 至少需要 1 个非作者的 Reviewer 审核通过
- **代码审查**: 审核者必须批准 PR
- **状态检查**: CI 构建必须通过
- **对话解决**: 所有 PR 评论必须解决
- **管理员遵循**: 管理员也必须遵循保护规则

## PR 流程

### 1. 创建 PR
- 从个人分支或功能分支创建 PR 到 `v1.0.0-rc1`
- 确保 PR 标题符合规范: `<type>(<scope>): <summary>`
- 填写完整的 PR 描述，包括变更目的、测试结果等

### 2. 审核流程
- **自动分配**: 系统自动分配 Reviewer
- **至少 1 个审核者**: 必须有至少 1 个非作者的审核者
- **审核标准**: 
  - 代码质量
  - 功能正确性
  - 测试覆盖
  - 性能影响
  - 安全性

### 3. 合并条件
- ✅ CI 构建通过
- ✅ 至少 1 个 Reviewer 批准
- ✅ 所有评论已解决
- ✅ PR 描述完整

### 4. 合并方式
- **推荐**: Squash merge（压缩合并）
- **禁止**: Rebase merge（避免历史混乱）

## 紧急变更流程

### 特殊情况
- **严重 bug 修复**
- **安全漏洞修复**
- **CI 系统故障**

### 应急流程
1. **创建紧急 PR**，标题前缀 `[EMERGENCY]`
2. **快速审核**，由至少 2 个核心维护者审核
3. **优先合并**，但仍需遵循基本流程
4. **事后记录**，在 PR 描述中说明紧急原因

## 分支保护状态检查

### 检查命令
```bash
# 查看分支保护状态
gh api repos/minzuuniversity/sqlrustgo/branches/v1.0.0-rc1/protection

# 查看分支状态
git branch -a | grep rc1
git log --oneline -5 v1.0.0-rc1
```

### 预期输出
- **保护状态**: 显示保护规则已启用
- **审核要求**: 至少 1 个审核者
- **状态检查**: 要求 CI 通过

## 违反保护规则的处理

### 违规行为
- 直接推送代码到 rc1 分支
- 绕过 PR 流程
- 强制推送覆盖历史

### 处理措施
- **撤销变更**: 回滚违规推送
- **记录警告**: 在团队内部通报
- **流程改进**: 分析原因并改进流程

## 责任分工

### 维护者责任
- 确保保护规则正确配置
- 及时审核 PR
- 维护分支稳定性
- 处理紧急变更

### 贡献者责任
- 遵循 PR 流程
- 编写高质量代码
- 提供充分的测试
- 响应审核反馈

## 保护规则更新

### 更新流程
1. **创建讨论**，说明需要更新的原因
2. **团队共识**，获得至少 2 个核心维护者同意
3. **规则更新**，通过管理员权限更新保护规则
4. **文档更新**，同步更新本文档

### 常见更新场景
- 调整审核者数量
- 添加新的状态检查
- 修改合并策略
- 优化紧急流程

---

**保护规则生效日期**: 2026-02-20
**维护团队**: SQLRustGo 项目组
