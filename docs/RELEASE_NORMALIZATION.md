# SQLRustGo 1.0 版本正规化流程

## 1. 概述

本文档定义了 SQLRustGo 项目 1.0 版本从 RC 阶段到正式版 release 的正规化流程，包括分支重命名、版本推进和命名规则的标准化。

## 2. 当前状态

### 2.1 现有分支

- `v1.0.0-rc1` - 当前 RC 分支（不符合新命名规范）
- `release/v1.0.0` - 正式版分支
- `main` - 主分支

### 2.2 问题识别

- RC 分支命名不符合新规范（应使用 `rc/v1.0.0-1` 格式）
- 版本推进流程未标准化
- 分支保护规则未完全应用

## 3. 正规化目标

1. **标准化 RC 分支命名**：将 `v1.0.0-rc1` 重命名为 `rc/v1.0.0-1`
2. **完成版本推进**：从 RC 推进到正式版 `release/v1.0.0`
3. **更新分支保护规则**：应用新的分支命名规范
4. **建立版本控制流程**：为后续 2.0 开发做准备

## 4. 执行步骤

### 4.1 步骤一：重命名 RC 分支

#### 本地操作

```bash
# 切换到 RC 分支
git checkout v1.0.0-rc1

# 重命名本地分支
git branch -m rc/v1.0.0-1

# 推送新分支到远程
git push origin rc/v1.0.0-1

# 删除旧远程分支
git push origin --delete v1.0.0-rc1
```

### 4.2 步骤二：推进到正式版

#### 合并 RC 到正式版分支

```bash
# 切换到正式版分支
git checkout release/v1.0.0

# 合并 RC 分支
git merge rc/v1.0.0-1

# 推送更改
git push origin release/v1.0.0
```

#### 合并正式版到主分支

```bash
# 切换到主分支
git checkout main

# 合并正式版分支
git merge release/v1.0.0

# 推送更改
git push origin main
```

### 4.3 步骤三：创建标签

```bash
# 在主分支上创建标签
git checkout main
git tag v1.0.0
git push origin v1.0.0
```

### 4.4 步骤四：更新分支保护规则

在 GitHub 仓库设置中：

1. **删除旧规则**：删除针对 `v1.0.0-rc1` 的保护规则
2. **创建新规则**：
   - 为 `rc/*` 创建保护规则
   - 为 `release/*` 创建保护规则
   - 确保所有规则符合新的命名规范

### 4.5 步骤五：更新文档

1. **更新分支治理文档**：修改 `BRANCH_GOVERNANCE.md`，反映新的分支命名规范
2. **更新版本控制策略**：修改 `ENGINEERING_AUTOMATION.md`，更新版本推进流程

## 5. 命名规则标准化

### 5.1 新的分支命名规范

| 分支类型 | 格式 | 示例 |
|---------|------|------|
| RC 分支 | `rc/v<版本号>-<序号>` | `rc/v1.0.0-1` |
| 正式版分支 | `release/v<版本号>` | `release/v1.0.0` |
| 功能分支 | `feature/<描述>` | `feature/query-optimizer` |
| 修复分支 | `bugfix/<描述>` | `bugfix/null-join` |
| 紧急修复分支 | `hotfix/<问题ID>` | `hotfix/issue-42` |
| 文档分支 | `docs/<描述>` | `docs/version-planning` |

### 5.2 版本号格式

采用语义化版本号格式：

```
v<MAJOR>.<MINOR>.<PATCH>
```

- **MAJOR**：重大架构变更
- **MINOR**：新功能
- **PATCH**：bug 修复

## 6. 2.0 开发准备

### 6.1 分支结构

为 2.0 开发准备的分支结构：

```
main
├── alpha
├── beta
├── rc
└── release/
    ├── v1.0.0
    └── v2.0.0
```

### 6.2 工程系统规则

1. **分支保护**：
   - `main`、`alpha`、`beta`、`rc`、`release/*` 分支开启保护
   - 强制 PR 审核
   - 要求状态检查通过
   - 禁止直接推送

2. **CI/CD 流程**：
   - 自动版本推进（beta → rc → release）
   - 自动生成 Release Notes
   - RC 分支保护（禁止 feature 合并）
   - 多版本矩阵测试

3. **版本控制**：
   - 语义化版本号
   - 自动版本计算
   - 统一 CHANGELOG 更新

## 7. 执行时间表

| 步骤 | 时间 | 负责人 |
|------|------|--------|
| 分支重命名 | 立即 | 项目维护者 |
| 版本推进 | 分支重命名后 | 项目维护者 |
| 标签创建 | 版本推进后 | 项目维护者 |
| 规则更新 | 1-2 天内 | 项目维护者 |
| 文档更新 | 2-3 天内 | 文档团队 |

## 8. 风险评估

### 8.1 潜在风险

1. **PR 影响**：如果有针对 `v1.0.0-rc1` 的 PR，重命名会影响这些 PR
2. **CI 配置**：如果 CI 配置绑定到旧分支名，需要更新
3. **分支保护**：需要更新分支保护规则以匹配新命名

### 8.2 缓解措施

1. **PR 处理**：在重命名前检查并处理所有针对 RC 分支的 PR
2. **CI 更新**：提前更新 CI 配置以支持新的分支命名模式
3. **规则更新**：同步更新分支保护规则

## 9. 结论

通过执行本文档定义的正规化流程，SQLRustGo 项目将：

1. **标准化分支命名**：符合新的工程治理规范
2. **完成 1.0 发布**：从 RC 阶段正式推进到 release
3. **为 2.0 做准备**：建立完善的工程系统规则

这将为项目的长期演进奠定坚实的基础，确保版本控制的清晰性和可预测性。