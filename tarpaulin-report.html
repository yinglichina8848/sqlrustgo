<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <style>:root {
  --color: black;
  --bg: white;
  --head-bg: white;
  --link: #338;

  --blue: #ccf;
  --red: #fcc;
  --yellow: #ffc;
  --green: #cfc;
}

[data-theme='dark'] {
  --color: white;
  --bg: black;
  --head-bg: #333;
  --link: #aaf;

  --blue: #225;
  --red: #522;
  --yellow: #552;
  --green: #252;
}

html,
body {
  margin: 0;
  padding: 0;
  color: var(--color);
  background: var(--bg);
}

.app {
  margin: 10px;
  padding: 0;
}

.files-list {
  margin: 10px 0 0;
  width: 100%;
  border-collapse: collapse;
}
.files-list__head {
  border: 1px solid #999;
}
.files-list__head > tr > th {
  padding: 10px;
  border: 1px solid #999;
  text-align: left;
  font-weight: normal;
  background: var(--head-bg);
}
.files-list__body {
}
.files-list__file {
  cursor: pointer;
}
.files-list__file:hover {
  background: var(--blue);
}
.files-list__file > td {
  padding: 10px;
  border: 1px solid #999;
}
.files-list__file > td:first-child::before {
  content: '\01F4C4';
  margin-right: 1em;
}
.files-list__file_low {
  background: var(--red);
}
.files-list__file_medium {
  background: var(--yellow);
}
.files-list__file_high {
  background: var(--green);
}
.files-list__file_folder > td:first-child::before {
  content: '\01F4C1';
  margin-right: 1em;
}

.file-header {
  border: 1px solid #999;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: sticky;
  top: 0;
  background: var(--bg);
}

.file-header__back {
  margin: 10px;
  cursor: pointer;
  flex-shrink: 0;
  flex-grow: 0;
  text-decoration: underline;
  color: var(--link);
}

.file-header__name {
  margin: 10px;
  flex-shrink: 2;
  flex-grow: 2;
}

.file-header__stat {
  margin: 10px;
  flex-shrink: 0;
  flex-grow: 0;
}

.file-content {
  margin: 10px 0 0;
  border: 1px solid #999;
  padding: 10px;
  counter-reset: line;
  display: flex;
  flex-direction: column;
}

.code-line::before {
  content: counter(line);
  margin-right: 72px;
}
.code-line {
  margin: 0;
  height: 1em;
  counter-increment: line;

  position: absolute;
  padding: 0 0.3em 0.3em 0.3em;
  display: inherit;
  width: 100%;
}
.code-line_covered {
  background: var(--green);
}
.code-line_uncovered {
  background: var(--red);
}

.code-text-container {
  position: relative;
  height: 1em;
  padding: 0.3em 0;
}

.cover-indicator {
  display: flex;
  width: 100%;
  position: absolute;
  justify-content: end;
  height: 1em;
  align-items: center;
  padding: 0 0.3em 0.3em 0.3em;
}

.cover-indicator.check-cover::after {
  content: "\2713";
  font-weight: bold;
  background-color: var(--green);
  height: 1em;
}

.cover-indicator.no-cover::after {
  content: "\2716";
  font-weight: bold;
  background-color: var(--red);
  height: 1em;
}

.stat-line-hit {
  max-width: 48px;
  overflow: hidden;
  font-weight: bold;
  margin-right: 4px;
  background-color: var(--green);
  position: relative;
  top: 0.1em;
}

#theme-toggle-label {
  margin-left: 1ch;
}
</style>
</head>
<body>
    <div id="root"></div>
    <script>
        var data = {"files":[{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","executor","mod.rs"],"content":"//! Query Execution Engine\n//!\n//! # What (是什么)\n//! Executor 负责执行 Parser 生成的 AST，产生查询结果\n//!\n//! # Why (为什么)\n//! Parser 解析 SQL 只是理解\"要做什么\"，Executor 才是真正\"执行操作\"的组件\n//! Executor 需要访问存储层，按需读写数据\n//!\n//! # How (如何实现)\n//! - Volcano 模型：迭代器风格，每步处理一个算子\n//! - 算子下推：将过滤等操作下推到存储层\n//! - 支持：DML (INSERT/UPDATE/DELETE) 和 DQL (SELECT)\n//! - 表达式求值：WHERE 子句的布尔表达式\n\nuse crate::parser::{\n    DeleteStatement, Expression, InsertStatement, SelectStatement, Statement, UpdateStatement,\n};\nuse crate::storage::{BufferPool, FileStorage};\nuse crate::types::{SqlError, SqlResult, Value, parse_sql_literal};\nuse std::path::PathBuf;\n\n/// Execution result\n#[derive(Debug)]\npub struct ExecutionResult {\n    pub rows_affected: u64,\n    pub columns: Vec\u003cString\u003e,\n    pub rows: Vec\u003cVec\u003cValue\u003e\u003e,\n}\n\n/// Query execution engine\n#[allow(dead_code)]\npub struct ExecutionEngine {\n    buffer_pool: BufferPool,\n    storage: FileStorage,\n}\n\nimpl ExecutionEngine {\n    /// Create a new execution engine with file-based storage\n    pub fn new() -\u003e Self {\n        Self::with_data_dir(std::path::PathBuf::from(\"data\"))\n    }\n\n    /// Create a new execution engine with custom data directory\n    pub fn with_data_dir(data_dir: PathBuf) -\u003e Self {\n        let storage = FileStorage::new(data_dir).expect(\"Failed to initialize file storage\");\n        Self {\n            buffer_pool: BufferPool::new(100),\n            storage,\n        }\n    }\n\n    /// Execute a SQL statement\n    pub fn execute(\u0026mut self, statement: Statement) -\u003e SqlResult\u003cExecutionResult\u003e {\n        match statement {\n            Statement::Select(s) =\u003e self.execute_select(s),\n            Statement::Insert(s) =\u003e self.execute_insert(s),\n            Statement::Update(s) =\u003e self.execute_update(s),\n            Statement::Delete(s) =\u003e self.execute_delete(s),\n            Statement::CreateTable(c) =\u003e self.execute_create_table(c),\n            Statement::DropTable(d) =\u003e self.execute_drop_table(d),\n        }\n    }\n\n    /// Execute SELECT\n    fn execute_select(\u0026mut self, stmt: SelectStatement) -\u003e SqlResult\u003cExecutionResult\u003e {\n        // Check if table exists\n        let table_data = self\n            .storage\n            .get_table(\u0026stmt.table)\n            .ok_or_else(|| SqlError::TableNotFound(stmt.table.clone()))?;\n\n        // Get column names from table schema\n        let table_columns: Vec\u003cString\u003e = table_data\n            .info\n            .columns\n            .iter()\n            .map(|c| c.name.clone())\n            .collect();\n\n        // Determine result columns (use table columns if SELECT *)\n        let result_columns: Vec\u003cString\u003e = if stmt.columns.iter().any(|c| c.name == \"*\") {\n            table_columns.clone()\n        } else {\n            stmt.columns.iter().map(|c| c.name.clone()).collect()\n        };\n\n        // Find column indices for projection\n        let column_indices: Vec\u003cusize\u003e = if stmt.columns.iter().any(|c| c.name == \"*\") {\n            (0..table_columns.len()).collect()\n        } else {\n            stmt.columns\n                .iter()\n                .filter_map(|c| table_columns.iter().position(|tc| tc == \u0026c.name))\n                .collect()\n        };\n\n        // Build column index map for WHERE clause evaluation\n        let column_map: std::collections::HashMap\u003cString, usize\u003e = table_columns\n            .iter()\n            .enumerate()\n            .map(|(i, c)| (c.clone(), i))\n            .collect();\n\n        // Filter rows by WHERE clause (with index optimization)\n        let filtered_rows: Vec\u003cVec\u003cValue\u003e\u003e = if let Some(ref where_expr) = stmt.where_clause {\n            // Try to use index for optimization\n            if let Some(row_indices) = self.execute_select_with_index(\u0026table_data, where_expr, \u0026column_map) {\n                // Use index results\n                row_indices.iter()\n                    .filter_map(|\u0026idx| table_data.rows.get(idx).cloned())\n                    .collect()\n            } else {\n                // Fall back to full table scan\n                table_data.rows.iter()\n                    .filter(|row| evaluate_where(row, where_expr, \u0026column_map))\n                    .cloned()\n                    .collect()\n            }\n        } else {\n            table_data.rows.clone()\n        };\n\n        // Project to result columns\n        let result_rows: Vec\u003cVec\u003cValue\u003e\u003e = filtered_rows\n            .iter()\n            .map(|row| {\n                column_indices\n                    .iter()\n                    .filter_map(|\u0026idx| row.get(idx).cloned())\n                    .collect()\n            })\n            .collect();\n\n        Ok(ExecutionResult {\n            rows_affected: result_rows.len() as u64,\n            columns: result_columns,\n            rows: result_rows,\n        })\n    }\n\n    /// Execute INSERT (supports multi-row)\n    fn execute_insert(\u0026mut self, stmt: InsertStatement) -\u003e SqlResult\u003cExecutionResult\u003e {\n        // Check if table exists\n        if !self.storage.contains_table(\u0026stmt.table) {\n            return Err(SqlError::TableNotFound(stmt.table));\n        }\n\n        // Get indexed columns before mutating\n        let indexed_columns: Vec\u003c(usize, String)\u003e = {\n            let table_data = self.storage.get_table(\u0026stmt.table).unwrap();\n            table_data.info.columns.iter()\n                .enumerate()\n                .filter(|(_, c)| self.storage.has_index(\u0026stmt.table, \u0026c.name))\n                .map(|(i, c)| (i, c.name.clone()))\n                .collect()\n        };\n\n        // Convert expressions to values (multiple rows)\n        let mut inserted_rows: Vec\u003cVec\u003cValue\u003e\u003e = Vec::new();\n        let mut index_updates: Vec\u003c(String, i64, u32)\u003e = Vec::new(); // (column_name, key, row_id)\n\n        {\n            let table_data = self.storage.get_table_mut(\u0026stmt.table).unwrap();\n            for row_expr in \u0026stmt.values {\n                let row: Vec\u003cValue\u003e = row_expr.iter().map(expression_to_value_static).collect();\n                let row_id = table_data.rows.len() as u32;\n                table_data.rows.push(row.clone());\n\n                // Collect index updates to apply after borrow\n                for (col_idx, col_name) in \u0026indexed_columns {\n                    if let Some(value) = row.get(*col_idx) {\n                        if let Value::Integer(key) = value {\n                            index_updates.push((col_name.clone(), *key, row_id));\n                        }\n                    }\n                }\n\n                inserted_rows.push(row);\n            }\n        }\n\n        // Apply index updates\n        for (col_name, key, row_id) in index_updates {\n            let _ = self.storage.insert_with_index(\u0026stmt.table, \u0026col_name, key, row_id);\n        }\n\n        self.storage.persist_table(\u0026stmt.table)?;\n\n        let rows_affected = inserted_rows.len() as u64;\n\n        Ok(ExecutionResult {\n            rows_affected,\n            columns: Vec::new(),\n            rows: inserted_rows,\n        })\n    }\n\n    /// Execute UPDATE (with dynamic column mapping)\n    fn execute_update(\u0026mut self, stmt: UpdateStatement) -\u003e SqlResult\u003cExecutionResult\u003e {\n        // Check if table exists\n        if !self.storage.contains_table(\u0026stmt.table) {\n            return Err(SqlError::TableNotFound(stmt.table));\n        }\n\n        let where_clause = stmt.where_clause.clone();\n        let set_clauses = stmt.set_clauses.clone();\n\n        // Build column index map from table schema\n        let column_indices: std::collections::HashMap\u003cString, usize\u003e = {\n            let table_data = self.storage.get_table(\u0026stmt.table).unwrap();\n            table_data\n                .info\n                .columns\n                .iter()\n                .enumerate()\n                .map(|(i, c)| (c.name.clone(), i))\n                .collect()\n        };\n\n        let rows_affected = {\n            let table_data = self.storage.get_table_mut(\u0026stmt.table).unwrap();\n            let mut count = 0;\n\n            // Evaluate WHERE clause if present\n            for row in \u0026mut table_data.rows {\n                // If no WHERE clause, update all rows\n                let matches = if let Some(ref where_expr) = where_clause {\n                    evaluate_where(row, where_expr, \u0026column_indices)\n                } else {\n                    true\n                };\n\n                if matches {\n                    // Apply SET clauses with dynamic column mapping\n                    for (column, value_expr) in \u0026set_clauses {\n                        if let Some(\u0026idx) = column_indices.get(column)\n                            \u0026\u0026 idx \u003c row.len()\n                        {\n                            row[idx] = expression_to_value_static(value_expr);\n                        }\n                    }\n                    count += 1;\n                }\n            }\n            count\n        };\n\n        // Persist to disk\n        self.storage.persist_table(\u0026stmt.table)?;\n\n        Ok(ExecutionResult {\n            rows_affected,\n            columns: Vec::new(),\n            rows: Vec::new(),\n        })\n    }\n\n    /// Execute DELETE\n    fn execute_delete(\u0026mut self, stmt: DeleteStatement) -\u003e SqlResult\u003cExecutionResult\u003e {\n        // Check if table exists\n        if !self.storage.contains_table(\u0026stmt.table) {\n            return Err(SqlError::TableNotFound(stmt.table));\n        }\n\n        let where_clause = stmt.where_clause.clone();\n\n        // Build column index map for WHERE clause evaluation\n        let column_indices: std::collections::HashMap\u003cString, usize\u003e = {\n            let table_data = self.storage.get_table(\u0026stmt.table).unwrap();\n            table_data\n                .info\n                .columns\n                .iter()\n                .enumerate()\n                .map(|(i, c)| (c.name.clone(), i))\n                .collect()\n        };\n\n        let rows_affected = {\n            let table_data = self.storage.get_table_mut(\u0026stmt.table).unwrap();\n            let original_count = table_data.rows.len();\n\n            // If WHERE clause is present, filter rows; otherwise delete all\n            if let Some(where_expr) = where_clause {\n                table_data\n                    .rows\n                    .retain(|row| !evaluate_where(row, \u0026where_expr, \u0026column_indices));\n            } else {\n                table_data.rows.clear();\n            }\n\n            (original_count - table_data.rows.len()) as u64\n        };\n\n        // Persist to disk\n        self.storage.persist_table(\u0026stmt.table)?;\n\n        Ok(ExecutionResult {\n            rows_affected,\n            columns: Vec::new(),\n            rows: Vec::new(),\n        })\n    }\n\n    /// Execute CREATE TABLE\n    fn execute_create_table(\n        \u0026mut self,\n        stmt: crate::parser::CreateTableStatement,\n    ) -\u003e SqlResult\u003cExecutionResult\u003e {\n        let table_data = TableData {\n            info: TableInfo {\n                name: stmt.name.clone(),\n                columns: stmt.columns,\n            },\n            rows: Vec::new(),\n        };\n        self.storage.insert_table(stmt.name, table_data)?;\n\n        Ok(ExecutionResult {\n            rows_affected: 0,\n            columns: Vec::new(),\n            rows: Vec::new(),\n        })\n    }\n\n    /// Execute DROP TABLE\n    fn execute_drop_table(\n        \u0026mut self,\n        stmt: crate::parser::DropTableStatement,\n    ) -\u003e SqlResult\u003cExecutionResult\u003e {\n        self.storage.drop_table(\u0026stmt.name)?;\n\n        Ok(ExecutionResult {\n            rows_affected: 0,\n            columns: Vec::new(),\n            rows: Vec::new(),\n        })\n    }\n\n    /// Get table data\n    pub fn get_table(\u0026self, name: \u0026str) -\u003e Option\u003c\u0026TableData\u003e {\n        self.storage.get_table(name)\n    }\n\n    // ==================== Index Methods ====================\n\n    /// Create an index on a table column\n    pub fn create_index(\u0026mut self, table_name: \u0026str, column_name: \u0026str) -\u003e SqlResult\u003c()\u003e {\n        // Find column index in table schema\n        let table = self.storage.get_table(table_name)\n            .ok_or_else(|| SqlError::TableNotFound(table_name.to_string()))?;\n\n        let column_index = table.info.columns.iter()\n            .position(|c| c.name == column_name)\n            .ok_or_else(|| SqlError::ExecutionError(format!(\"Column '{}' not found\", column_name)))?;\n\n        // Check if column is INTEGER type (for B+ Tree index)\n        if table.info.columns[column_index].data_type != \"INTEGER\" {\n            return Err(SqlError::ExecutionError(\"Index only supports INTEGER columns\".to_string()));\n        }\n\n        // Create index\n        self.storage.create_index(table_name, column_name, column_index)\n            .map_err(|e| SqlError::ExecutionError(e.to_string()))?;\n\n        Ok(())\n    }\n\n    /// Check if an index exists\n    pub fn has_index(\u0026self, table_name: \u0026str, column_name: \u0026str) -\u003e bool {\n        self.storage.has_index(table_name, column_name)\n    }\n\n    /// Use index for optimized SELECT (if applicable)\n    fn execute_select_with_index(\n        \u0026self,\n        table_data: \u0026TableData,\n        where_expr: \u0026Expression,\n        _column_map: \u0026std::collections::HashMap\u003cString, usize\u003e,\n    ) -\u003e Option\u003cVec\u003cusize\u003e\u003e {\n        // Try to use index for simple equality conditions on indexed columns\n        if let Expression::BinaryOp(left, op, right) = where_expr {\n            if op.as_str() == \"=\" {\n                // Check if left side is a column reference\n                if let Expression::Identifier(col_name) = left.as_ref() {\n                    // Check if right side is a literal value\n                    if let Expression::Literal(val) = right.as_ref() {\n                        // Check if we have an index on this column\n                        let key_value = parse_sql_literal(val);\n                        if let Some(key) = key_value.as_integer() {\n                            if self.storage.has_index(\u0026table_data.info.name, col_name) {\n                                // Use index to find matching row\n                                if let Some(row_id) = self.storage.search_index(\n                                    \u0026table_data.info.name,\n                                    col_name,\n                                    key,\n                                ) {\n                                    return Some(vec![row_id as usize]);\n                                } else {\n                                    return Some(vec![]); // No match\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        None\n    }\n}\n\nimpl Default for ExecutionEngine {\n    fn default() -\u003e Self {\n        Self::new()\n    }\n}\n\n/// Convert expression to value (static function)\nfn expression_to_value_static(expr: \u0026Expression) -\u003e Value {\n    match expr {\n        Expression::Literal(s) =\u003e parse_sql_literal(s),\n        Expression::Identifier(s) =\u003e parse_sql_literal(s),\n        Expression::BinaryOp(_, _, _) =\u003e Value::Null, // TODO: evaluate expression\n    }\n}\n\n/// Evaluate WHERE clause for a row with dynamic column mapping\nfn evaluate_where(\n    row: \u0026[Value],\n    expr: \u0026Expression,\n    column_indices: \u0026std::collections::HashMap\u003cString, usize\u003e,\n) -\u003e bool {\n    match expr {\n        Expression::BinaryOp(left, op, right) =\u003e {\n            // Get left value (column reference)\n            let left_val = match left.as_ref() {\n                Expression::Identifier(name) =\u003e {\n                    // Dynamic column lookup\n                    column_indices\n                        .get(name)\n                        .and_then(|\u0026idx| row.get(idx))\n                        .cloned()\n                        .unwrap_or(Value::Null)\n                }\n                Expression::Literal(s) =\u003e parse_sql_literal(s),\n                _ =\u003e Value::Null,\n            };\n\n            // Get right value\n            let right_val = match right.as_ref() {\n                Expression::Identifier(name) =\u003e {\n                    // Dynamic column lookup\n                    column_indices\n                        .get(name)\n                        .and_then(|\u0026idx| row.get(idx))\n                        .cloned()\n                        .unwrap_or(Value::Null)\n                }\n                Expression::Literal(s) =\u003e parse_sql_literal(s),\n                _ =\u003e Value::Null,\n            };\n\n            // Evaluate based on operator\n            match op.as_str() {\n                \"=\" =\u003e left_val == right_val,\n                \"!=\" =\u003e left_val != right_val,\n                \"\u003e\" =\u003e match (\u0026left_val, \u0026right_val) {\n                    (Value::Integer(l), Value::Integer(r)) =\u003e l \u003e r,\n                    (Value::Float(l), Value::Float(r)) =\u003e l \u003e r,\n                    (Value::Text(l), Value::Text(r)) =\u003e l \u003e r,\n                    _ =\u003e false,\n                },\n                \"\u003c\" =\u003e match (\u0026left_val, \u0026right_val) {\n                    (Value::Integer(l), Value::Integer(r)) =\u003e l \u003c r,\n                    (Value::Float(l), Value::Float(r)) =\u003e l \u003c r,\n                    (Value::Text(l), Value::Text(r)) =\u003e l \u003c r,\n                    _ =\u003e false,\n                },\n                \"\u003e=\" =\u003e match (\u0026left_val, \u0026right_val) {\n                    (Value::Integer(l), Value::Integer(r)) =\u003e l \u003e= r,\n                    (Value::Float(l), Value::Float(r)) =\u003e l \u003e= r,\n                    (Value::Text(l), Value::Text(r)) =\u003e l \u003e= r,\n                    _ =\u003e false,\n                },\n                \"\u003c=\" =\u003e match (\u0026left_val, \u0026right_val) {\n                    (Value::Integer(l), Value::Integer(r)) =\u003e l \u003c= r,\n                    (Value::Float(l), Value::Float(r)) =\u003e l \u003c= r,\n                    (Value::Text(l), Value::Text(r)) =\u003e l \u003c= r,\n                    _ =\u003e false,\n                },\n                _ =\u003e false,\n            }\n        }\n        _ =\u003e true,\n    }\n}\n\n/// Table data with rows\n#[derive(Debug, Clone)]\npub struct TableData {\n    pub info: TableInfo,\n    pub rows: Vec\u003cVec\u003cValue\u003e\u003e,\n}\n\n/// Table metadata\n#[derive(Debug, Clone)]\npub struct TableInfo {\n    pub name: String,\n    pub columns: Vec\u003ccrate::parser::ColumnDefinition\u003e,\n}\n\n/// Execute a SQL string\npub fn execute(sql: \u0026str) -\u003e SqlResult\u003cExecutionResult\u003e {\n    let statement = crate::parser::parse(sql)?;\n    let mut engine = ExecutionEngine::new();\n    engine.execute(statement)\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use std::env;\n\n    #[test]\n    fn test_execution_engine_create() {\n        // Use a unique temp directory for test isolation\n        let temp_dir = env::temp_dir().join(format!(\"sqlrustgo_test_{}\", std::process::id()));\n        let engine = ExecutionEngine::with_data_dir(temp_dir.clone());\n        assert!(engine.storage.table_names().is_empty());\n        // Clean up\n        let _ = std::fs::remove_dir_all(temp_dir);\n    }\n\n    #[test]\n    fn test_execute_create_table() {\n        let mut engine = ExecutionEngine::new();\n        let result = engine\n            .execute(crate::parser::parse(\"CREATE TABLE users (id INTEGER, name TEXT)\").unwrap());\n        assert!(result.is_ok());\n        assert!(engine.get_table(\"users\").is_some());\n    }\n\n    #[test]\n    fn test_execute_select() {\n        let mut engine = ExecutionEngine::new();\n        // Create table first\n        let _ = engine\n            .execute(crate::parser::parse(\"CREATE TABLE users (id INTEGER, name TEXT)\").unwrap());\n\n        // Select from existing table\n        let result = engine.execute(crate::parser::parse(\"SELECT id FROM users\").unwrap());\n        assert!(result.is_ok());\n    }\n\n    #[test]\n    fn test_execute_select_nonexistent_table() {\n        let mut engine = ExecutionEngine::new();\n        let result = engine.execute(crate::parser::parse(\"SELECT * FROM nonexistent\").unwrap());\n        assert!(result.is_err());\n    }\n\n    #[test]\n    fn test_execute_insert() {\n        let mut engine = ExecutionEngine::new();\n        // Create table first\n        engine\n            .execute(crate::parser::parse(\"CREATE TABLE users (id INTEGER, name TEXT)\").unwrap())\n            .unwrap();\n\n        // Insert a row\n        let result =\n            engine.execute(crate::parser::parse(\"INSERT INTO users VALUES (1, 'Alice')\").unwrap());\n        assert!(result.is_ok());\n        let exec_result = result.unwrap();\n        assert_eq!(exec_result.rows_affected, 1); // 1 row inserted\n\n        // Verify row was stored\n        let table = engine.get_table(\"users\").unwrap();\n        assert_eq!(table.rows.len(), 1);\n    }\n\n    #[test]\n    fn test_execute_select_with_data() {\n        let mut engine = ExecutionEngine::new();\n        // Create table first\n        engine\n            .execute(crate::parser::parse(\"CREATE TABLE users (id INTEGER, name TEXT)\").unwrap())\n            .unwrap();\n\n        // Insert rows\n        engine\n            .execute(crate::parser::parse(\"INSERT INTO users VALUES (1, 'Alice')\").unwrap())\n            .unwrap();\n        engine\n            .execute(crate::parser::parse(\"INSERT INTO users VALUES (2, 'Bob')\").unwrap())\n            .unwrap();\n\n        // Select all rows\n        let result = engine\n            .execute(crate::parser::parse(\"SELECT * FROM users\").unwrap())\n            .unwrap();\n        assert_eq!(result.rows.len(), 2);\n        assert_eq!(result.columns, vec![\"id\", \"name\"]);\n    }\n\n    #[test]\n    fn test_execute_select_with_where() {\n        let mut engine = ExecutionEngine::new();\n        // Create table first\n        engine\n            .execute(crate::parser::parse(\"CREATE TABLE users (id INTEGER, name TEXT)\").unwrap())\n            .unwrap();\n\n        // Insert rows\n        engine\n            .execute(crate::parser::parse(\"INSERT INTO users VALUES (1, 'Alice')\").unwrap())\n            .unwrap();\n        engine\n            .execute(crate::parser::parse(\"INSERT INTO users VALUES (2, 'Bob')\").unwrap())\n            .unwrap();\n\n        // Select with WHERE clause\n        let result = engine\n            .execute(crate::parser::parse(\"SELECT * FROM users WHERE id = 1\").unwrap())\n            .unwrap();\n        assert_eq!(result.rows.len(), 1);\n        assert_eq!(result.rows[0][0], crate::types::Value::Integer(1));\n    }\n\n    #[test]\n    fn test_execute_update() {\n        let mut engine = ExecutionEngine::new();\n        // Create table first\n        engine\n            .execute(crate::parser::parse(\"CREATE TABLE users (id INTEGER, name TEXT)\").unwrap())\n            .unwrap();\n\n        // Insert a row\n        engine\n            .execute(crate::parser::parse(\"INSERT INTO users VALUES (1, 'Alice')\").unwrap())\n            .unwrap();\n\n        // Update the row\n        let result = engine\n            .execute(crate::parser::parse(\"UPDATE users SET name = 'Bob' WHERE id = 1\").unwrap());\n        assert!(result.is_ok());\n    }\n\n    #[test]\n    fn test_execute_delete() {\n        let mut engine = ExecutionEngine::new();\n        // Create table first\n        engine\n            .execute(crate::parser::parse(\"CREATE TABLE users (id INTEGER, name TEXT)\").unwrap())\n            .unwrap();\n\n        // Insert a row\n        engine\n            .execute(crate::parser::parse(\"INSERT INTO users VALUES (1, 'Alice')\").unwrap())\n            .unwrap();\n\n        // Delete the row\n        let result =\n            engine.execute(crate::parser::parse(\"DELETE FROM users WHERE id = 1\").unwrap());\n        assert!(result.is_ok());\n\n        // Verify row was deleted\n        let table = engine.get_table(\"users\").unwrap();\n        assert_eq!(table.rows.len(), 0);\n    }\n}\n","traces":[{"line":40,"address":[],"length":0,"stats":{"Line":31}},{"line":41,"address":[],"length":0,"stats":{"Line":62}},{"line":45,"address":[],"length":0,"stats":{"Line":32}},{"line":46,"address":[],"length":0,"stats":{"Line":160}},{"line":48,"address":[],"length":0,"stats":{"Line":32}},{"line":54,"address":[],"length":0,"stats":{"Line":73}},{"line":55,"address":[],"length":0,"stats":{"Line":73}},{"line":56,"address":[],"length":0,"stats":{"Line":40}},{"line":57,"address":[],"length":0,"stats":{"Line":76}},{"line":58,"address":[],"length":0,"stats":{"Line":20}},{"line":59,"address":[],"length":0,"stats":{"Line":20}},{"line":60,"address":[],"length":0,"stats":{"Line":120}},{"line":61,"address":[],"length":0,"stats":{"Line":16}},{"line":66,"address":[],"length":0,"stats":{"Line":10}},{"line":68,"address":[],"length":0,"stats":{"Line":19}},{"line":69,"address":[],"length":0,"stats":{"Line":10}},{"line":70,"address":[],"length":0,"stats":{"Line":20}},{"line":71,"address":[],"length":0,"stats":{"Line":13}},{"line":74,"address":[],"length":0,"stats":{"Line":27}},{"line":75,"address":[],"length":0,"stats":{"Line":9}},{"line":76,"address":[],"length":0,"stats":{"Line":9}},{"line":78,"address":[],"length":0,"stats":{"Line":33}},{"line":82,"address":[],"length":0,"stats":{"Line":54}},{"line":83,"address":[],"length":0,"stats":{"Line":12}},{"line":85,"address":[],"length":0,"stats":{"Line":15}},{"line":89,"address":[],"length":0,"stats":{"Line":54}},{"line":90,"address":[],"length":0,"stats":{"Line":12}},{"line":92,"address":[],"length":0,"stats":{"Line":3}},{"line":94,"address":[],"length":0,"stats":{"Line":11}},{"line":99,"address":[],"length":0,"stats":{"Line":27}},{"line":102,"address":[],"length":0,"stats":{"Line":45}},{"line":106,"address":[],"length":0,"stats":{"Line":28}},{"line":108,"address":[],"length":0,"stats":{"Line":4}},{"line":110,"address":[],"length":0,"stats":{"Line":0}},{"line":111,"address":[],"length":0,"stats":{"Line":0}},{"line":115,"address":[],"length":0,"stats":{"Line":1}},{"line":116,"address":[],"length":0,"stats":{"Line":9}},{"line":121,"address":[],"length":0,"stats":{"Line":16}},{"line":125,"address":[],"length":0,"stats":{"Line":27}},{"line":127,"address":[],"length":0,"stats":{"Line":16}},{"line":128,"address":[],"length":0,"stats":{"Line":7}},{"line":129,"address":[],"length":0,"stats":{"Line":7}},{"line":130,"address":[],"length":0,"stats":{"Line":43}},{"line":131,"address":[],"length":0,"stats":{"Line":7}},{"line":135,"address":[],"length":0,"stats":{"Line":9}},{"line":136,"address":[],"length":0,"stats":{"Line":18}},{"line":137,"address":[],"length":0,"stats":{"Line":9}},{"line":138,"address":[],"length":0,"stats":{"Line":9}},{"line":143,"address":[],"length":0,"stats":{"Line":19}},{"line":145,"address":[],"length":0,"stats":{"Line":38}},{"line":146,"address":[],"length":0,"stats":{"Line":0}},{"line":150,"address":[],"length":0,"stats":{"Line":38}},{"line":151,"address":[],"length":0,"stats":{"Line":95}},{"line":152,"address":[],"length":0,"stats":{"Line":19}},{"line":154,"address":[],"length":0,"stats":{"Line":131}},{"line":155,"address":[],"length":0,"stats":{"Line":19}},{"line":160,"address":[],"length":0,"stats":{"Line":57}},{"line":161,"address":[],"length":0,"stats":{"Line":57}},{"line":164,"address":[],"length":0,"stats":{"Line":95}},{"line":165,"address":[],"length":0,"stats":{"Line":38}},{"line":166,"address":[],"length":0,"stats":{"Line":95}},{"line":167,"address":[],"length":0,"stats":{"Line":38}},{"line":168,"address":[],"length":0,"stats":{"Line":76}},{"line":171,"address":[],"length":0,"stats":{"Line":19}},{"line":172,"address":[],"length":0,"stats":{"Line":0}},{"line":173,"address":[],"length":0,"stats":{"Line":0}},{"line":174,"address":[],"length":0,"stats":{"Line":0}},{"line":179,"address":[],"length":0,"stats":{"Line":57}},{"line":184,"address":[],"length":0,"stats":{"Line":19}},{"line":185,"address":[],"length":0,"stats":{"Line":0}},{"line":188,"address":[],"length":0,"stats":{"Line":57}},{"line":190,"address":[],"length":0,"stats":{"Line":38}},{"line":192,"address":[],"length":0,"stats":{"Line":19}},{"line":193,"address":[],"length":0,"stats":{"Line":38}},{"line":194,"address":[],"length":0,"stats":{"Line":19}},{"line":195,"address":[],"length":0,"stats":{"Line":19}},{"line":200,"address":[],"length":0,"stats":{"Line":5}},{"line":202,"address":[],"length":0,"stats":{"Line":10}},{"line":203,"address":[],"length":0,"stats":{"Line":0}},{"line":206,"address":[],"length":0,"stats":{"Line":15}},{"line":207,"address":[],"length":0,"stats":{"Line":15}},{"line":210,"address":[],"length":0,"stats":{"Line":10}},{"line":211,"address":[],"length":0,"stats":{"Line":25}},{"line":212,"address":[],"length":0,"stats":{"Line":5}},{"line":213,"address":[],"length":0,"stats":{"Line":5}},{"line":214,"address":[],"length":0,"stats":{"Line":5}},{"line":217,"address":[],"length":0,"stats":{"Line":35}},{"line":221,"address":[],"length":0,"stats":{"Line":5}},{"line":222,"address":[],"length":0,"stats":{"Line":25}},{"line":223,"address":[],"length":0,"stats":{"Line":10}},{"line":226,"address":[],"length":0,"stats":{"Line":10}},{"line":228,"address":[],"length":0,"stats":{"Line":15}},{"line":229,"address":[],"length":0,"stats":{"Line":20}},{"line":231,"address":[],"length":0,"stats":{"Line":0}},{"line":234,"address":[],"length":0,"stats":{"Line":5}},{"line":236,"address":[],"length":0,"stats":{"Line":15}},{"line":237,"address":[],"length":0,"stats":{"Line":15}},{"line":238,"address":[],"length":0,"stats":{"Line":10}},{"line":240,"address":[],"length":0,"stats":{"Line":10}},{"line":243,"address":[],"length":0,"stats":{"Line":5}},{"line":246,"address":[],"length":0,"stats":{"Line":5}},{"line":250,"address":[],"length":0,"stats":{"Line":15}},{"line":252,"address":[],"length":0,"stats":{"Line":5}},{"line":253,"address":[],"length":0,"stats":{"Line":10}},{"line":254,"address":[],"length":0,"stats":{"Line":5}},{"line":255,"address":[],"length":0,"stats":{"Line":5}},{"line":260,"address":[],"length":0,"stats":{"Line":5}},{"line":262,"address":[],"length":0,"stats":{"Line":10}},{"line":263,"address":[],"length":0,"stats":{"Line":0}},{"line":266,"address":[],"length":0,"stats":{"Line":15}},{"line":269,"address":[],"length":0,"stats":{"Line":10}},{"line":270,"address":[],"length":0,"stats":{"Line":25}},{"line":271,"address":[],"length":0,"stats":{"Line":5}},{"line":272,"address":[],"length":0,"stats":{"Line":5}},{"line":273,"address":[],"length":0,"stats":{"Line":5}},{"line":276,"address":[],"length":0,"stats":{"Line":29}},{"line":280,"address":[],"length":0,"stats":{"Line":5}},{"line":281,"address":[],"length":0,"stats":{"Line":25}},{"line":282,"address":[],"length":0,"stats":{"Line":15}},{"line":285,"address":[],"length":0,"stats":{"Line":10}},{"line":286,"address":[],"length":0,"stats":{"Line":5}},{"line":287,"address":[],"length":0,"stats":{"Line":5}},{"line":288,"address":[],"length":0,"stats":{"Line":25}},{"line":290,"address":[],"length":0,"stats":{"Line":0}},{"line":293,"address":[],"length":0,"stats":{"Line":10}},{"line":297,"address":[],"length":0,"stats":{"Line":15}},{"line":299,"address":[],"length":0,"stats":{"Line":5}},{"line":300,"address":[],"length":0,"stats":{"Line":10}},{"line":301,"address":[],"length":0,"stats":{"Line":5}},{"line":302,"address":[],"length":0,"stats":{"Line":5}},{"line":307,"address":[],"length":0,"stats":{"Line":30}},{"line":312,"address":[],"length":0,"stats":{"Line":30}},{"line":316,"address":[],"length":0,"stats":{"Line":30}},{"line":318,"address":[],"length":0,"stats":{"Line":120}},{"line":320,"address":[],"length":0,"stats":{"Line":30}},{"line":321,"address":[],"length":0,"stats":{"Line":30}},{"line":322,"address":[],"length":0,"stats":{"Line":30}},{"line":323,"address":[],"length":0,"stats":{"Line":30}},{"line":328,"address":[],"length":0,"stats":{"Line":4}},{"line":332,"address":[],"length":0,"stats":{"Line":12}},{"line":334,"address":[],"length":0,"stats":{"Line":4}},{"line":335,"address":[],"length":0,"stats":{"Line":4}},{"line":336,"address":[],"length":0,"stats":{"Line":4}},{"line":337,"address":[],"length":0,"stats":{"Line":4}},{"line":342,"address":[],"length":0,"stats":{"Line":10}},{"line":343,"address":[],"length":0,"stats":{"Line":30}},{"line":349,"address":[],"length":0,"stats":{"Line":0}},{"line":351,"address":[],"length":0,"stats":{"Line":0}},{"line":352,"address":[],"length":0,"stats":{"Line":0}},{"line":354,"address":[],"length":0,"stats":{"Line":0}},{"line":355,"address":[],"length":0,"stats":{"Line":0}},{"line":356,"address":[],"length":0,"stats":{"Line":0}},{"line":359,"address":[],"length":0,"stats":{"Line":0}},{"line":360,"address":[],"length":0,"stats":{"Line":0}},{"line":364,"address":[],"length":0,"stats":{"Line":0}},{"line":365,"address":[],"length":0,"stats":{"Line":0}},{"line":367,"address":[],"length":0,"stats":{"Line":0}},{"line":371,"address":[],"length":0,"stats":{"Line":0}},{"line":372,"address":[],"length":0,"stats":{"Line":0}},{"line":376,"address":[],"length":0,"stats":{"Line":1}},{"line":383,"address":[],"length":0,"stats":{"Line":4}},{"line":384,"address":[],"length":0,"stats":{"Line":1}},{"line":386,"address":[],"length":0,"stats":{"Line":2}},{"line":388,"address":[],"length":0,"stats":{"Line":2}},{"line":390,"address":[],"length":0,"stats":{"Line":3}},{"line":391,"address":[],"length":0,"stats":{"Line":2}},{"line":392,"address":[],"length":0,"stats":{"Line":4}},{"line":394,"address":[],"length":0,"stats":{"Line":0}},{"line":395,"address":[],"length":0,"stats":{"Line":0}},{"line":396,"address":[],"length":0,"stats":{"Line":0}},{"line":397,"address":[],"length":0,"stats":{"Line":0}},{"line":399,"address":[],"length":0,"stats":{"Line":0}},{"line":401,"address":[],"length":0,"stats":{"Line":0}},{"line":409,"address":[],"length":0,"stats":{"Line":1}},{"line":414,"address":[],"length":0,"stats":{"Line":0}},{"line":415,"address":[],"length":0,"stats":{"Line":0}},{"line":420,"address":[],"length":0,"stats":{"Line":37}},{"line":421,"address":[],"length":0,"stats":{"Line":37}},{"line":422,"address":[],"length":0,"stats":{"Line":111}},{"line":423,"address":[],"length":0,"stats":{"Line":0}},{"line":424,"address":[],"length":0,"stats":{"Line":0}},{"line":429,"address":[],"length":0,"stats":{"Line":12}},{"line":434,"address":[],"length":0,"stats":{"Line":12}},{"line":435,"address":[],"length":0,"stats":{"Line":36}},{"line":437,"address":[],"length":0,"stats":{"Line":24}},{"line":438,"address":[],"length":0,"stats":{"Line":12}},{"line":440,"address":[],"length":0,"stats":{"Line":12}},{"line":441,"address":[],"length":0,"stats":{"Line":24}},{"line":442,"address":[],"length":0,"stats":{"Line":48}},{"line":444,"address":[],"length":0,"stats":{"Line":24}},{"line":446,"address":[],"length":0,"stats":{"Line":0}},{"line":447,"address":[],"length":0,"stats":{"Line":0}},{"line":451,"address":[],"length":0,"stats":{"Line":24}},{"line":452,"address":[],"length":0,"stats":{"Line":0}},{"line":454,"address":[],"length":0,"stats":{"Line":0}},{"line":455,"address":[],"length":0,"stats":{"Line":0}},{"line":456,"address":[],"length":0,"stats":{"Line":0}},{"line":458,"address":[],"length":0,"stats":{"Line":0}},{"line":460,"address":[],"length":0,"stats":{"Line":36}},{"line":461,"address":[],"length":0,"stats":{"Line":0}},{"line":465,"address":[],"length":0,"stats":{"Line":12}},{"line":466,"address":[],"length":0,"stats":{"Line":24}},{"line":467,"address":[],"length":0,"stats":{"Line":0}},{"line":468,"address":[],"length":0,"stats":{"Line":0}},{"line":469,"address":[],"length":0,"stats":{"Line":0}},{"line":470,"address":[],"length":0,"stats":{"Line":0}},{"line":471,"address":[],"length":0,"stats":{"Line":0}},{"line":472,"address":[],"length":0,"stats":{"Line":0}},{"line":474,"address":[],"length":0,"stats":{"Line":0}},{"line":475,"address":[],"length":0,"stats":{"Line":0}},{"line":476,"address":[],"length":0,"stats":{"Line":0}},{"line":477,"address":[],"length":0,"stats":{"Line":0}},{"line":478,"address":[],"length":0,"stats":{"Line":0}},{"line":480,"address":[],"length":0,"stats":{"Line":0}},{"line":481,"address":[],"length":0,"stats":{"Line":0}},{"line":482,"address":[],"length":0,"stats":{"Line":0}},{"line":483,"address":[],"length":0,"stats":{"Line":0}},{"line":484,"address":[],"length":0,"stats":{"Line":0}},{"line":486,"address":[],"length":0,"stats":{"Line":0}},{"line":487,"address":[],"length":0,"stats":{"Line":0}},{"line":488,"address":[],"length":0,"stats":{"Line":0}},{"line":489,"address":[],"length":0,"stats":{"Line":0}},{"line":490,"address":[],"length":0,"stats":{"Line":0}},{"line":492,"address":[],"length":0,"stats":{"Line":0}},{"line":495,"address":[],"length":0,"stats":{"Line":0}},{"line":514,"address":[],"length":0,"stats":{"Line":0}},{"line":515,"address":[],"length":0,"stats":{"Line":0}},{"line":516,"address":[],"length":0,"stats":{"Line":0}},{"line":517,"address":[],"length":0,"stats":{"Line":0}}],"covered":160,"coverable":229},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","lexer","lexer.rs"],"content":"//! SQL Lexer implementation\n//! Tokenizes SQL input strings into tokens\n\nuse super::token::Token;\n\n/// SQL Lexer - Tokenizer\n///\n/// # What (是什么)\n/// Lexer 将原始 SQL 字符串分解为 Token 序列，是编译器的第一阶段\n///\n/// # Why (为什么)\n/// Parser 需要结构化的 Token 而不是原始字符串，Lexer 负责这项转换工作\n///\n/// # How (如何实现)\n/// - 逐字符扫描输入\n/// - 识别关键字、标识符、字面量、运算符\n/// - 跳过空白字符\n/// - 使用有限状态机处理不同 token 类型\npub struct Lexer\u003c'a\u003e {\n    input: \u0026'a str,\n    position: usize,\n}\n\nimpl\u003c'a\u003e Lexer\u003c'a\u003e {\n    /// Create a new lexer for the given input\n    pub fn new(input: \u0026'a str) -\u003e Self {\n        Self { input, position: 0 }\n    }\n\n    /// Get the current position in the input\n    pub fn position(\u0026self) -\u003e usize {\n        self.position\n    }\n\n    /// Check if we've reached the end of input\n    fn is_eof(\u0026self) -\u003e bool {\n        self.position \u003e= self.input.len()\n    }\n\n    /// Get the current character without advancing\n    fn peek_char(\u0026self) -\u003e char {\n        self.input.chars().nth(self.position).unwrap_or('\\0')\n    }\n\n    /// Get the current character and advance\n    #[allow(dead_code)]\n    fn next_char(\u0026mut self) -\u003e char {\n        let ch = self.peek_char();\n        self.position += 1;\n        ch\n    }\n\n    /// Skip whitespace characters\n    fn skip_whitespace(\u0026mut self) {\n        while !self.is_eof() {\n            let ch = self.peek_char();\n            if !ch.is_whitespace() {\n                break;\n            }\n            self.position += 1;\n        }\n    }\n\n    /// Read a sequence of alphanumeric characters (for identifiers)\n    fn read_identifier(\u0026mut self) -\u003e String {\n        let start = self.position;\n        while !self.is_eof() {\n            let ch = self.peek_char();\n            if !ch.is_alphanumeric() \u0026\u0026 ch != '_' {\n                break;\n            }\n            self.position += 1;\n        }\n        self.input[start..self.position].to_string()\n    }\n\n    /// Read a number literal\n    fn read_number(\u0026mut self) -\u003e String {\n        let start = self.position;\n        let mut has_decimal = false;\n        while !self.is_eof() {\n            let ch = self.peek_char();\n            if ch == '.' {\n                if has_decimal {\n                    break;\n                }\n                has_decimal = true;\n            } else if !ch.is_ascii_digit() {\n                break;\n            }\n            self.position += 1;\n        }\n        self.input[start..self.position].to_string()\n    }\n\n    /// Read a string literal (single-quoted)\n    fn read_string(\u0026mut self) -\u003e String {\n        self.position += 1; // Skip opening quote\n        let start = self.position;\n\n        while !self.is_eof() {\n            let ch = self.peek_char();\n            if ch == '\\'' {\n                if self.input[self.position..].starts_with(\"''\") {\n                    self.position += 2;\n                    continue;\n                }\n                break;\n            }\n            self.position += 1;\n        }\n\n        let result = self.input[start..self.position].to_string();\n        if !self.is_eof() {\n            self.position += 1; // Skip closing quote\n        }\n        result\n    }\n\n    /// Get the next token from the input\n    pub fn next_token(\u0026mut self) -\u003e Token {\n        self.skip_whitespace();\n\n        if self.is_eof() {\n            return Token::Eof;\n        }\n\n        let ch = self.peek_char();\n\n        match ch {\n            '(' =\u003e {\n                self.position += 1;\n                Token::LParen\n            }\n            ')' =\u003e {\n                self.position += 1;\n                Token::RParen\n            }\n            ',' =\u003e {\n                self.position += 1;\n                Token::Comma\n            }\n            ';' =\u003e {\n                self.position += 1;\n                Token::Semicolon\n            }\n            '*' =\u003e {\n                self.position += 1;\n                Token::Star\n            }\n            '+' =\u003e {\n                self.position += 1;\n                Token::Plus\n            }\n            '-' =\u003e {\n                self.position += 1;\n                Token::Minus\n            }\n            '/' =\u003e {\n                self.position += 1;\n                Token::Slash\n            }\n            '%' =\u003e {\n                self.position += 1;\n                Token::Percent\n            }\n            '.' =\u003e {\n                self.position += 1;\n                Token::Dot\n            }\n            ':' =\u003e {\n                self.position += 1;\n                Token::Colon\n            }\n            '\\'' =\u003e Token::StringLiteral(self.read_string()),\n            '=' =\u003e {\n                self.position += 1;\n                Token::Equal\n            }\n            '!' =\u003e {\n                if self.input[self.position..].starts_with(\"!=\") {\n                    self.position += 2;\n                    Token::NotEqual\n                } else {\n                    self.position += 1;\n                    Token::Not\n                }\n            }\n            '\u003e' =\u003e {\n                if self.input[self.position..].starts_with(\"\u003e=\") {\n                    self.position += 2;\n                    Token::GreaterEqual\n                } else {\n                    self.position += 1;\n                    Token::Greater\n                }\n            }\n            '\u003c' =\u003e {\n                if self.input[self.position..].starts_with(\"\u003c=\") {\n                    self.position += 2;\n                    Token::LessEqual\n                } else if self.input[self.position..].starts_with(\"\u003c\u003e\") {\n                    self.position += 2;\n                    Token::NotEqual\n                } else {\n                    self.position += 1;\n                    Token::Less\n                }\n            }\n            _ if ch.is_alphabetic() || ch == '_' =\u003e {\n                let ident = self.read_identifier();\n                match ident.to_uppercase().as_str() {\n                    \"SELECT\" =\u003e Token::Select,\n                    \"FROM\" =\u003e Token::From,\n                    \"WHERE\" =\u003e Token::Where,\n                    \"INSERT\" =\u003e Token::Insert,\n                    \"INTO\" =\u003e Token::Into,\n                    \"VALUES\" =\u003e Token::Values,\n                    \"UPDATE\" =\u003e Token::Update,\n                    \"SET\" =\u003e Token::Set,\n                    \"DELETE\" =\u003e Token::Delete,\n                    \"CREATE\" =\u003e Token::Create,\n                    \"TABLE\" =\u003e Token::Table,\n                    \"DROP\" =\u003e Token::Drop,\n                    \"ALTER\" =\u003e Token::Alter,\n                    \"INDEX\" =\u003e Token::Index,\n                    \"ON\" =\u003e Token::On,\n                    \"PRIMARY\" =\u003e Token::Primary,\n                    \"KEY\" =\u003e Token::Key,\n                    \"BEGIN\" =\u003e Token::Begin,\n                    \"COMMIT\" =\u003e Token::Commit,\n                    \"ROLLBACK\" =\u003e Token::Rollback,\n                    \"GRANT\" =\u003e Token::Grant,\n                    \"REVOKE\" =\u003e Token::Revoke,\n                    \"INTEGER\" | \"INT\" =\u003e Token::Integer,\n                    \"TEXT\" | \"VARCHAR\" | \"CHAR\" =\u003e Token::Text,\n                    \"FLOAT\" | \"DOUBLE\" | \"REAL\" =\u003e Token::Float,\n                    \"BOOLEAN\" | \"BOOL\" =\u003e Token::Boolean,\n                    \"BLOB\" =\u003e Token::Blob,\n                    \"NULL\" =\u003e Token::Null,\n                    \"TRUE\" =\u003e Token::BooleanLiteral(true),\n                    \"FALSE\" =\u003e Token::BooleanLiteral(false),\n                    \"AND\" =\u003e Token::And,\n                    \"OR\" =\u003e Token::Or,\n                    \"NOT\" =\u003e Token::Not,\n                    _ =\u003e Token::Identifier(ident),\n                }\n            }\n            _ if ch.is_ascii_digit() =\u003e Token::NumberLiteral(self.read_number()),\n            _ =\u003e {\n                self.position += 1;\n                Token::Identifier(ch.to_string())\n            }\n        }\n    }\n\n    /// Tokenize the entire input and return a vector of tokens\n    pub fn tokenize(\u0026mut self) -\u003e Vec\u003cToken\u003e {\n        let mut tokens = Vec::new();\n        loop {\n            let token = self.next_token();\n            tokens.push(token.clone());\n            if matches!(token, Token::Eof) {\n                break;\n            }\n        }\n        tokens\n    }\n}\n\n/// Convenience function to tokenize a SQL string\npub fn tokenize(sql: \u0026str) -\u003e Vec\u003cToken\u003e {\n    let mut lexer = Lexer::new(sql);\n    lexer.tokenize()\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_simple_select() {\n        let mut lexer = Lexer::new(\"SELECT id FROM users WHERE id = 1\");\n        let tokens = lexer.tokenize();\n        assert_eq!(tokens[0], Token::Select);\n        assert_eq!(tokens[1], Token::Identifier(\"id\".to_string()));\n        assert_eq!(tokens[2], Token::From);\n        assert_eq!(tokens[3], Token::Identifier(\"users\".to_string()));\n        assert_eq!(tokens[4], Token::Where);\n        assert_eq!(tokens[5], Token::Identifier(\"id\".to_string()));\n        assert_eq!(tokens[6], Token::Equal);\n        assert_eq!(tokens[7], Token::NumberLiteral(\"1\".to_string()));\n        assert_eq!(tokens.last().unwrap(), \u0026Token::Eof);\n    }\n\n    #[test]\n    fn test_operators() {\n        // Basic lexer test\n        let tokens = tokenize(\"SELECT\");\n        assert_eq!(tokens.len(), 2); // SELECT + EOF\n        assert_eq!(tokens[0], Token::Select);\n    }\n\n    #[test]\n    fn test_keywords_case_insensitive() {\n        let tokens = tokenize(\"select * from users\");\n        assert_eq!(tokens[0], Token::Select);\n        assert_eq!(tokens[2], Token::From);\n    }\n\n    #[test]\n    fn test_all_keywords() {\n        let sql = \"SELECT INSERT UPDATE DELETE CREATE DROP TABLE\";\n        let tokens = tokenize(sql);\n        assert_eq!(tokens[0], Token::Select);\n        assert_eq!(tokens[1], Token::Insert);\n        assert_eq!(tokens[2], Token::Update);\n        assert_eq!(tokens[3], Token::Delete);\n        assert_eq!(tokens[4], Token::Create);\n        assert_eq!(tokens[5], Token::Drop);\n        assert_eq!(tokens[6], Token::Table);\n    }\n\n    #[test]\n    fn test_lexer_string_literal() {\n        let tokens = Lexer::new(\"'hello world'\").tokenize();\n        assert!(matches!(\u0026tokens[0], Token::StringLiteral(s) if s == \"hello world\"));\n    }\n\n    #[test]\n    fn test_lexer_operators() {\n        let tokens = Lexer::new(\"\u003c\u003e \u003c= \u003e=\").tokenize();\n        assert!(matches!(tokens[0], Token::NotEqual));\n        assert!(matches!(tokens[1], Token::LessEqual));\n        assert!(matches!(tokens[2], Token::GreaterEqual));\n    }\n\n    #[test]\n    fn test_lexer_multiple_statements() {\n        let tokens = Lexer::new(\"SELECT 1; SELECT 2\").tokenize();\n        // tokens structure: [Select, NumberLiteral(1), Semicolon, Select, NumberLiteral(2), Eof]\n        // Semicolon is at index 2\n        assert!(matches!(\u0026tokens[2], Token::Semicolon));\n    }\n}\n","traces":[{"line":26,"address":[],"length":0,"stats":{"Line":102}},{"line":31,"address":[],"length":0,"stats":{"Line":0}},{"line":32,"address":[],"length":0,"stats":{"Line":0}},{"line":36,"address":[],"length":0,"stats":{"Line":5039}},{"line":37,"address":[],"length":0,"stats":{"Line":10078}},{"line":41,"address":[],"length":0,"stats":{"Line":4763}},{"line":42,"address":[],"length":0,"stats":{"Line":19052}},{"line":47,"address":[],"length":0,"stats":{"Line":0}},{"line":48,"address":[],"length":0,"stats":{"Line":0}},{"line":49,"address":[],"length":0,"stats":{"Line":0}},{"line":50,"address":[],"length":0,"stats":{"Line":0}},{"line":54,"address":[],"length":0,"stats":{"Line":825}},{"line":55,"address":[],"length":0,"stats":{"Line":1300}},{"line":56,"address":[],"length":0,"stats":{"Line":3594}},{"line":57,"address":[],"length":0,"stats":{"Line":1198}},{"line":58,"address":[],"length":0,"stats":{"Line":723}},{"line":60,"address":[],"length":0,"stats":{"Line":475}},{"line":65,"address":[],"length":0,"stats":{"Line":470}},{"line":66,"address":[],"length":0,"stats":{"Line":940}},{"line":67,"address":[],"length":0,"stats":{"Line":2662}},{"line":68,"address":[],"length":0,"stats":{"Line":7893}},{"line":69,"address":[],"length":0,"stats":{"Line":3070}},{"line":70,"address":[],"length":0,"stats":{"Line":439}},{"line":72,"address":[],"length":0,"stats":{"Line":2192}},{"line":74,"address":[],"length":0,"stats":{"Line":1410}},{"line":78,"address":[],"length":0,"stats":{"Line":49}},{"line":79,"address":[],"length":0,"stats":{"Line":98}},{"line":80,"address":[],"length":0,"stats":{"Line":98}},{"line":81,"address":[],"length":0,"stats":{"Line":106}},{"line":82,"address":[],"length":0,"stats":{"Line":261}},{"line":83,"address":[],"length":0,"stats":{"Line":87}},{"line":84,"address":[],"length":0,"stats":{"Line":0}},{"line":85,"address":[],"length":0,"stats":{"Line":0}},{"line":87,"address":[],"length":0,"stats":{"Line":0}},{"line":88,"address":[],"length":0,"stats":{"Line":87}},{"line":89,"address":[],"length":0,"stats":{"Line":30}},{"line":91,"address":[],"length":0,"stats":{"Line":57}},{"line":93,"address":[],"length":0,"stats":{"Line":147}},{"line":97,"address":[],"length":0,"stats":{"Line":22}},{"line":98,"address":[],"length":0,"stats":{"Line":22}},{"line":99,"address":[],"length":0,"stats":{"Line":44}},{"line":101,"address":[],"length":0,"stats":{"Line":124}},{"line":102,"address":[],"length":0,"stats":{"Line":372}},{"line":103,"address":[],"length":0,"stats":{"Line":124}},{"line":104,"address":[],"length":0,"stats":{"Line":44}},{"line":105,"address":[],"length":0,"stats":{"Line":0}},{"line":106,"address":[],"length":0,"stats":{"Line":0}},{"line":108,"address":[],"length":0,"stats":{"Line":22}},{"line":110,"address":[],"length":0,"stats":{"Line":102}},{"line":113,"address":[],"length":0,"stats":{"Line":88}},{"line":114,"address":[],"length":0,"stats":{"Line":44}},{"line":115,"address":[],"length":0,"stats":{"Line":22}},{"line":117,"address":[],"length":0,"stats":{"Line":22}},{"line":121,"address":[],"length":0,"stats":{"Line":825}},{"line":122,"address":[],"length":0,"stats":{"Line":1650}},{"line":124,"address":[],"length":0,"stats":{"Line":1650}},{"line":125,"address":[],"length":0,"stats":{"Line":102}},{"line":128,"address":[],"length":0,"stats":{"Line":2169}},{"line":130,"address":[],"length":0,"stats":{"Line":49}},{"line":131,"address":[],"length":0,"stats":{"Line":0}},{"line":132,"address":[],"length":0,"stats":{"Line":52}},{"line":133,"address":[],"length":0,"stats":{"Line":52}},{"line":135,"address":[],"length":0,"stats":{"Line":0}},{"line":136,"address":[],"length":0,"stats":{"Line":52}},{"line":137,"address":[],"length":0,"stats":{"Line":52}},{"line":139,"address":[],"length":0,"stats":{"Line":0}},{"line":140,"address":[],"length":0,"stats":{"Line":41}},{"line":141,"address":[],"length":0,"stats":{"Line":41}},{"line":143,"address":[],"length":0,"stats":{"Line":0}},{"line":144,"address":[],"length":0,"stats":{"Line":1}},{"line":145,"address":[],"length":0,"stats":{"Line":1}},{"line":147,"address":[],"length":0,"stats":{"Line":0}},{"line":148,"address":[],"length":0,"stats":{"Line":8}},{"line":149,"address":[],"length":0,"stats":{"Line":8}},{"line":151,"address":[],"length":0,"stats":{"Line":0}},{"line":152,"address":[],"length":0,"stats":{"Line":0}},{"line":153,"address":[],"length":0,"stats":{"Line":0}},{"line":155,"address":[],"length":0,"stats":{"Line":0}},{"line":156,"address":[],"length":0,"stats":{"Line":0}},{"line":157,"address":[],"length":0,"stats":{"Line":0}},{"line":159,"address":[],"length":0,"stats":{"Line":0}},{"line":160,"address":[],"length":0,"stats":{"Line":0}},{"line":161,"address":[],"length":0,"stats":{"Line":0}},{"line":163,"address":[],"length":0,"stats":{"Line":0}},{"line":164,"address":[],"length":0,"stats":{"Line":0}},{"line":165,"address":[],"length":0,"stats":{"Line":0}},{"line":167,"address":[],"length":0,"stats":{"Line":0}},{"line":168,"address":[],"length":0,"stats":{"Line":0}},{"line":169,"address":[],"length":0,"stats":{"Line":0}},{"line":171,"address":[],"length":0,"stats":{"Line":0}},{"line":172,"address":[],"length":0,"stats":{"Line":0}},{"line":173,"address":[],"length":0,"stats":{"Line":0}},{"line":175,"address":[],"length":0,"stats":{"Line":22}},{"line":176,"address":[],"length":0,"stats":{"Line":0}},{"line":177,"address":[],"length":0,"stats":{"Line":21}},{"line":178,"address":[],"length":0,"stats":{"Line":21}},{"line":180,"address":[],"length":0,"stats":{"Line":0}},{"line":181,"address":[],"length":0,"stats":{"Line":0}},{"line":182,"address":[],"length":0,"stats":{"Line":0}},{"line":183,"address":[],"length":0,"stats":{"Line":0}},{"line":185,"address":[],"length":0,"stats":{"Line":0}},{"line":186,"address":[],"length":0,"stats":{"Line":0}},{"line":189,"address":[],"length":0,"stats":{"Line":0}},{"line":190,"address":[],"length":0,"stats":{"Line":10}},{"line":191,"address":[],"length":0,"stats":{"Line":5}},{"line":192,"address":[],"length":0,"stats":{"Line":5}},{"line":194,"address":[],"length":0,"stats":{"Line":0}},{"line":195,"address":[],"length":0,"stats":{"Line":0}},{"line":198,"address":[],"length":0,"stats":{"Line":0}},{"line":199,"address":[],"length":0,"stats":{"Line":4}},{"line":200,"address":[],"length":0,"stats":{"Line":1}},{"line":201,"address":[],"length":0,"stats":{"Line":1}},{"line":202,"address":[],"length":0,"stats":{"Line":2}},{"line":203,"address":[],"length":0,"stats":{"Line":1}},{"line":204,"address":[],"length":0,"stats":{"Line":1}},{"line":206,"address":[],"length":0,"stats":{"Line":0}},{"line":207,"address":[],"length":0,"stats":{"Line":0}},{"line":210,"address":[],"length":0,"stats":{"Line":1557}},{"line":211,"address":[],"length":0,"stats":{"Line":1410}},{"line":212,"address":[],"length":0,"stats":{"Line":470}},{"line":213,"address":[],"length":0,"stats":{"Line":495}},{"line":214,"address":[],"length":0,"stats":{"Line":471}},{"line":215,"address":[],"length":0,"stats":{"Line":437}},{"line":216,"address":[],"length":0,"stats":{"Line":425}},{"line":217,"address":[],"length":0,"stats":{"Line":400}},{"line":218,"address":[],"length":0,"stats":{"Line":377}},{"line":219,"address":[],"length":0,"stats":{"Line":339}},{"line":220,"address":[],"length":0,"stats":{"Line":330}},{"line":221,"address":[],"length":0,"stats":{"Line":324}},{"line":222,"address":[],"length":0,"stats":{"Line":341}},{"line":223,"address":[],"length":0,"stats":{"Line":313}},{"line":224,"address":[],"length":0,"stats":{"Line":243}},{"line":225,"address":[],"length":0,"stats":{"Line":231}},{"line":226,"address":[],"length":0,"stats":{"Line":231}},{"line":227,"address":[],"length":0,"stats":{"Line":231}},{"line":228,"address":[],"length":0,"stats":{"Line":233}},{"line":229,"address":[],"length":0,"stats":{"Line":231}},{"line":230,"address":[],"length":0,"stats":{"Line":227}},{"line":231,"address":[],"length":0,"stats":{"Line":227}},{"line":232,"address":[],"length":0,"stats":{"Line":227}},{"line":233,"address":[],"length":0,"stats":{"Line":227}},{"line":234,"address":[],"length":0,"stats":{"Line":227}},{"line":235,"address":[],"length":0,"stats":{"Line":458}},{"line":236,"address":[],"length":0,"stats":{"Line":583}},{"line":237,"address":[],"length":0,"stats":{"Line":555}},{"line":238,"address":[],"length":0,"stats":{"Line":370}},{"line":239,"address":[],"length":0,"stats":{"Line":185}},{"line":240,"address":[],"length":0,"stats":{"Line":185}},{"line":241,"address":[],"length":0,"stats":{"Line":185}},{"line":242,"address":[],"length":0,"stats":{"Line":185}},{"line":243,"address":[],"length":0,"stats":{"Line":185}},{"line":244,"address":[],"length":0,"stats":{"Line":185}},{"line":245,"address":[],"length":0,"stats":{"Line":185}},{"line":246,"address":[],"length":0,"stats":{"Line":185}},{"line":249,"address":[],"length":0,"stats":{"Line":196}},{"line":250,"address":[],"length":0,"stats":{"Line":0}},{"line":251,"address":[],"length":0,"stats":{"Line":0}},{"line":252,"address":[],"length":0,"stats":{"Line":0}},{"line":258,"address":[],"length":0,"stats":{"Line":102}},{"line":259,"address":[],"length":0,"stats":{"Line":204}},{"line":260,"address":[],"length":0,"stats":{"Line":0}},{"line":261,"address":[],"length":0,"stats":{"Line":2475}},{"line":262,"address":[],"length":0,"stats":{"Line":3300}},{"line":263,"address":[],"length":0,"stats":{"Line":1548}},{"line":264,"address":[],"length":0,"stats":{"Line":102}},{"line":267,"address":[],"length":0,"stats":{"Line":102}},{"line":272,"address":[],"length":0,"stats":{"Line":3}},{"line":273,"address":[],"length":0,"stats":{"Line":9}},{"line":274,"address":[],"length":0,"stats":{"Line":6}}],"covered":118,"coverable":169},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","lexer","mod.rs"],"content":"//! SQL Lexer Module\n//!\n//! This module provides lexical analysis (tokenization) for SQL statements.\n\n#[allow(clippy::module_inception)]\npub mod lexer;\npub mod token;\n\npub use lexer::Lexer;\npub use token::Token;\n\n/// Tokenize a SQL string into a vector of tokens\npub fn tokenize(sql: \u0026str) -\u003e Vec\u003cToken\u003e {\n    let mut lexer = Lexer::new(sql);\n    lexer.tokenize()\n}\n","traces":[{"line":13,"address":[],"length":0,"stats":{"Line":2}},{"line":14,"address":[],"length":0,"stats":{"Line":6}},{"line":15,"address":[],"length":0,"stats":{"Line":4}}],"covered":3,"coverable":3},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","lexer","token.rs"],"content":"//! Token definitions for SQL lexer\n//! SQL token types and token struct\n\nuse std::fmt;\n\n/// Token type enumeration representing all SQL lexical elements\n#[derive(Debug, Clone, PartialEq)]\npub enum Token {\n    // Keywords\n    Select,\n    From,\n    Where,\n    Insert,\n    Into,\n    Values,\n    Update,\n    Set,\n    Delete,\n    Create,\n    Table,\n    Drop,\n    Alter,\n    Index,\n    On,\n    Primary,\n    Key,\n    Begin,\n    Commit,\n    Rollback,\n    Grant,\n    Revoke,\n\n    // Data Types\n    Integer,\n    Text,\n    Float,\n    Boolean,\n    Blob,\n    Null,\n\n    // Operators\n    Equal,\n    NotEqual,\n    Greater,\n    Less,\n    GreaterEqual,\n    LessEqual,\n    And,\n    Or,\n    Not,\n    Plus,\n    Minus,\n    Asterisk,\n    Slash,\n    Percent,\n\n    // Syntax\n    LParen,\n    RParen,\n    Comma,\n    Dot,\n    Semicolon,\n    Colon,\n    SingleQuote,\n\n    // Wildcard\n    Star, // * for SELECT *\n\n    // Literals\n    Identifier(String),\n    StringLiteral(String),\n    NumberLiteral(String),\n    BooleanLiteral(bool),\n\n    // Special\n    Eof,\n}\n\nimpl fmt::Display for Token {\n    fn fmt(\u0026self, f: \u0026mut fmt::Formatter\u003c'_\u003e) -\u003e fmt::Result {\n        match self {\n            Token::Identifier(s) =\u003e write!(f, \"IDENTIFIER({})\", s),\n            Token::StringLiteral(s) =\u003e write!(f, \"'{}'\", s),\n            Token::NumberLiteral(s) =\u003e write!(f, \"{}\", s),\n            Token::BooleanLiteral(b) =\u003e write!(f, \"{}\", b),\n            // Keywords and data types - uppercase\n            Token::Select =\u003e write!(f, \"SELECT\"),\n            Token::From =\u003e write!(f, \"FROM\"),\n            Token::Where =\u003e write!(f, \"WHERE\"),\n            Token::Insert =\u003e write!(f, \"INSERT\"),\n            Token::Into =\u003e write!(f, \"INTO\"),\n            Token::Values =\u003e write!(f, \"VALUES\"),\n            Token::Update =\u003e write!(f, \"UPDATE\"),\n            Token::Set =\u003e write!(f, \"SET\"),\n            Token::Delete =\u003e write!(f, \"DELETE\"),\n            Token::Create =\u003e write!(f, \"CREATE\"),\n            Token::Table =\u003e write!(f, \"TABLE\"),\n            Token::Drop =\u003e write!(f, \"DROP\"),\n            Token::Alter =\u003e write!(f, \"ALTER\"),\n            Token::Index =\u003e write!(f, \"INDEX\"),\n            Token::On =\u003e write!(f, \"ON\"),\n            Token::Primary =\u003e write!(f, \"PRIMARY\"),\n            Token::Key =\u003e write!(f, \"KEY\"),\n            Token::Begin =\u003e write!(f, \"BEGIN\"),\n            Token::Commit =\u003e write!(f, \"COMMIT\"),\n            Token::Rollback =\u003e write!(f, \"ROLLBACK\"),\n            Token::Grant =\u003e write!(f, \"GRANT\"),\n            Token::Revoke =\u003e write!(f, \"REVOKE\"),\n            Token::Integer =\u003e write!(f, \"INTEGER\"),\n            Token::Text =\u003e write!(f, \"TEXT\"),\n            Token::Float =\u003e write!(f, \"FLOAT\"),\n            Token::Boolean =\u003e write!(f, \"BOOLEAN\"),\n            Token::Blob =\u003e write!(f, \"BLOB\"),\n            Token::Null =\u003e write!(f, \"NULL\"),\n            // Operators - uppercase\n            Token::Equal =\u003e write!(f, \"=\"),\n            Token::NotEqual =\u003e write!(f, \"\u003c\u003e\"),\n            Token::Greater =\u003e write!(f, \"\u003e\"),\n            Token::Less =\u003e write!(f, \"\u003c\"),\n            Token::GreaterEqual =\u003e write!(f, \"\u003e=\"),\n            Token::LessEqual =\u003e write!(f, \"\u003c=\"),\n            Token::And =\u003e write!(f, \"AND\"),\n            Token::Or =\u003e write!(f, \"OR\"),\n            Token::Not =\u003e write!(f, \"NOT\"),\n            Token::Plus =\u003e write!(f, \"+\"),\n            Token::Minus =\u003e write!(f, \"-\"),\n            Token::Asterisk =\u003e write!(f, \"*\"),\n            Token::Slash =\u003e write!(f, \"/\"),\n            Token::Percent =\u003e write!(f, \"%\"),\n            // Syntax\n            Token::LParen =\u003e write!(f, \"(\"),\n            Token::RParen =\u003e write!(f, \")\"),\n            Token::Comma =\u003e write!(f, \",\"),\n            Token::Dot =\u003e write!(f, \".\"),\n            Token::Semicolon =\u003e write!(f, \";\"),\n            Token::Colon =\u003e write!(f, \":\"),\n            Token::SingleQuote =\u003e write!(f, \"'\"),\n            Token::Star =\u003e write!(f, \"*\"),\n            Token::Eof =\u003e write!(f, \"EOF\"),\n        }\n    }\n}\n\n/// Check if a string is a SQL keyword\npub fn is_keyword(s: \u0026str) -\u003e bool {\n    matches!(\n        s.to_uppercase().as_str(),\n        \"SELECT\"\n            | \"FROM\"\n            | \"WHERE\"\n            | \"INSERT\"\n            | \"INTO\"\n            | \"VALUES\"\n            | \"UPDATE\"\n            | \"SET\"\n            | \"DELETE\"\n            | \"CREATE\"\n            | \"TABLE\"\n            | \"DROP\"\n            | \"ALTER\"\n            | \"INDEX\"\n            | \"ON\"\n            | \"PRIMARY\"\n            | \"KEY\"\n            | \"BEGIN\"\n            | \"COMMIT\"\n            | \"ROLLBACK\"\n            | \"GRANT\"\n            | \"REVOKE\"\n            | \"INTEGER\"\n            | \"TEXT\"\n            | \"FLOAT\"\n            | \"BOOLEAN\"\n            | \"BLOB\"\n            | \"NULL\"\n            | \"TRUE\"\n            | \"FALSE\"\n            | \"AND\"\n            | \"OR\"\n            | \"NOT\"\n    )\n}\n\n/// Convert a keyword string to its corresponding Token\npub fn from_keyword(s: \u0026str) -\u003e Option\u003cToken\u003e {\n    match s.to_uppercase().as_str() {\n        \"SELECT\" =\u003e Some(Token::Select),\n        \"FROM\" =\u003e Some(Token::From),\n        \"WHERE\" =\u003e Some(Token::Where),\n        \"INSERT\" =\u003e Some(Token::Insert),\n        \"INTO\" =\u003e Some(Token::Into),\n        \"VALUES\" =\u003e Some(Token::Values),\n        \"UPDATE\" =\u003e Some(Token::Update),\n        \"SET\" =\u003e Some(Token::Set),\n        \"DELETE\" =\u003e Some(Token::Delete),\n        \"CREATE\" =\u003e Some(Token::Create),\n        \"TABLE\" =\u003e Some(Token::Table),\n        \"DROP\" =\u003e Some(Token::Drop),\n        \"ALTER\" =\u003e Some(Token::Alter),\n        \"INDEX\" =\u003e Some(Token::Index),\n        \"ON\" =\u003e Some(Token::On),\n        \"PRIMARY\" =\u003e Some(Token::Primary),\n        \"KEY\" =\u003e Some(Token::Key),\n        \"BEGIN\" =\u003e Some(Token::Begin),\n        \"COMMIT\" =\u003e Some(Token::Commit),\n        \"ROLLBACK\" =\u003e Some(Token::Rollback),\n        \"GRANT\" =\u003e Some(Token::Grant),\n        \"REVOKE\" =\u003e Some(Token::Revoke),\n        \"INTEGER\" =\u003e Some(Token::Integer),\n        \"TEXT\" =\u003e Some(Token::Text),\n        \"FLOAT\" =\u003e Some(Token::Float),\n        \"BOOLEAN\" =\u003e Some(Token::Boolean),\n        \"BLOB\" =\u003e Some(Token::Blob),\n        \"NULL\" =\u003e Some(Token::Null),\n        \"TRUE\" =\u003e Some(Token::BooleanLiteral(true)),\n        \"FALSE\" =\u003e Some(Token::BooleanLiteral(false)),\n        \"AND\" =\u003e Some(Token::And),\n        \"OR\" =\u003e Some(Token::Or),\n        \"NOT\" =\u003e Some(Token::Not),\n        _ =\u003e None,\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_token_display() {\n        assert_eq!(Token::Select.to_string(), \"SELECT\");\n        assert_eq!(Token::Integer.to_string(), \"INTEGER\");\n        assert_eq!(\n            Token::Identifier(\"users\".to_string()).to_string(),\n            \"IDENTIFIER(users)\"\n        );\n        assert_eq!(\n            Token::StringLiteral(\"hello\".to_string()).to_string(),\n            \"'hello'\"\n        );\n        assert_eq!(Token::NumberLiteral(\"42\".to_string()).to_string(), \"42\");\n    }\n\n    #[test]\n    fn test_token_display_operators() {\n        assert_eq!(Token::Equal.to_string(), \"=\");\n        assert_eq!(Token::NotEqual.to_string(), \"\u003c\u003e\");\n        assert_eq!(Token::Greater.to_string(), \"\u003e\");\n        assert_eq!(Token::Less.to_string(), \"\u003c\");\n        assert_eq!(Token::GreaterEqual.to_string(), \"\u003e=\");\n        assert_eq!(Token::LessEqual.to_string(), \"\u003c=\");\n        assert_eq!(Token::And.to_string(), \"AND\");\n        assert_eq!(Token::Or.to_string(), \"OR\");\n        assert_eq!(Token::Not.to_string(), \"NOT\");\n        assert_eq!(Token::Plus.to_string(), \"+\");\n        assert_eq!(Token::Minus.to_string(), \"-\");\n        assert_eq!(Token::Asterisk.to_string(), \"*\");\n        assert_eq!(Token::Slash.to_string(), \"/\");\n        assert_eq!(Token::Percent.to_string(), \"%\");\n    }\n\n    #[test]\n    fn test_token_display_syntax() {\n        assert_eq!(Token::LParen.to_string(), \"(\");\n        assert_eq!(Token::RParen.to_string(), \")\");\n        assert_eq!(Token::Comma.to_string(), \",\");\n        assert_eq!(Token::Dot.to_string(), \".\");\n        assert_eq!(Token::Semicolon.to_string(), \";\");\n        assert_eq!(Token::Colon.to_string(), \":\");\n        assert_eq!(Token::SingleQuote.to_string(), \"'\");\n        assert_eq!(Token::Star.to_string(), \"*\");\n        assert_eq!(Token::Eof.to_string(), \"EOF\");\n    }\n\n    #[test]\n    fn test_token_display_keywords() {\n        assert_eq!(Token::From.to_string(), \"FROM\");\n        assert_eq!(Token::Where.to_string(), \"WHERE\");\n        assert_eq!(Token::Insert.to_string(), \"INSERT\");\n        assert_eq!(Token::Into.to_string(), \"INTO\");\n        assert_eq!(Token::Values.to_string(), \"VALUES\");\n        assert_eq!(Token::Update.to_string(), \"UPDATE\");\n        assert_eq!(Token::Set.to_string(), \"SET\");\n        assert_eq!(Token::Delete.to_string(), \"DELETE\");\n        assert_eq!(Token::Create.to_string(), \"CREATE\");\n        assert_eq!(Token::Table.to_string(), \"TABLE\");\n        assert_eq!(Token::Drop.to_string(), \"DROP\");\n        assert_eq!(Token::Alter.to_string(), \"ALTER\");\n        assert_eq!(Token::Index.to_string(), \"INDEX\");\n    }\n\n    #[test]\n    fn test_token_display_data_types() {\n        assert_eq!(Token::Text.to_string(), \"TEXT\");\n        assert_eq!(Token::Float.to_string(), \"FLOAT\");\n        assert_eq!(Token::Boolean.to_string(), \"BOOLEAN\");\n        assert_eq!(Token::Blob.to_string(), \"BLOB\");\n        assert_eq!(Token::Null.to_string(), \"NULL\");\n    }\n\n    #[test]\n    fn test_token_display_transaction() {\n        assert_eq!(Token::Begin.to_string(), \"BEGIN\");\n        assert_eq!(Token::Commit.to_string(), \"COMMIT\");\n        assert_eq!(Token::Rollback.to_string(), \"ROLLBACK\");\n        assert_eq!(Token::Grant.to_string(), \"GRANT\");\n        assert_eq!(Token::Revoke.to_string(), \"REVOKE\");\n    }\n\n    #[test]\n    fn test_token_display_other_keywords() {\n        assert_eq!(Token::On.to_string(), \"ON\");\n        assert_eq!(Token::Primary.to_string(), \"PRIMARY\");\n        assert_eq!(Token::Key.to_string(), \"KEY\");\n    }\n\n    #[test]\n    fn test_token_boolean_literal() {\n        assert_eq!(Token::BooleanLiteral(true).to_string(), \"true\");\n        assert_eq!(Token::BooleanLiteral(false).to_string(), \"false\");\n    }\n\n    #[test]\n    fn test_token_clone() {\n        let token = Token::Identifier(\"test\".to_string());\n        let cloned = token.clone();\n        assert_eq!(token, cloned);\n    }\n\n    #[test]\n    fn test_is_keyword() {\n        assert!(is_keyword(\"SELECT\"));\n        assert!(is_keyword(\"select\"));\n        assert!(!is_keyword(\"users\"));\n        assert!(is_keyword(\"TRUE\"));\n        assert!(is_keyword(\"null\"));\n    }\n\n    #[test]\n    fn test_is_keyword_various() {\n        // Data type keywords\n        assert!(is_keyword(\"INTEGER\"));\n        assert!(is_keyword(\"TEXT\"));\n        assert!(is_keyword(\"FLOAT\"));\n        assert!(is_keyword(\"BOOLEAN\"));\n        assert!(is_keyword(\"BLOB\"));\n\n        // Boolean keywords\n        assert!(is_keyword(\"TRUE\"));\n        assert!(is_keyword(\"FALSE\"));\n\n        // Logical operators\n        assert!(is_keyword(\"AND\"));\n        assert!(is_keyword(\"OR\"));\n        assert!(is_keyword(\"NOT\"));\n\n        // Non-keyword\n        assert!(!is_keyword(\"users\"));\n        assert!(!is_keyword(\"foo\"));\n        assert!(!is_keyword(\"bar123\"));\n    }\n\n    #[test]\n    fn test_token_from_keyword() {\n        assert_eq!(from_keyword(\"SELECT\"), Some(Token::Select));\n        assert_eq!(from_keyword(\"INSERT\"), Some(Token::Insert));\n        assert_eq!(from_keyword(\"UNKNOWN\"), None);\n        assert_eq!(from_keyword(\"select\"), Some(Token::Select));\n        assert_eq!(from_keyword(\"TRUE\"), Some(Token::BooleanLiteral(true)));\n    }\n\n    #[test]\n    fn test_from_keyword_various() {\n        // DML keywords\n        assert_eq!(from_keyword(\"FROM\"), Some(Token::From));\n        assert_eq!(from_keyword(\"WHERE\"), Some(Token::Where));\n        assert_eq!(from_keyword(\"UPDATE\"), Some(Token::Update));\n        assert_eq!(from_keyword(\"SET\"), Some(Token::Set));\n        assert_eq!(from_keyword(\"DELETE\"), Some(Token::Delete));\n\n        // DDL keywords\n        assert_eq!(from_keyword(\"CREATE\"), Some(Token::Create));\n        assert_eq!(from_keyword(\"TABLE\"), Some(Token::Table));\n        assert_eq!(from_keyword(\"DROP\"), Some(Token::Drop));\n        assert_eq!(from_keyword(\"ALTER\"), Some(Token::Alter));\n        assert_eq!(from_keyword(\"INDEX\"), Some(Token::Index));\n\n        // Transaction keywords\n        assert_eq!(from_keyword(\"BEGIN\"), Some(Token::Begin));\n        assert_eq!(from_keyword(\"COMMIT\"), Some(Token::Commit));\n        assert_eq!(from_keyword(\"ROLLBACK\"), Some(Token::Rollback));\n\n        // Data types\n        assert_eq!(from_keyword(\"INTEGER\"), Some(Token::Integer));\n        assert_eq!(from_keyword(\"TEXT\"), Some(Token::Text));\n        assert_eq!(from_keyword(\"FLOAT\"), Some(Token::Float));\n        assert_eq!(from_keyword(\"BOOLEAN\"), Some(Token::Boolean));\n        assert_eq!(from_keyword(\"BLOB\"), Some(Token::Blob));\n        assert_eq!(from_keyword(\"NULL\"), Some(Token::Null));\n\n        // Boolean literals\n        assert_eq!(from_keyword(\"FALSE\"), Some(Token::BooleanLiteral(false)));\n\n        // Logical operators\n        assert_eq!(from_keyword(\"AND\"), Some(Token::And));\n        assert_eq!(from_keyword(\"OR\"), Some(Token::Or));\n        assert_eq!(from_keyword(\"NOT\"), Some(Token::Not));\n\n        // Case insensitive\n        assert_eq!(from_keyword(\"Select\"), Some(Token::Select));\n        assert_eq!(from_keyword(\"FROM\"), Some(Token::From));\n\n        // Non-keywords return None\n        assert_eq!(from_keyword(\"users\"), None);\n        assert_eq!(from_keyword(\"foo\"), None);\n    }\n\n    #[test]\n    fn test_token_debug() {\n        let token = Token::Identifier(\"test\".to_string());\n        let debug_str = format!(\"{:?}\", token);\n        assert!(debug_str.contains(\"Identifier\"));\n    }\n}\n","traces":[{"line":80,"address":[],"length":0,"stats":{"Line":56}},{"line":81,"address":[],"length":0,"stats":{"Line":56}},{"line":82,"address":[],"length":0,"stats":{"Line":3}},{"line":83,"address":[],"length":0,"stats":{"Line":3}},{"line":84,"address":[],"length":0,"stats":{"Line":3}},{"line":85,"address":[],"length":0,"stats":{"Line":6}},{"line":87,"address":[],"length":0,"stats":{"Line":2}},{"line":88,"address":[],"length":0,"stats":{"Line":2}},{"line":89,"address":[],"length":0,"stats":{"Line":2}},{"line":90,"address":[],"length":0,"stats":{"Line":2}},{"line":91,"address":[],"length":0,"stats":{"Line":2}},{"line":92,"address":[],"length":0,"stats":{"Line":2}},{"line":93,"address":[],"length":0,"stats":{"Line":2}},{"line":94,"address":[],"length":0,"stats":{"Line":2}},{"line":95,"address":[],"length":0,"stats":{"Line":2}},{"line":96,"address":[],"length":0,"stats":{"Line":2}},{"line":97,"address":[],"length":0,"stats":{"Line":2}},{"line":98,"address":[],"length":0,"stats":{"Line":2}},{"line":99,"address":[],"length":0,"stats":{"Line":2}},{"line":100,"address":[],"length":0,"stats":{"Line":2}},{"line":101,"address":[],"length":0,"stats":{"Line":2}},{"line":102,"address":[],"length":0,"stats":{"Line":2}},{"line":103,"address":[],"length":0,"stats":{"Line":2}},{"line":104,"address":[],"length":0,"stats":{"Line":2}},{"line":105,"address":[],"length":0,"stats":{"Line":2}},{"line":106,"address":[],"length":0,"stats":{"Line":2}},{"line":107,"address":[],"length":0,"stats":{"Line":2}},{"line":108,"address":[],"length":0,"stats":{"Line":2}},{"line":109,"address":[],"length":0,"stats":{"Line":2}},{"line":110,"address":[],"length":0,"stats":{"Line":2}},{"line":111,"address":[],"length":0,"stats":{"Line":2}},{"line":112,"address":[],"length":0,"stats":{"Line":2}},{"line":113,"address":[],"length":0,"stats":{"Line":2}},{"line":114,"address":[],"length":0,"stats":{"Line":2}},{"line":116,"address":[],"length":0,"stats":{"Line":2}},{"line":117,"address":[],"length":0,"stats":{"Line":2}},{"line":118,"address":[],"length":0,"stats":{"Line":2}},{"line":119,"address":[],"length":0,"stats":{"Line":2}},{"line":120,"address":[],"length":0,"stats":{"Line":2}},{"line":121,"address":[],"length":0,"stats":{"Line":2}},{"line":122,"address":[],"length":0,"stats":{"Line":2}},{"line":123,"address":[],"length":0,"stats":{"Line":2}},{"line":124,"address":[],"length":0,"stats":{"Line":2}},{"line":125,"address":[],"length":0,"stats":{"Line":2}},{"line":126,"address":[],"length":0,"stats":{"Line":2}},{"line":127,"address":[],"length":0,"stats":{"Line":2}},{"line":128,"address":[],"length":0,"stats":{"Line":2}},{"line":129,"address":[],"length":0,"stats":{"Line":2}},{"line":131,"address":[],"length":0,"stats":{"Line":2}},{"line":132,"address":[],"length":0,"stats":{"Line":2}},{"line":133,"address":[],"length":0,"stats":{"Line":2}},{"line":134,"address":[],"length":0,"stats":{"Line":2}},{"line":135,"address":[],"length":0,"stats":{"Line":2}},{"line":136,"address":[],"length":0,"stats":{"Line":2}},{"line":137,"address":[],"length":0,"stats":{"Line":2}},{"line":138,"address":[],"length":0,"stats":{"Line":2}},{"line":139,"address":[],"length":0,"stats":{"Line":2}},{"line":145,"address":[],"length":0,"stats":{"Line":18}},{"line":146,"address":[],"length":0,"stats":{"Line":14}},{"line":147,"address":[],"length":0,"stats":{"Line":18}},{"line":185,"address":[],"length":0,"stats":{"Line":32}},{"line":186,"address":[],"length":0,"stats":{"Line":32}},{"line":187,"address":[],"length":0,"stats":{"Line":35}},{"line":188,"address":[],"length":0,"stats":{"Line":31}},{"line":189,"address":[],"length":0,"stats":{"Line":28}},{"line":190,"address":[],"length":0,"stats":{"Line":27}},{"line":191,"address":[],"length":0,"stats":{"Line":25}},{"line":192,"address":[],"length":0,"stats":{"Line":25}},{"line":193,"address":[],"length":0,"stats":{"Line":26}},{"line":194,"address":[],"length":0,"stats":{"Line":25}},{"line":195,"address":[],"length":0,"stats":{"Line":24}},{"line":196,"address":[],"length":0,"stats":{"Line":23}},{"line":197,"address":[],"length":0,"stats":{"Line":22}},{"line":198,"address":[],"length":0,"stats":{"Line":21}},{"line":199,"address":[],"length":0,"stats":{"Line":20}},{"line":200,"address":[],"length":0,"stats":{"Line":19}},{"line":201,"address":[],"length":0,"stats":{"Line":17}},{"line":202,"address":[],"length":0,"stats":{"Line":17}},{"line":203,"address":[],"length":0,"stats":{"Line":17}},{"line":204,"address":[],"length":0,"stats":{"Line":18}},{"line":205,"address":[],"length":0,"stats":{"Line":17}},{"line":206,"address":[],"length":0,"stats":{"Line":16}},{"line":207,"address":[],"length":0,"stats":{"Line":14}},{"line":208,"address":[],"length":0,"stats":{"Line":14}},{"line":209,"address":[],"length":0,"stats":{"Line":15}},{"line":210,"address":[],"length":0,"stats":{"Line":14}},{"line":211,"address":[],"length":0,"stats":{"Line":13}},{"line":212,"address":[],"length":0,"stats":{"Line":12}},{"line":213,"address":[],"length":0,"stats":{"Line":11}},{"line":214,"address":[],"length":0,"stats":{"Line":10}},{"line":215,"address":[],"length":0,"stats":{"Line":9}},{"line":216,"address":[],"length":0,"stats":{"Line":8}},{"line":217,"address":[],"length":0,"stats":{"Line":7}},{"line":218,"address":[],"length":0,"stats":{"Line":6}},{"line":219,"address":[],"length":0,"stats":{"Line":5}},{"line":220,"address":[],"length":0,"stats":{"Line":3}}],"covered":96,"coverable":96},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","lib.rs"],"content":"//! SQLRustGo Database System Library\n//!\n//! A Rust implementation of a SQL-92 compliant database system.\n\npub mod executor;\npub mod lexer;\npub mod network;\npub mod parser;\npub mod storage;\npub mod transaction;\npub mod types;\n\npub use executor::{ExecutionEngine, ExecutionResult, execute};\npub use lexer::{Lexer, Token, tokenize};\npub use network::{NetworkHandler, connect, start_server_sync};\npub use parser::{Statement, parse};\npub use storage::{BPlusTree, BufferPool, FileStorage, Page};\npub use transaction::{TransactionManager, TxState, WriteAheadLog};\npub use types::{SqlError, SqlResult, Value, parse_sql_literal};\n\n/// Initialize the database system\npub fn init() {\n    println!(\"SQLRustGo Database System initialized\");\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_init() {\n        init();\n    }\n\n    #[test]\n    fn test_types() {\n        let v = types::Value::Integer(42);\n        assert_eq!(v.to_string(), \"42\");\n    }\n\n    #[test]\n    fn test_lexer() {\n        let tokens = tokenize(\"SELECT id FROM users\");\n        assert!(!tokens.is_empty());\n    }\n\n    #[test]\n    fn test_parser() {\n        let result = parse(\"SELECT id FROM users\");\n        assert!(result.is_ok());\n    }\n\n    #[test]\n    fn test_storage() {\n        let page = storage::Page::new(1);\n        assert_eq!(page.page_id(), 1);\n    }\n\n    #[test]\n    fn test_bplus_tree() {\n        let mut tree = storage::BPlusTree::new();\n        tree.insert(10, 100);\n        assert_eq!(tree.search(10), Some(100));\n    }\n\n    #[test]\n    fn test_executor() {\n        let mut engine = ExecutionEngine::new();\n        let result = engine.execute(parse(\"CREATE TABLE users\").unwrap());\n        assert!(result.is_ok());\n        assert!(engine.get_table(\"users\").is_some());\n    }\n\n    #[test]\n    fn test_transaction() {\n        use std::sync::Arc;\n\n        let path = \"/tmp/lib_test_wal.log\";\n        std::fs::remove_file(path).ok();\n\n        let wal = Arc::new(WriteAheadLog::new(path).unwrap());\n        let tm = TransactionManager::new(wal);\n\n        let tx_id = tm.begin().unwrap();\n        assert!(tm.is_active(tx_id));\n\n        tm.commit(tx_id).unwrap();\n        assert!(!tm.is_active(tx_id));\n\n        std::fs::remove_file(path).ok();\n    }\n}\n","traces":[{"line":22,"address":[],"length":0,"stats":{"Line":3}},{"line":23,"address":[],"length":0,"stats":{"Line":3}}],"covered":2,"coverable":2},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","main.rs"],"content":"//! SQLRustGo - A Rust SQL-92 Database Implementation\n//!\n//! Interactive SQL REPL and command-line interface\n\nuse sqlrustgo::{ExecutionResult, init, parse};\nuse std::io::{self, Write};\nuse std::sync::Arc;\nuse std::sync::atomic::{AtomicBool, Ordering};\n\nfn main() {\n    println!(\"╔════════════════════════════════════════════════╗\");\n    println!(\"║       SQLRustGo v1.0.0                        ║\");\n    println!(\"║  A Rust SQL-92 Database Implementation       ║\");\n    println!(\"╚════════════════════════════════════════════════╝\");\n    println!();\n    println!(\"Type 'exit' or 'quit' to exit.\");\n    println!(\"Type '.help' for commands.\");\n    println!();\n\n    init();\n\n    let running = Arc::new(AtomicBool::new(true));\n    let r = running.clone();\n\n    ctrlc::set_handler(move || {\n        r.store(false, Ordering::SeqCst);\n    })\n    .expect(\"Error setting Ctrl-C handler\");\n\n    let mut engine = sqlrustgo::ExecutionEngine::new();\n\n    while running.load(Ordering::SeqCst) {\n        print!(\"sqlrustgo\u003e \");\n        io::stdout().flush().unwrap();\n\n        let mut input = String::new();\n        match io::stdin().read_line(\u0026mut input) {\n            Ok(0) | Err(_) =\u003e break,\n            Ok(_) =\u003e {\n                let input = input.trim();\n                if input.is_empty() {\n                    continue;\n                }\n\n                match process_input(input, \u0026mut engine) {\n                    Ok(Some(result)) =\u003e {\n                        print_result(result);\n                    }\n                    Ok(None) =\u003e {}\n                    Err(e) =\u003e {\n                        println!(\"Error: {}\", e);\n                    }\n                }\n            }\n        }\n    }\n\n    println!(\"\\nGoodbye!\");\n}\n\n/// Process user input\nfn process_input(\n    input: \u0026str,\n    engine: \u0026mut sqlrustgo::ExecutionEngine,\n) -\u003e Result\u003cOption\u003cExecutionResult\u003e, String\u003e {\n    // Handle special commands\n    if input.starts_with('.') {\n        return handle_command(input);\n    }\n\n    // Handle exit\n    if input.eq_ignore_ascii_case(\"exit\") || input.eq_ignore_ascii_case(\"quit\") {\n        std::process::exit(0);\n    }\n\n    // Execute SQL statement\n    match parse(input) {\n        Ok(statement) =\u003e match engine.execute(statement) {\n            Ok(result) =\u003e Ok(Some(result)),\n            Err(e) =\u003e Err(format!(\"Execution error: {}\", e)),\n        },\n        Err(e) =\u003e Err(format!(\"Parse error: {}\", e)),\n    }\n}\n\n/// Handle special commands\nfn handle_command(input: \u0026str) -\u003e Result\u003cOption\u003cExecutionResult\u003e, String\u003e {\n    match input {\n        \".help\" =\u003e {\n            println!(\"Available commands:\");\n            println!(\"  .help      Show this help message\");\n            println!(\"  .tables    List all tables\");\n            println!(\"  .schema    Show schema info\");\n            println!(\"  .exit      Exit the REPL\");\n            println!(\"  .quit      Exit the REPL\");\n            Ok(None)\n        }\n        \".tables\" =\u003e {\n            println!(\"Tables: (catalog not yet implemented)\");\n            Ok(None)\n        }\n        \".schema\" =\u003e {\n            println!(\"Schema: (catalog not yet implemented)\");\n            Ok(None)\n        }\n        \".exit\" | \".quit\" =\u003e {\n            std::process::exit(0);\n        }\n        _ =\u003e Err(\"Unknown command. Type .help for available commands.\".to_string()),\n    }\n}\n\n/// Print execution result\nfn print_result(result: ExecutionResult) {\n    if result.rows.is_empty() {\n        println!(\"OK, {} row(s) affected\", result.rows_affected);\n    } else {\n        println!(\"{} row(s) in set\", result.rows.len());\n    }\n}\n","traces":[{"line":10,"address":[],"length":0,"stats":{"Line":0}},{"line":11,"address":[],"length":0,"stats":{"Line":0}},{"line":12,"address":[],"length":0,"stats":{"Line":0}},{"line":13,"address":[],"length":0,"stats":{"Line":0}},{"line":14,"address":[],"length":0,"stats":{"Line":0}},{"line":15,"address":[],"length":0,"stats":{"Line":0}},{"line":16,"address":[],"length":0,"stats":{"Line":0}},{"line":17,"address":[],"length":0,"stats":{"Line":0}},{"line":18,"address":[],"length":0,"stats":{"Line":0}},{"line":20,"address":[],"length":0,"stats":{"Line":0}},{"line":22,"address":[],"length":0,"stats":{"Line":0}},{"line":23,"address":[],"length":0,"stats":{"Line":0}},{"line":25,"address":[],"length":0,"stats":{"Line":0}},{"line":26,"address":[],"length":0,"stats":{"Line":0}},{"line":30,"address":[],"length":0,"stats":{"Line":0}},{"line":32,"address":[],"length":0,"stats":{"Line":0}},{"line":33,"address":[],"length":0,"stats":{"Line":0}},{"line":34,"address":[],"length":0,"stats":{"Line":0}},{"line":36,"address":[],"length":0,"stats":{"Line":0}},{"line":37,"address":[],"length":0,"stats":{"Line":0}},{"line":38,"address":[],"length":0,"stats":{"Line":0}},{"line":40,"address":[],"length":0,"stats":{"Line":0}},{"line":41,"address":[],"length":0,"stats":{"Line":0}},{"line":42,"address":[],"length":0,"stats":{"Line":0}},{"line":45,"address":[],"length":0,"stats":{"Line":0}},{"line":46,"address":[],"length":0,"stats":{"Line":0}},{"line":47,"address":[],"length":0,"stats":{"Line":0}},{"line":49,"address":[],"length":0,"stats":{"Line":0}},{"line":50,"address":[],"length":0,"stats":{"Line":0}},{"line":51,"address":[],"length":0,"stats":{"Line":0}},{"line":58,"address":[],"length":0,"stats":{"Line":0}},{"line":62,"address":[],"length":0,"stats":{"Line":0}},{"line":67,"address":[],"length":0,"stats":{"Line":0}},{"line":68,"address":[],"length":0,"stats":{"Line":0}},{"line":72,"address":[],"length":0,"stats":{"Line":0}},{"line":73,"address":[],"length":0,"stats":{"Line":0}},{"line":77,"address":[],"length":0,"stats":{"Line":0}},{"line":78,"address":[],"length":0,"stats":{"Line":0}},{"line":79,"address":[],"length":0,"stats":{"Line":0}},{"line":80,"address":[],"length":0,"stats":{"Line":0}},{"line":82,"address":[],"length":0,"stats":{"Line":0}},{"line":87,"address":[],"length":0,"stats":{"Line":0}},{"line":88,"address":[],"length":0,"stats":{"Line":0}},{"line":89,"address":[],"length":0,"stats":{"Line":0}},{"line":90,"address":[],"length":0,"stats":{"Line":0}},{"line":91,"address":[],"length":0,"stats":{"Line":0}},{"line":92,"address":[],"length":0,"stats":{"Line":0}},{"line":93,"address":[],"length":0,"stats":{"Line":0}},{"line":94,"address":[],"length":0,"stats":{"Line":0}},{"line":95,"address":[],"length":0,"stats":{"Line":0}},{"line":96,"address":[],"length":0,"stats":{"Line":0}},{"line":98,"address":[],"length":0,"stats":{"Line":0}},{"line":99,"address":[],"length":0,"stats":{"Line":0}},{"line":100,"address":[],"length":0,"stats":{"Line":0}},{"line":102,"address":[],"length":0,"stats":{"Line":0}},{"line":103,"address":[],"length":0,"stats":{"Line":0}},{"line":104,"address":[],"length":0,"stats":{"Line":0}},{"line":106,"address":[],"length":0,"stats":{"Line":0}},{"line":107,"address":[],"length":0,"stats":{"Line":0}},{"line":109,"address":[],"length":0,"stats":{"Line":0}},{"line":114,"address":[],"length":0,"stats":{"Line":0}},{"line":115,"address":[],"length":0,"stats":{"Line":0}},{"line":116,"address":[],"length":0,"stats":{"Line":0}},{"line":118,"address":[],"length":0,"stats":{"Line":0}}],"covered":0,"coverable":64},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","network","mod.rs"],"content":"//! Network Layer for SQLRustGo\n//!\n//! Provides MySQL-compatible network protocol support for client-server architecture.\n\nuse crate::{SqlError, Value};\nuse bytes::{BufMut, BytesMut};\nuse std::io::{Read, Write};\nuse std::net::{TcpListener, TcpStream};\n\n/// MySQL protocol packet header size\nconst PACKET_HEADER_SIZE: usize = 4;\n\n/// MySQL protocol capability flags\npub mod capability {\n    pub const LONG_PASSWORD: u32 = 0x00000001;\n    pub const FOUND_ROWS: u32 = 0x00000002;\n    pub const LONG_FLAG: u32 = 0x00000004;\n    pub const CONNECT_WITH_DB: u32 = 0x00000008;\n    pub const NO_SCHEMA: u32 = 0x00000010;\n    pub const COMPRESS: u32 = 0x00000020;\n    pub const ODBC: u32 = 0x00000040;\n    pub const LOCAL_FILES: u32 = 0x00000080;\n    pub const IGNORE_SPACE: u32 = 0x00000100;\n    pub const PROTOCOL_41: u32 = 0x00000200;\n    pub const INTERACTIVE: u32 = 0x00000400;\n    pub const STATS: u32 = 0x00000800;\n    pub const RESERVED: u32 = 0x00001000;\n    pub const MULTI_STATEMENTS: u32 = 0x00010000;\n    pub const MULTI_RESULTS: u32 = 0x00020000;\n    pub const PS_MULTI_RESULTS: u32 = 0x00040000;\n    pub const PLUGIN_AUTH: u32 = 0x00080000;\n    pub const CONNECT_ATTRS: u32 = 0x00100000;\n    pub const PLUGIN_AUTH_LENENC_CLIENT_CAP: u32 = 0x00200000;\n    pub const CAN_HANDLE_EXPIRED_PASSWORDS: u32 = 0x00400000;\n    pub const SESSION_TRACK: u32 = 0x00800000;\n    pub const DEPRECATE_EOF: u32 = 0x01000000;\n    pub const UNKNOWN: u32 = 0x80000000;\n}\n\n/// MySQL command types\n#[derive(Debug, Clone)]\npub enum MySqlCommand {\n    Sleep,\n    Quit,\n    InitDb,\n    Query,\n    FieldList,\n    CreateDb,\n    DropDb,\n    Refresh,\n    Shutdown,\n    Statistics,\n    ProcessInfo,\n    Connect,\n    ProcessKill,\n    Debug,\n    Ping,\n    Time,\n    DelayedInsert,\n    ChangeUser,\n    BinlogDump,\n    TableDump,\n    ConnectOut,\n    RegisterSlave,\n    StmtPrepare,\n    StmtExecute,\n    StmtSendLongData,\n    StmtClose,\n    StmtReset,\n    SetOption,\n    StmtFetch,\n    Daemon,\n    BinlogDumpGtid,\n    ResetConnection,\n    Unknown(u8),\n}\n\nimpl From\u003cu8\u003e for MySqlCommand {\n    fn from(code: u8) -\u003e Self {\n        match code {\n            0x00 =\u003e MySqlCommand::Sleep,\n            0x01 =\u003e MySqlCommand::Quit,\n            0x02 =\u003e MySqlCommand::InitDb,\n            0x03 =\u003e MySqlCommand::Query,\n            0x04 =\u003e MySqlCommand::FieldList,\n            0x05 =\u003e MySqlCommand::CreateDb,\n            0x06 =\u003e MySqlCommand::DropDb,\n            0x07 =\u003e MySqlCommand::Refresh,\n            0x08 =\u003e MySqlCommand::Shutdown,\n            0x09 =\u003e MySqlCommand::Statistics,\n            0x0a =\u003e MySqlCommand::ProcessInfo,\n            0x0b =\u003e MySqlCommand::Connect,\n            0x0c =\u003e MySqlCommand::ProcessKill,\n            0x0d =\u003e MySqlCommand::Debug,\n            0x0e =\u003e MySqlCommand::Ping,\n            0x0f =\u003e MySqlCommand::Time,\n            0x10 =\u003e MySqlCommand::DelayedInsert,\n            0x11 =\u003e MySqlCommand::ChangeUser,\n            0x12 =\u003e MySqlCommand::BinlogDump,\n            0x13 =\u003e MySqlCommand::TableDump,\n            0x14 =\u003e MySqlCommand::ConnectOut,\n            0x15 =\u003e MySqlCommand::RegisterSlave,\n            0x16 =\u003e MySqlCommand::StmtPrepare,\n            0x17 =\u003e MySqlCommand::StmtExecute,\n            0x18 =\u003e MySqlCommand::StmtSendLongData,\n            0x19 =\u003e MySqlCommand::StmtClose,\n            0x1a =\u003e MySqlCommand::StmtReset,\n            0x1b =\u003e MySqlCommand::SetOption,\n            0x1c =\u003e MySqlCommand::StmtFetch,\n            0x1d =\u003e MySqlCommand::Daemon,\n            0x1e =\u003e MySqlCommand::BinlogDumpGtid,\n            0x1f =\u003e MySqlCommand::ResetConnection,\n            _ =\u003e MySqlCommand::Unknown(code),\n        }\n    }\n}\n\n/// MySQL packet structure\n#[derive(Debug, Clone)]\npub struct MySqlPacket {\n    pub sequence: u8,\n    pub payload: Vec\u003cu8\u003e,\n}\n\nimpl MySqlPacket {\n    /// Parse a MySQL packet from bytes\n    pub fn parse(data: \u0026[u8]) -\u003e Result\u003cSelf, SqlError\u003e {\n        if data.len() \u003c PACKET_HEADER_SIZE {\n            return Err(SqlError::ProtocolError(\"Packet too short\".to_string()));\n        }\n\n        let payload_length = u32::from_le_bytes([data[0], data[1], data[2], 0]) as usize;\n        let sequence = data[3];\n\n        if data.len() \u003c PACKET_HEADER_SIZE + payload_length {\n            return Err(SqlError::ProtocolError(\"Incomplete packet\".to_string()));\n        }\n\n        let payload = data[PACKET_HEADER_SIZE..PACKET_HEADER_SIZE + payload_length].to_vec();\n\n        Ok(Self { sequence, payload })\n    }\n\n    /// Serialize packet to bytes\n    pub fn serialize(\u0026self) -\u003e Vec\u003cu8\u003e {\n        let mut buf = BytesMut::new();\n        buf.put_u32_le(self.payload.len() as u32);\n        buf.put_u8(self.sequence);\n        buf.put_slice(\u0026self.payload);\n        buf.to_vec()\n    }\n}\n\n/// MySQL greeting packet (Initial Handshake)\n#[derive(Debug, Clone)]\npub struct HandshakeV10 {\n    pub protocol_version: u8,\n    pub server_version: String,\n    pub connection_id: u32,\n    pub auth_plugin_data: Vec\u003cu8\u003e,\n    pub capability_flags: u32,\n    pub character_set: u8,\n    pub status_flags: u16,\n}\n\nimpl HandshakeV10 {\n    /// Create server greeting\n    pub fn new(connection_id: u32) -\u003e Self {\n        Self {\n            protocol_version: 0x0a, // MySQL 10\n            server_version: \"1.0.0-SQLRustGo\".to_string(),\n            connection_id,\n            auth_plugin_data: vec![0; 8], // Placeholder\n            capability_flags: capability::PROTOCOL_41\n                | capability::LONG_PASSWORD\n                | capability::FOUND_ROWS\n                | capability::MULTI_STATEMENTS\n                | capability::MULTI_RESULTS,\n            character_set: 0x21, // utf8mb4_general_ci\n            status_flags: 0x0002, // AUTOCOMMIT\n        }\n    }\n\n    /// Serialize to bytes\n    pub fn to_bytes(\u0026self) -\u003e Vec\u003cu8\u003e {\n        let mut buf = BytesMut::new();\n        \n        // Protocol version\n        buf.put_u8(self.protocol_version);\n        \n        // Server version (null-terminated string)\n        buf.put_slice(self.server_version.as_bytes());\n        buf.put_u8(0);\n        \n        // Connection ID\n        buf.put_u32_le(self.connection_id);\n        \n        // Auth plugin data part 1 (8 bytes)\n        buf.put_slice(\u0026self.auth_plugin_data[..8.min(self.auth_plugin_data.len())]);\n        buf.put_u8(0); // Null terminator\n        \n        // Capability flags lower 2 bytes\n        buf.put_u16_le(self.capability_flags as u16);\n        \n        // Character set\n        buf.put_u8(self.character_set);\n        \n        // Status flags\n        buf.put_u16_le(self.status_flags);\n        \n        // Capability flags upper 2 bytes\n        buf.put_u16_le((self.capability_flags \u003e\u003e 16) as u16);\n        \n        // Auth plugin data length (if plugin auth)\n        let auth_len = if self.capability_flags \u0026 capability::PLUGIN_AUTH != 0 {\n            self.auth_plugin_data.len() as u8\n        } else {\n            0\n        };\n        buf.put_u8(auth_len);\n        \n        // Reserved (10 bytes)\n        buf.put_slice(\u0026[0u8; 10]);\n        \n        // Auth plugin data part 2 (if any)\n        if self.auth_plugin_data.len() \u003e 8 {\n            buf.put_slice(\u0026self.auth_plugin_data[8..]);\n        }\n        \n        // Auth plugin name (null-terminated)\n        buf.put_slice(b\"mysql_native_password\\0\");\n        \n        buf.to_vec()\n    }\n}\n\n/// OK packet response\n#[derive(Debug, Clone)]\npub struct OkPacket {\n    pub affected_rows: u64,\n    pub last_insert_id: u64,\n    pub status_flags: u16,\n    pub warnings: u16,\n    pub message: String,\n}\n\nimpl OkPacket {\n    pub fn new(affected_rows: u64, message: \u0026str) -\u003e Self {\n        Self {\n            affected_rows,\n            last_insert_id: 0,\n            status_flags: 0x0002, // AUTOCOMMIT\n            warnings: 0,\n            message: message.to_string(),\n        }\n    }\n\n    pub fn to_bytes(\u0026self) -\u003e Vec\u003cu8\u003e {\n        let mut buf = BytesMut::new();\n        buf.put_u8(0x00); // OK packet header\n        buf.put_u64_le(self.affected_rows);\n        buf.put_u64_le(self.last_insert_id);\n        buf.put_u16_le(self.status_flags);\n        buf.put_u16_le(self.warnings);\n        \n        if !self.message.is_empty() {\n            // Use length-encoded string\n            buf.put_u64_le(self.message.len() as u64);\n            buf.put_slice(self.message.as_bytes());\n        }\n        \n        buf.to_vec()\n    }\n}\n\n/// Error packet response\n#[derive(Debug, Clone)]\npub struct ErrPacket {\n    pub error_code: u16,\n    pub sql_state: String,\n    pub message: String,\n}\n\nimpl ErrPacket {\n    pub fn new(code: u16, message: \u0026str) -\u003e Self {\n        Self {\n            error_code: code,\n            sql_state: \"HY000\".to_string(), // General SQL state\n            message: message.to_string(),\n        }\n    }\n\n    pub fn to_bytes(\u0026self) -\u003e Vec\u003cu8\u003e {\n        let mut buf = BytesMut::new();\n        buf.put_u8(0xff); // Error packet header\n        buf.put_u16_le(self.error_code);\n        \n        // SQL state (5 bytes)\n        if self.sql_state.len() == 5 {\n            buf.put_slice(self.sql_state.as_bytes());\n        } else {\n            buf.put_slice(b\"HY000\");\n        }\n        \n        // Error message\n        buf.put_slice(self.message.as_bytes());\n        \n        buf.to_vec()\n    }\n}\n\n/// Result set row\n#[derive(Debug, Clone)]\npub struct RowData {\n    pub values: Vec\u003cValue\u003e,\n}\n\nimpl RowData {\n    pub fn to_bytes(\u0026self) -\u003e Vec\u003cu8\u003e {\n        let mut buf = BytesMut::new();\n        \n        for value in \u0026self.values {\n            match value {\n                Value::Null =\u003e {\n                    buf.put_u8(0xfb); // NULL indicator\n                }\n                Value::Integer(i) =\u003e {\n                    let s = i.to_string();\n                    buf.put_u64_le(s.len() as u64);\n                    buf.put_slice(s.as_bytes());\n                }\n                Value::Float(f) =\u003e {\n                    let s = f.to_string();\n                    buf.put_u64_le(s.len() as u64);\n                    buf.put_slice(s.as_bytes());\n                }\n                Value::Text(s) =\u003e {\n                    buf.put_u64_le(s.len() as u64);\n                    buf.put_slice(s.as_bytes());\n                }\n                Value::Blob(b) =\u003e {\n                    buf.put_u64_le(b.len() as u64);\n                    buf.put_slice(b);\n                }\n                Value::Boolean(b) =\u003e {\n                    let s = if *b { \"1\" } else { \"0\" };\n                    buf.put_u64_le(1);\n                    buf.put_slice(s.as_bytes());\n                }\n            }\n        }\n        \n        buf.to_vec()\n    }\n}\n\n/// MySQL-compatible protocol handler (synchronous version)\npub struct NetworkHandler {\n    stream: TcpStream,\n    connection_id: u32,\n}\n\nimpl NetworkHandler {\n    /// Create a new network handler\n    pub fn new(stream: TcpStream, connection_id: u32) -\u003e Self {\n        Self { stream, connection_id }\n    }\n\n    /// Handle a client connection\n    pub fn handle(\u0026mut self) -\u003e Result\u003c(), SqlError\u003e {\n        // Send greeting\n        self.send_greeting()?;\n\n        // Read and handle packets\n        loop {\n            match self.read_packet() {\n                Ok(Some((sequence, payload))) =\u003e {\n                    let command = MySqlCommand::from(payload[0]);\n                    \n                    match command {\n                        MySqlCommand::Quit =\u003e {\n                            break;\n                        }\n                        MySqlCommand::Query =\u003e {\n                            let query = String::from_utf8_lossy(\u0026payload[1..]).to_string();\n                            self.execute_query(\u0026query)?;\n                        }\n                        MySqlCommand::Ping =\u003e {\n                            self.send_ok(\"PONG\", 0)?;\n                        }\n                        _ =\u003e {\n                            self.send_error(1047, \"Command not supported\")?;\n                        }\n                    }\n                }\n                Ok(None) =\u003e break,\n                Err(e) =\u003e {\n                    // Log error but don't crash\n                    eprintln!(\"Protocol error: {}\", e);\n                    break;\n                }\n            }\n        }\n\n        Ok(())\n    }\n\n    /// Send MySQL handshake greeting\n    fn send_greeting(\u0026mut self) -\u003e Result\u003c(), SqlError\u003e {\n        let greeting = HandshakeV10::new(self.connection_id);\n        let packet = MySqlPacket {\n            sequence: 0,\n            payload: greeting.to_bytes(),\n        };\n        \n        self.stream\n            .write_all(\u0026packet.serialize())\n            .map_err(|e| SqlError::IoError(e.to_string()))?;\n        \n        Ok(())\n    }\n\n    /// Read a MySQL packet\n    fn read_packet(\u0026mut self) -\u003e Result\u003cOption\u003c(u8, Vec\u003cu8\u003e)\u003e, SqlError\u003e {\n        let mut header = [0u8; PACKET_HEADER_SIZE];\n        \n        match self.stream.read(\u0026mut header) {\n            Ok(0) =\u003e Ok(None), // Connection closed\n            Ok(n) if n \u003c PACKET_HEADER_SIZE =\u003e {\n                Err(SqlError::ProtocolError(\"Incomplete packet header\".to_string()))\n            }\n            Ok(_) =\u003e {\n                let payload_length = u32::from_le_bytes([header[0], header[1], header[2], 0]) as usize;\n                let sequence = header[3];\n                \n                let mut payload = vec![0u8; payload_length];\n                let mut remaining = payload_length;\n                let mut offset = 0;\n                \n                while remaining \u003e 0 {\n                    match self.stream.read(\u0026mut payload[offset..]) {\n                        Ok(0) =\u003e return Err(SqlError::ProtocolError(\"Connection closed\".to_string())),\n                        Ok(n) =\u003e {\n                            remaining -= n;\n                            offset += n;\n                        }\n                        Err(e) =\u003e return Err(SqlError::IoError(e.to_string())),\n                    }\n                }\n                \n                Ok(Some((sequence, payload)))\n            }\n            Err(e) =\u003e Err(SqlError::IoError(e.to_string())),\n        }\n    }\n\n    /// Execute a query and send result\n    fn execute_query(\u0026mut self, query: \u0026str) -\u003e Result\u003c(), SqlError\u003e {\n        // For now, return a simple OK response\n        // Full query execution would integrate with the executor\n        let trimmed = query.trim();\n        \n        if trimmed.eq_ignore_ascii_case(\"SELECT VERSION()\") {\n            let response = OkPacket::new(0, \"1.0.0-SQLRustGo\");\n            self.send_packet(response.to_bytes().as_slice())?;\n        } else if trimmed.eq_ignore_ascii_case(\"SELECT 1\") || \n                  trimmed.eq_ignore_ascii_case(\"SELECT 1 AS a\") {\n            // Return a simple result set\n            self.send_select_response()?;\n        } else {\n            self.send_ok(\"Query executed\", 0)?;\n        }\n        \n        Ok(())\n    }\n\n    /// Send OK packet\n    fn send_ok(\u0026mut self, message: \u0026str, affected_rows: u64) -\u003e Result\u003c(), SqlError\u003e {\n        let packet = OkPacket::new(affected_rows, message);\n        self.send_packet(\u0026packet.to_bytes())\n    }\n\n    /// Send error packet\n    fn send_error(\u0026mut self, code: u16, message: \u0026str) -\u003e Result\u003c(), SqlError\u003e {\n        let packet = ErrPacket::new(code, message);\n        self.send_packet(\u0026packet.to_bytes())\n    }\n\n    /// Send a raw packet\n    fn send_packet(\u0026mut self, data: \u0026[u8]) -\u003e Result\u003c(), SqlError\u003e {\n        // Simple packet: length (3 bytes) + sequence (1 byte) + payload\n        let mut buf = BytesMut::new();\n        buf.put_u32_le(data.len() as u32);\n        buf.put_u8(0); // sequence\n        buf.put_slice(data);\n        \n        self.stream\n            .write_all(\u0026buf.to_vec())\n            .map_err(|e| SqlError::IoError(e.to_string()))?;\n        \n        Ok(())\n    }\n\n    /// Send simple SELECT response\n    fn send_select_response(\u0026mut self) -\u003e Result\u003c(), SqlError\u003e {\n        // Column count (1)\n        let mut buf = BytesMut::new();\n        buf.put_u8(0x01); // 1 column\n        self.send_packet(\u0026buf.to_vec())?;\n        \n        // Column definition: name=\"1\", type=INT\n        let mut col_buf = BytesMut::new();\n        col_buf.put_slice(b\"def\\0\"); // catalog\n        col_buf.put_slice(b\"test\\0\"); // schema\n        col_buf.put_slice(b\"\\0\");   // table alias\n        col_buf.put_slice(b\"test\\0\"); // table\n        col_buf.put_slice(b\"\\0\");   // column alias\n        col_buf.put_slice(b\"1\\0\");  // column\n        col_buf.put_u8(0x0c);       // charset\n        col_buf.put_u32_le(11);     // column length\n        col_buf.put_u8(0x03);       // type (MYSQL_TYPE_LONG)\n        col_buf.put_u8(0x00);       // flags\n        col_buf.put_u8(0x00);       // decimals\n        col_buf.put_u16_le(0x0000); // default\n        \n        self.send_packet(\u0026col_buf.to_vec())?;\n        \n        // EOF packet\n        let mut eof_buf = BytesMut::new();\n        eof_buf.put_u8(0xfe);\n        eof_buf.put_u16_le(0x0000); // warnings\n        eof_buf.put_u16_le(0x0000); // status flags\n        self.send_packet(\u0026eof_buf.to_vec())?;\n        \n        // Row data\n        let mut row_buf = BytesMut::new();\n        row_buf.put_u64_le(1); // length\n        row_buf.put_slice(b\"1\"); // value\n        self.send_packet(\u0026row_buf.to_vec())?;\n        \n        // EOF packet (final)\n        self.send_packet(\u0026eof_buf.to_vec())?;\n        \n        Ok(())\n    }\n}\n\n/// Start the server (synchronous version)\npub fn start_server_sync(addr: \u0026str) -\u003e Result\u003c(), SqlError\u003e {\n    let listener = TcpListener::bind(addr)\n        .map_err(|e| SqlError::IoError(format!(\"Failed to bind: {}\", e)))?;\n    \n    println!(\"SQLRustGo Server listening on {}\", addr);\n    println!(\"MySQL protocol compatible\");\n\n    let mut connection_id: u32 = 1;\n\n    for stream in listener.incoming() {\n        match stream {\n            Ok(stream) =\u003e {\n                let conn_id = connection_id;\n                connection_id += 1;\n                \n                println!(\"New connection #{}\", conn_id);\n                \n                let mut handler = NetworkHandler::new(stream, conn_id);\n                if let Err(e) = handler.handle() {\n                    eprintln!(\"Client #{} error: {}\", conn_id, e);\n                }\n                \n                println!(\"Connection #{} closed\", conn_id);\n            }\n            Err(e) =\u003e {\n                eprintln!(\"Connection error: {}\", e);\n            }\n        }\n    }\n\n    Ok(())\n}\n\n/// Connect to server\npub fn connect(addr: \u0026str) -\u003e Result\u003cTcpStream, SqlError\u003e {\n    TcpStream::connect(addr).map_err(|e| SqlError::IoError(e.to_string()))\n}\n\n/// Simple client query execution\npub fn execute_query_on_server(addr: \u0026str, query: \u0026str) -\u003e Result\u003cString, SqlError\u003e {\n    let mut stream = connect(addr)?;\n    \n    // Read greeting (skip for now, just read until we get a response)\n    let mut buf = [0u8; 1024];\n    let _ = stream.read(\u0026mut buf).map_err(|e| SqlError::IoError(e.to_string()))?;\n    \n    // Send query as MySQL packet\n    let mut packet = BytesMut::new();\n    packet.put_u32_le((query.len() + 1) as u32);\n    packet.put_u8(0x03); // Query command\n    packet.put_slice(query.as_bytes());\n    \n    stream.write_all(\u0026packet.to_vec())\n        .map_err(|e| SqlError::IoError(e.to_string()))?;\n    \n    // Read response\n    let n = stream.read(\u0026mut buf).map_err(|e| SqlError::IoError(e.to_string()))?;\n    let response = String::from_utf8_lossy(\u0026buf[..n]).to_string();\n    \n    Ok(response)\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_handshake_creation() {\n        let handshake = HandshakeV10::new(1);\n        assert_eq!(handshake.protocol_version, 0x0a);\n    }\n\n    #[test]\n    fn test_handshake_bytes() {\n        let handshake = HandshakeV10::new(1);\n        let bytes = handshake.to_bytes();\n        assert!(!bytes.is_empty());\n    }\n\n    #[test]\n    fn test_ok_packet() {\n        let ok = OkPacket::new(1, \"OK\");\n        let bytes = ok.to_bytes();\n        assert_eq!(bytes[0], 0x00); // OK header\n    }\n\n    #[test]\n    fn test_error_packet() {\n        let err = ErrPacket::new(1064, \"Syntax error\");\n        let bytes = err.to_bytes();\n        assert_eq!(bytes[0], 0xff); // Error header\n    }\n\n    #[test]\n    fn test_mysql_command() {\n        assert!(matches!(MySqlCommand::from(0x01), MySqlCommand::Quit));\n        assert!(matches!(MySqlCommand::from(0x03), MySqlCommand::Query));\n        assert!(matches!(MySqlCommand::from(0x0e), MySqlCommand::Ping));\n    }\n\n    #[test]\n    fn test_packet_serialize() {\n        let packet = MySqlPacket {\n            sequence: 0,\n            payload: vec![0x01, 0x02, 0x03],\n        };\n        let bytes = packet.serialize();\n        assert_eq!(bytes.len(), 8); // 4 header (u32 + u8) + 3 payload\n    }\n\n    #[test]\n    fn test_connect_function() {\n        let _f: fn(\u0026str) -\u003e Result\u003cTcpStream, SqlError\u003e = connect;\n    }\n\n    #[test]\n    fn test_network_handler_creation() {\n        // Can't actually create without a real stream\n        assert!(true);\n    }\n}\n","traces":[{"line":79,"address":[],"length":0,"stats":{"Line":3}},{"line":80,"address":[],"length":0,"stats":{"Line":3}},{"line":81,"address":[],"length":0,"stats":{"Line":0}},{"line":82,"address":[],"length":0,"stats":{"Line":1}},{"line":83,"address":[],"length":0,"stats":{"Line":0}},{"line":84,"address":[],"length":0,"stats":{"Line":1}},{"line":85,"address":[],"length":0,"stats":{"Line":0}},{"line":86,"address":[],"length":0,"stats":{"Line":0}},{"line":87,"address":[],"length":0,"stats":{"Line":0}},{"line":88,"address":[],"length":0,"stats":{"Line":0}},{"line":89,"address":[],"length":0,"stats":{"Line":0}},{"line":90,"address":[],"length":0,"stats":{"Line":0}},{"line":91,"address":[],"length":0,"stats":{"Line":0}},{"line":92,"address":[],"length":0,"stats":{"Line":0}},{"line":93,"address":[],"length":0,"stats":{"Line":0}},{"line":94,"address":[],"length":0,"stats":{"Line":0}},{"line":95,"address":[],"length":0,"stats":{"Line":1}},{"line":96,"address":[],"length":0,"stats":{"Line":0}},{"line":97,"address":[],"length":0,"stats":{"Line":0}},{"line":98,"address":[],"length":0,"stats":{"Line":0}},{"line":99,"address":[],"length":0,"stats":{"Line":0}},{"line":100,"address":[],"length":0,"stats":{"Line":0}},{"line":101,"address":[],"length":0,"stats":{"Line":0}},{"line":102,"address":[],"length":0,"stats":{"Line":0}},{"line":103,"address":[],"length":0,"stats":{"Line":0}},{"line":104,"address":[],"length":0,"stats":{"Line":0}},{"line":105,"address":[],"length":0,"stats":{"Line":0}},{"line":106,"address":[],"length":0,"stats":{"Line":0}},{"line":107,"address":[],"length":0,"stats":{"Line":0}},{"line":108,"address":[],"length":0,"stats":{"Line":0}},{"line":109,"address":[],"length":0,"stats":{"Line":0}},{"line":110,"address":[],"length":0,"stats":{"Line":0}},{"line":111,"address":[],"length":0,"stats":{"Line":0}},{"line":112,"address":[],"length":0,"stats":{"Line":0}},{"line":113,"address":[],"length":0,"stats":{"Line":0}},{"line":127,"address":[],"length":0,"stats":{"Line":0}},{"line":128,"address":[],"length":0,"stats":{"Line":0}},{"line":129,"address":[],"length":0,"stats":{"Line":0}},{"line":132,"address":[],"length":0,"stats":{"Line":0}},{"line":133,"address":[],"length":0,"stats":{"Line":0}},{"line":135,"address":[],"length":0,"stats":{"Line":0}},{"line":136,"address":[],"length":0,"stats":{"Line":0}},{"line":139,"address":[],"length":0,"stats":{"Line":0}},{"line":141,"address":[],"length":0,"stats":{"Line":0}},{"line":145,"address":[],"length":0,"stats":{"Line":1}},{"line":146,"address":[],"length":0,"stats":{"Line":2}},{"line":147,"address":[],"length":0,"stats":{"Line":3}},{"line":148,"address":[],"length":0,"stats":{"Line":3}},{"line":149,"address":[],"length":0,"stats":{"Line":3}},{"line":150,"address":[],"length":0,"stats":{"Line":1}},{"line":168,"address":[],"length":0,"stats":{"Line":2}},{"line":171,"address":[],"length":0,"stats":{"Line":6}},{"line":173,"address":[],"length":0,"stats":{"Line":2}},{"line":174,"address":[],"length":0,"stats":{"Line":2}},{"line":185,"address":[],"length":0,"stats":{"Line":1}},{"line":186,"address":[],"length":0,"stats":{"Line":2}},{"line":189,"address":[],"length":0,"stats":{"Line":3}},{"line":192,"address":[],"length":0,"stats":{"Line":3}},{"line":193,"address":[],"length":0,"stats":{"Line":2}},{"line":196,"address":[],"length":0,"stats":{"Line":3}},{"line":199,"address":[],"length":0,"stats":{"Line":5}},{"line":200,"address":[],"length":0,"stats":{"Line":2}},{"line":203,"address":[],"length":0,"stats":{"Line":3}},{"line":206,"address":[],"length":0,"stats":{"Line":3}},{"line":209,"address":[],"length":0,"stats":{"Line":3}},{"line":212,"address":[],"length":0,"stats":{"Line":3}},{"line":215,"address":[],"length":0,"stats":{"Line":2}},{"line":216,"address":[],"length":0,"stats":{"Line":0}},{"line":218,"address":[],"length":0,"stats":{"Line":1}},{"line":220,"address":[],"length":0,"stats":{"Line":3}},{"line":223,"address":[],"length":0,"stats":{"Line":3}},{"line":226,"address":[],"length":0,"stats":{"Line":1}},{"line":227,"address":[],"length":0,"stats":{"Line":0}},{"line":231,"address":[],"length":0,"stats":{"Line":3}},{"line":233,"address":[],"length":0,"stats":{"Line":1}},{"line":248,"address":[],"length":0,"stats":{"Line":1}},{"line":254,"address":[],"length":0,"stats":{"Line":1}},{"line":258,"address":[],"length":0,"stats":{"Line":1}},{"line":259,"address":[],"length":0,"stats":{"Line":2}},{"line":260,"address":[],"length":0,"stats":{"Line":2}},{"line":261,"address":[],"length":0,"stats":{"Line":3}},{"line":262,"address":[],"length":0,"stats":{"Line":3}},{"line":263,"address":[],"length":0,"stats":{"Line":3}},{"line":264,"address":[],"length":0,"stats":{"Line":3}},{"line":266,"address":[],"length":0,"stats":{"Line":2}},{"line":268,"address":[],"length":0,"stats":{"Line":4}},{"line":269,"address":[],"length":0,"stats":{"Line":3}},{"line":272,"address":[],"length":0,"stats":{"Line":1}},{"line":285,"address":[],"length":0,"stats":{"Line":1}},{"line":288,"address":[],"length":0,"stats":{"Line":3}},{"line":289,"address":[],"length":0,"stats":{"Line":1}},{"line":293,"address":[],"length":0,"stats":{"Line":1}},{"line":294,"address":[],"length":0,"stats":{"Line":2}},{"line":295,"address":[],"length":0,"stats":{"Line":2}},{"line":296,"address":[],"length":0,"stats":{"Line":3}},{"line":299,"address":[],"length":0,"stats":{"Line":2}},{"line":300,"address":[],"length":0,"stats":{"Line":3}},{"line":302,"address":[],"length":0,"stats":{"Line":0}},{"line":306,"address":[],"length":0,"stats":{"Line":3}},{"line":308,"address":[],"length":0,"stats":{"Line":1}},{"line":319,"address":[],"length":0,"stats":{"Line":0}},{"line":320,"address":[],"length":0,"stats":{"Line":0}},{"line":322,"address":[],"length":0,"stats":{"Line":0}},{"line":323,"address":[],"length":0,"stats":{"Line":0}},{"line":324,"address":[],"length":0,"stats":{"Line":0}},{"line":325,"address":[],"length":0,"stats":{"Line":0}},{"line":327,"address":[],"length":0,"stats":{"Line":0}},{"line":328,"address":[],"length":0,"stats":{"Line":0}},{"line":329,"address":[],"length":0,"stats":{"Line":0}},{"line":330,"address":[],"length":0,"stats":{"Line":0}},{"line":332,"address":[],"length":0,"stats":{"Line":0}},{"line":333,"address":[],"length":0,"stats":{"Line":0}},{"line":334,"address":[],"length":0,"stats":{"Line":0}},{"line":335,"address":[],"length":0,"stats":{"Line":0}},{"line":337,"address":[],"length":0,"stats":{"Line":0}},{"line":338,"address":[],"length":0,"stats":{"Line":0}},{"line":339,"address":[],"length":0,"stats":{"Line":0}},{"line":341,"address":[],"length":0,"stats":{"Line":0}},{"line":342,"address":[],"length":0,"stats":{"Line":0}},{"line":343,"address":[],"length":0,"stats":{"Line":0}},{"line":345,"address":[],"length":0,"stats":{"Line":0}},{"line":346,"address":[],"length":0,"stats":{"Line":0}},{"line":347,"address":[],"length":0,"stats":{"Line":0}},{"line":348,"address":[],"length":0,"stats":{"Line":0}},{"line":353,"address":[],"length":0,"stats":{"Line":0}},{"line":365,"address":[],"length":0,"stats":{"Line":0}},{"line":370,"address":[],"length":0,"stats":{"Line":0}},{"line":372,"address":[],"length":0,"stats":{"Line":0}},{"line":376,"address":[],"length":0,"stats":{"Line":0}},{"line":377,"address":[],"length":0,"stats":{"Line":0}},{"line":378,"address":[],"length":0,"stats":{"Line":0}},{"line":380,"address":[],"length":0,"stats":{"Line":0}},{"line":382,"address":[],"length":0,"stats":{"Line":0}},{"line":385,"address":[],"length":0,"stats":{"Line":0}},{"line":386,"address":[],"length":0,"stats":{"Line":0}},{"line":389,"address":[],"length":0,"stats":{"Line":0}},{"line":392,"address":[],"length":0,"stats":{"Line":0}},{"line":396,"address":[],"length":0,"stats":{"Line":0}},{"line":397,"address":[],"length":0,"stats":{"Line":0}},{"line":399,"address":[],"length":0,"stats":{"Line":0}},{"line":400,"address":[],"length":0,"stats":{"Line":0}},{"line":405,"address":[],"length":0,"stats":{"Line":0}},{"line":409,"address":[],"length":0,"stats":{"Line":0}},{"line":410,"address":[],"length":0,"stats":{"Line":0}},{"line":413,"address":[],"length":0,"stats":{"Line":0}},{"line":416,"address":[],"length":0,"stats":{"Line":0}},{"line":417,"address":[],"length":0,"stats":{"Line":0}},{"line":418,"address":[],"length":0,"stats":{"Line":0}},{"line":420,"address":[],"length":0,"stats":{"Line":0}},{"line":424,"address":[],"length":0,"stats":{"Line":0}},{"line":425,"address":[],"length":0,"stats":{"Line":0}},{"line":427,"address":[],"length":0,"stats":{"Line":0}},{"line":428,"address":[],"length":0,"stats":{"Line":0}},{"line":429,"address":[],"length":0,"stats":{"Line":0}},{"line":430,"address":[],"length":0,"stats":{"Line":0}},{"line":433,"address":[],"length":0,"stats":{"Line":0}},{"line":434,"address":[],"length":0,"stats":{"Line":0}},{"line":436,"address":[],"length":0,"stats":{"Line":0}},{"line":437,"address":[],"length":0,"stats":{"Line":0}},{"line":438,"address":[],"length":0,"stats":{"Line":0}},{"line":440,"address":[],"length":0,"stats":{"Line":0}},{"line":441,"address":[],"length":0,"stats":{"Line":0}},{"line":442,"address":[],"length":0,"stats":{"Line":0}},{"line":443,"address":[],"length":0,"stats":{"Line":0}},{"line":444,"address":[],"length":0,"stats":{"Line":0}},{"line":445,"address":[],"length":0,"stats":{"Line":0}},{"line":447,"address":[],"length":0,"stats":{"Line":0}},{"line":451,"address":[],"length":0,"stats":{"Line":0}},{"line":453,"address":[],"length":0,"stats":{"Line":0}},{"line":458,"address":[],"length":0,"stats":{"Line":0}},{"line":461,"address":[],"length":0,"stats":{"Line":0}},{"line":463,"address":[],"length":0,"stats":{"Line":0}},{"line":464,"address":[],"length":0,"stats":{"Line":0}},{"line":465,"address":[],"length":0,"stats":{"Line":0}},{"line":466,"address":[],"length":0,"stats":{"Line":0}},{"line":467,"address":[],"length":0,"stats":{"Line":0}},{"line":469,"address":[],"length":0,"stats":{"Line":0}},{"line":471,"address":[],"length":0,"stats":{"Line":0}},{"line":474,"address":[],"length":0,"stats":{"Line":0}},{"line":478,"address":[],"length":0,"stats":{"Line":0}},{"line":479,"address":[],"length":0,"stats":{"Line":0}},{"line":480,"address":[],"length":0,"stats":{"Line":0}},{"line":484,"address":[],"length":0,"stats":{"Line":0}},{"line":485,"address":[],"length":0,"stats":{"Line":0}},{"line":486,"address":[],"length":0,"stats":{"Line":0}},{"line":490,"address":[],"length":0,"stats":{"Line":0}},{"line":492,"address":[],"length":0,"stats":{"Line":0}},{"line":493,"address":[],"length":0,"stats":{"Line":0}},{"line":494,"address":[],"length":0,"stats":{"Line":0}},{"line":495,"address":[],"length":0,"stats":{"Line":0}},{"line":497,"address":[],"length":0,"stats":{"Line":0}},{"line":498,"address":[],"length":0,"stats":{"Line":0}},{"line":499,"address":[],"length":0,"stats":{"Line":0}},{"line":501,"address":[],"length":0,"stats":{"Line":0}},{"line":505,"address":[],"length":0,"stats":{"Line":0}},{"line":507,"address":[],"length":0,"stats":{"Line":0}},{"line":508,"address":[],"length":0,"stats":{"Line":0}},{"line":509,"address":[],"length":0,"stats":{"Line":0}},{"line":512,"address":[],"length":0,"stats":{"Line":0}},{"line":513,"address":[],"length":0,"stats":{"Line":0}},{"line":514,"address":[],"length":0,"stats":{"Line":0}},{"line":515,"address":[],"length":0,"stats":{"Line":0}},{"line":516,"address":[],"length":0,"stats":{"Line":0}},{"line":517,"address":[],"length":0,"stats":{"Line":0}},{"line":518,"address":[],"length":0,"stats":{"Line":0}},{"line":519,"address":[],"length":0,"stats":{"Line":0}},{"line":520,"address":[],"length":0,"stats":{"Line":0}},{"line":521,"address":[],"length":0,"stats":{"Line":0}},{"line":522,"address":[],"length":0,"stats":{"Line":0}},{"line":523,"address":[],"length":0,"stats":{"Line":0}},{"line":524,"address":[],"length":0,"stats":{"Line":0}},{"line":526,"address":[],"length":0,"stats":{"Line":0}},{"line":529,"address":[],"length":0,"stats":{"Line":0}},{"line":530,"address":[],"length":0,"stats":{"Line":0}},{"line":531,"address":[],"length":0,"stats":{"Line":0}},{"line":532,"address":[],"length":0,"stats":{"Line":0}},{"line":533,"address":[],"length":0,"stats":{"Line":0}},{"line":536,"address":[],"length":0,"stats":{"Line":0}},{"line":537,"address":[],"length":0,"stats":{"Line":0}},{"line":538,"address":[],"length":0,"stats":{"Line":0}},{"line":539,"address":[],"length":0,"stats":{"Line":0}},{"line":542,"address":[],"length":0,"stats":{"Line":0}},{"line":544,"address":[],"length":0,"stats":{"Line":0}},{"line":549,"address":[],"length":0,"stats":{"Line":0}},{"line":550,"address":[],"length":0,"stats":{"Line":0}},{"line":551,"address":[],"length":0,"stats":{"Line":0}},{"line":553,"address":[],"length":0,"stats":{"Line":0}},{"line":554,"address":[],"length":0,"stats":{"Line":0}},{"line":556,"address":[],"length":0,"stats":{"Line":0}},{"line":558,"address":[],"length":0,"stats":{"Line":0}},{"line":559,"address":[],"length":0,"stats":{"Line":0}},{"line":560,"address":[],"length":0,"stats":{"Line":0}},{"line":561,"address":[],"length":0,"stats":{"Line":0}},{"line":562,"address":[],"length":0,"stats":{"Line":0}},{"line":564,"address":[],"length":0,"stats":{"Line":0}},{"line":566,"address":[],"length":0,"stats":{"Line":0}},{"line":567,"address":[],"length":0,"stats":{"Line":0}},{"line":568,"address":[],"length":0,"stats":{"Line":0}},{"line":571,"address":[],"length":0,"stats":{"Line":0}},{"line":573,"address":[],"length":0,"stats":{"Line":0}},{"line":574,"address":[],"length":0,"stats":{"Line":0}},{"line":579,"address":[],"length":0,"stats":{"Line":0}},{"line":583,"address":[],"length":0,"stats":{"Line":0}},{"line":584,"address":[],"length":0,"stats":{"Line":0}},{"line":588,"address":[],"length":0,"stats":{"Line":0}},{"line":589,"address":[],"length":0,"stats":{"Line":0}},{"line":592,"address":[],"length":0,"stats":{"Line":0}},{"line":593,"address":[],"length":0,"stats":{"Line":0}},{"line":596,"address":[],"length":0,"stats":{"Line":0}},{"line":597,"address":[],"length":0,"stats":{"Line":0}},{"line":598,"address":[],"length":0,"stats":{"Line":0}},{"line":599,"address":[],"length":0,"stats":{"Line":0}},{"line":601,"address":[],"length":0,"stats":{"Line":0}},{"line":602,"address":[],"length":0,"stats":{"Line":0}},{"line":605,"address":[],"length":0,"stats":{"Line":0}},{"line":606,"address":[],"length":0,"stats":{"Line":0}},{"line":608,"address":[],"length":0,"stats":{"Line":0}}],"covered":58,"coverable":257},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","parser","mod.rs"],"content":"//! SQL Parser Module\n//!\n//! # What (是什么)\n//! Parser 将 Lexer 输出的 Token 序列转换为抽象语法树 (AST)\n//!\n//! # Why (为什么)\n//! Token 序列只是单词的列表，无法表达 SQL 语句的层级结构\n//! AST 将单词组织成有意义的树结构，表示查询的语义\n//!\n//! # How (如何实现)\n//! - 递归下降解析器：自顶向下处理 SQL 语句\n//! - 每个 Statement 类型有对应的 parse_xxx 方法\n//! - 支持：SELECT, INSERT, UPDATE, DELETE, CREATE TABLE, DROP TABLE\n//! - 表达式解析支持基本二元运算\n\nuse crate::lexer::{Lexer, Token};\nuse serde::{Deserialize, Serialize};\n\n/// SQL Statement types\n#[derive(Debug, Clone, PartialEq)]\npub enum Statement {\n    Select(SelectStatement),\n    Insert(InsertStatement),\n    Update(UpdateStatement),\n    Delete(DeleteStatement),\n    CreateTable(CreateTableStatement),\n    DropTable(DropTableStatement),\n}\n\n/// SELECT statement\n#[derive(Debug, Clone, PartialEq)]\npub struct SelectStatement {\n    pub columns: Vec\u003cSelectColumn\u003e,\n    pub table: String,\n    pub where_clause: Option\u003cExpression\u003e,\n}\n\n/// Column in SELECT\n#[derive(Debug, Clone, PartialEq)]\npub struct SelectColumn {\n    pub name: String,\n    pub alias: Option\u003cString\u003e,\n}\n\n/// INSERT statement\n#[derive(Debug, Clone, PartialEq)]\npub struct InsertStatement {\n    pub table: String,\n    pub columns: Vec\u003cString\u003e,\n    pub values: Vec\u003cVec\u003cExpression\u003e\u003e, // Multiple rows\n}\n\n/// UPDATE statement  \n#[derive(Debug, Clone, PartialEq)]\npub struct UpdateStatement {\n    pub table: String,\n    pub set_clauses: Vec\u003c(String, Expression)\u003e,\n    pub where_clause: Option\u003cExpression\u003e,\n}\n\n/// DELETE statement\n#[derive(Debug, Clone, PartialEq)]\npub struct DeleteStatement {\n    pub table: String,\n    pub where_clause: Option\u003cExpression\u003e,\n}\n\n/// CREATE TABLE statement\n#[derive(Debug, Clone, PartialEq)]\npub struct CreateTableStatement {\n    pub name: String,\n    pub columns: Vec\u003cColumnDefinition\u003e,\n}\n\n/// DROP TABLE statement\n#[derive(Debug, Clone, PartialEq)]\npub struct DropTableStatement {\n    pub name: String,\n}\n\n/// Column definition\n#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]\npub struct ColumnDefinition {\n    pub name: String,\n    pub data_type: String,\n    pub nullable: bool,\n}\n\n/// Expression\n#[derive(Debug, Clone, PartialEq)]\npub enum Expression {\n    Literal(String),\n    Identifier(String),\n    BinaryOp(Box\u003cExpression\u003e, String, Box\u003cExpression\u003e),\n}\n\n/// SQL Parser\npub struct Parser {\n    tokens: Vec\u003cToken\u003e,\n    position: usize,\n}\n\nimpl Parser {\n    /// Create a parser from tokens\n    pub fn new(tokens: Vec\u003cToken\u003e) -\u003e Self {\n        Self {\n            tokens,\n            position: 0,\n        }\n    }\n\n    /// Get current token\n    fn current(\u0026self) -\u003e Option\u003c\u0026Token\u003e {\n        self.tokens.get(self.position)\n    }\n\n    /// Check if at end\n    #[allow(dead_code)]\n    fn is_eof(\u0026self) -\u003e bool {\n        self.position \u003e= self.tokens.len() || matches!(self.current(), Some(Token::Eof))\n    }\n\n    /// Advance to next token\n    fn next(\u0026mut self) -\u003e Option\u003cToken\u003e {\n        self.position += 1;\n        self.tokens.get(self.position - 1).cloned()\n    }\n\n    /// Expect a specific token\n    fn expect(\u0026mut self, expected: Token) -\u003e Result\u003cToken, String\u003e {\n        match self.current() {\n            Some(t) if t == \u0026expected =\u003e Ok(self.next().unwrap()),\n            Some(t) =\u003e Err(format!(\"Expected {:?}, got {:?}\", expected, t)),\n            None =\u003e Err(\"Unexpected end of input\".to_string()),\n        }\n    }\n\n    /// Parse a complete SQL statement\n    pub fn parse_statement(\u0026mut self) -\u003e Result\u003cStatement, String\u003e {\n        match self.current() {\n            Some(Token::Select) =\u003e self.parse_select(),\n            Some(Token::Insert) =\u003e self.parse_insert(),\n            Some(Token::Update) =\u003e self.parse_update(),\n            Some(Token::Delete) =\u003e self.parse_delete(),\n            Some(Token::Create) =\u003e self.parse_create_table(),\n            Some(Token::Drop) =\u003e self.parse_drop_table(),\n            Some(t) =\u003e Err(format!(\"Unexpected token: {:?}\", t)),\n            None =\u003e Err(\"Empty input\".to_string()),\n        }\n    }\n\n    fn parse_select(\u0026mut self) -\u003e Result\u003cStatement, String\u003e {\n        self.expect(Token::Select)?;\n\n        let mut columns = Vec::new();\n        loop {\n            match self.current() {\n                Some(Token::From) =\u003e break,\n                Some(Token::Star) =\u003e {\n                    columns.push(SelectColumn {\n                        name: \"*\".to_string(),\n                        alias: None,\n                    });\n                    self.next();\n                }\n                Some(Token::Identifier(_)) =\u003e {\n                    if let Some(Token::Identifier(name)) = self.next() {\n                        columns.push(SelectColumn { name, alias: None });\n                    }\n                }\n                Some(Token::Comma) =\u003e {\n                    self.next();\n                }\n                _ =\u003e {\n                    return Err(\"Expected FROM or column name\".to_string());\n                }\n            }\n        }\n\n        self.expect(Token::From)?;\n\n        let table = match self.next() {\n            Some(Token::Identifier(name)) =\u003e name,\n            Some(t) =\u003e return Err(format!(\"Expected table name, got {:?}\", t)),\n            None =\u003e return Err(\"Expected table name\".to_string()),\n        };\n\n        // Parse WHERE clause (optional)\n        let where_clause = if matches!(self.current(), Some(Token::Where)) {\n            self.next(); // consume WHERE\n            Some(self.parse_expression()?)\n        } else {\n            None\n        };\n\n        Ok(Statement::Select(SelectStatement {\n            columns,\n            table,\n            where_clause,\n        }))\n    }\n\n    fn parse_insert(\u0026mut self) -\u003e Result\u003cStatement, String\u003e {\n        self.expect(Token::Insert)?;\n        self.expect(Token::Into)?;\n\n        let table = match self.next() {\n            Some(Token::Identifier(name)) =\u003e name,\n            _ =\u003e return Err(\"Expected table name\".to_string()),\n        };\n\n        // Check for column list: (col1, col2, ...)\n        let columns = if matches!(self.current(), Some(Token::LParen)) {\n            self.next(); // consume '('\n            let mut cols = Vec::new();\n            loop {\n                match self.current() {\n                    Some(Token::Identifier(name)) =\u003e {\n                        cols.push(name.clone());\n                        self.next();\n                    }\n                    Some(Token::RParen) =\u003e {\n                        self.next();\n                        break;\n                    }\n                    Some(Token::Comma) =\u003e {\n                        self.next();\n                    }\n                    _ =\u003e return Err(\"Expected column name\".to_string()),\n                }\n            }\n            cols\n        } else {\n            Vec::new()\n        };\n\n        // Expect VALUES keyword\n        if !matches!(self.current(), Some(Token::Values)) {\n            return Err(\"Expected VALUES\".to_string());\n        }\n        self.next(); // consume VALUES\n\n        // Parse multiple rows: (val1, val2, ...), (val1, val2, ...), ...\n        let mut values = Vec::new();\n\n        // Parse first row\n        if !matches!(self.current(), Some(Token::LParen)) {\n            return Err(\"Expected ( after VALUES\".to_string());\n        }\n\n        // Parse all rows\n        loop {\n            if !matches!(self.current(), Some(Token::LParen)) {\n                break;\n            }\n\n            // Parse one row\n            self.next(); // consume '('\n            let mut row = Vec::new();\n            loop {\n                match self.current() {\n                    Some(Token::RParen) =\u003e {\n                        self.next();\n                        break;\n                    }\n                    Some(Token::Identifier(name)) =\u003e {\n                        row.push(Expression::Identifier(name.clone()));\n                        self.next();\n                    }\n                    Some(Token::NumberLiteral(n)) =\u003e {\n                        row.push(Expression::Literal(n.clone()));\n                        self.next();\n                    }\n                    Some(Token::StringLiteral(s)) =\u003e {\n                        row.push(Expression::Literal(format!(\"'{}'\", s)));\n                        self.next();\n                    }\n                    Some(Token::Comma) =\u003e {\n                        self.next();\n                    }\n                    Some(Token::Null) =\u003e {\n                        row.push(Expression::Literal(\"NULL\".to_string()));\n                        self.next();\n                    }\n                    Some(Token::Minus) =\u003e {\n                        // Negative number\n                        self.next();\n                        if let Some(Token::NumberLiteral(n)) = self.current() {\n                            row.push(Expression::Literal(format!(\"-{}\", n)));\n                            self.next();\n                        } else {\n                            return Err(\"Expected number after -\".to_string());\n                        }\n                    }\n                    _ =\u003e return Err(\"Expected value\".to_string()),\n                }\n            }\n            values.push(row);\n\n            // Check for more rows: either comma or end\n            match self.current() {\n                Some(Token::Comma) =\u003e {\n                    self.next(); // consume comma, continue to next row\n                }\n                _ =\u003e break,\n            }\n        }\n\n        if values.is_empty() {\n            return Err(\"Expected at least one row of values\".to_string());\n        }\n\n        Ok(Statement::Insert(InsertStatement {\n            table,\n            columns,\n            values,\n        }))\n    }\n\n    fn parse_update(\u0026mut self) -\u003e Result\u003cStatement, String\u003e {\n        self.expect(Token::Update)?;\n        let table = match self.next() {\n            Some(Token::Identifier(name)) =\u003e name,\n            _ =\u003e return Err(\"Expected table name\".to_string()),\n        };\n\n        // Expect SET keyword\n        if !matches!(self.current(), Some(Token::Set)) {\n            return Err(\"Expected SET\".to_string());\n        }\n        self.next(); // consume SET\n\n        // Parse SET clause: column = value [, column = value ...]\n        let mut set_clauses = Vec::new();\n        loop {\n            let column = match self.current() {\n                Some(Token::Identifier(name)) =\u003e name.clone(),\n                _ =\u003e return Err(\"Expected column name in SET\".to_string()),\n            };\n            self.next();\n\n            // Expect =\n            match self.current() {\n                Some(Token::Equal) =\u003e {}\n                _ =\u003e return Err(\"Expected = in SET clause\".to_string()),\n            }\n            self.next(); // consume =\n\n            // Parse value\n            let value = match self.current() {\n                Some(Token::Identifier(name)) =\u003e Expression::Identifier(name.clone()),\n                Some(Token::NumberLiteral(n)) =\u003e Expression::Literal(n.clone()),\n                Some(Token::StringLiteral(s)) =\u003e Expression::Literal(format!(\"'{}'\", s)),\n                Some(Token::Null) =\u003e Expression::Literal(\"NULL\".to_string()),\n                Some(Token::Minus) =\u003e {\n                    self.next();\n                    if let Some(Token::NumberLiteral(n)) = self.current() {\n                        Expression::Literal(format!(\"-{}\", n))\n                    } else {\n                        return Err(\"Expected number after -\".to_string());\n                    }\n                }\n                _ =\u003e return Err(\"Expected value in SET clause\".to_string()),\n            };\n            self.next();\n\n            set_clauses.push((column, value));\n\n            // Check for more SET clauses or WHERE\n            match self.current() {\n                Some(Token::Comma) =\u003e {\n                    self.next(); // consume comma, continue to parse next column\n                }\n                Some(Token::Where) | None | Some(Token::Eof) =\u003e break,\n                _ =\u003e return Err(\"Expected , or WHERE\".to_string()),\n            }\n        }\n\n        // Parse WHERE clause (optional)\n        let where_clause = if matches!(self.current(), Some(Token::Where)) {\n            self.next(); // consume WHERE\n            Some(self.parse_expression()?)\n        } else {\n            None\n        };\n\n        Ok(Statement::Update(UpdateStatement {\n            table,\n            set_clauses,\n            where_clause,\n        }))\n    }\n\n    /// Parse a simple expression (for WHERE clause)\n    fn parse_expression(\u0026mut self) -\u003e Result\u003cExpression, String\u003e {\n        let left = match self.current() {\n            Some(Token::Identifier(name)) =\u003e Expression::Identifier(name.clone()),\n            Some(Token::NumberLiteral(n)) =\u003e Expression::Literal(n.clone()),\n            Some(Token::StringLiteral(s)) =\u003e Expression::Literal(format!(\"'{}'\", s)),\n            Some(Token::Null) =\u003e Expression::Literal(\"NULL\".to_string()),\n            Some(Token::Minus) =\u003e {\n                self.next();\n                if let Some(Token::NumberLiteral(n)) = self.current() {\n                    Expression::Literal(format!(\"-{}\", n))\n                } else {\n                    return Err(\"Expected number after -\".to_string());\n                }\n            }\n            _ =\u003e return Err(\"Expected expression\".to_string()),\n        };\n        self.next();\n\n        // Check for binary operator\n        let op = match self.current() {\n            Some(Token::Equal) =\u003e \"=\",\n            Some(Token::NotEqual) =\u003e \"!=\",\n            Some(Token::Greater) =\u003e \"\u003e\",\n            Some(Token::Less) =\u003e \"\u003c\",\n            Some(Token::GreaterEqual) =\u003e \"\u003e=\",\n            Some(Token::LessEqual) =\u003e \"\u003c=\",\n            _ =\u003e return Ok(left), // No operator, return simple expression\n        };\n        self.next(); // consume operator\n\n        let right = match self.current() {\n            Some(Token::Identifier(name)) =\u003e Expression::Identifier(name.clone()),\n            Some(Token::NumberLiteral(n)) =\u003e Expression::Literal(n.clone()),\n            Some(Token::StringLiteral(s)) =\u003e Expression::Literal(format!(\"'{}'\", s)),\n            Some(Token::Null) =\u003e Expression::Literal(\"NULL\".to_string()),\n            Some(Token::Minus) =\u003e {\n                self.next();\n                if let Some(Token::NumberLiteral(n)) = self.current() {\n                    Expression::Literal(format!(\"-{}\", n))\n                } else {\n                    return Err(\"Expected number after -\".to_string());\n                }\n            }\n            _ =\u003e return Err(\"Expected value in expression\".to_string()),\n        };\n        self.next();\n\n        Ok(Expression::BinaryOp(\n            Box::new(left),\n            op.to_string(),\n            Box::new(right),\n        ))\n    }\n\n    fn parse_delete(\u0026mut self) -\u003e Result\u003cStatement, String\u003e {\n        self.expect(Token::Delete)?;\n        self.expect(Token::From)?;\n        let table = match self.next() {\n            Some(Token::Identifier(name)) =\u003e name,\n            _ =\u003e return Err(\"Expected table name\".to_string()),\n        };\n\n        // Parse WHERE clause (optional)\n        let where_clause = if matches!(self.current(), Some(Token::Where)) {\n            self.next(); // consume WHERE\n            Some(self.parse_expression()?)\n        } else {\n            None\n        };\n\n        Ok(Statement::Delete(DeleteStatement {\n            table,\n            where_clause,\n        }))\n    }\n\n    fn parse_create_table(\u0026mut self) -\u003e Result\u003cStatement, String\u003e {\n        self.expect(Token::Create)?;\n        self.expect(Token::Table)?;\n        let name = match self.next() {\n            Some(Token::Identifier(name)) =\u003e name,\n            _ =\u003e return Err(\"Expected table name\".to_string()),\n        };\n\n        // Parse optional column definitions: (col1 type, col2 type, ...)\n        let mut columns = Vec::new();\n        if matches!(self.current(), Some(Token::LParen)) {\n            self.next(); // consume '('\n            loop {\n                match self.current() {\n                    Some(Token::Identifier(name)) =\u003e {\n                        let col_name = name.clone();\n                        self.next();\n                        // Parse data type\n                        let data_type = match self.current() {\n                            Some(Token::Identifier(type_name)) =\u003e {\n                                let t = type_name.to_uppercase();\n                                self.next();\n                                t\n                            }\n                            Some(Token::Integer) =\u003e {\n                                self.next();\n                                \"INTEGER\".to_string()\n                            }\n                            Some(Token::Text) =\u003e {\n                                self.next();\n                                \"TEXT\".to_string()\n                            }\n                            _ =\u003e \"INTEGER\".to_string(), // default\n                        };\n                        columns.push(ColumnDefinition {\n                            name: col_name,\n                            data_type,\n                            nullable: true,\n                        });\n                    }\n                    Some(Token::RParen) =\u003e {\n                        self.next();\n                        break;\n                    }\n                    Some(Token::Comma) =\u003e {\n                        self.next();\n                    }\n                    _ =\u003e break,\n                }\n            }\n        }\n\n        Ok(Statement::CreateTable(CreateTableStatement {\n            name,\n            columns,\n        }))\n    }\n\n    fn parse_drop_table(\u0026mut self) -\u003e Result\u003cStatement, String\u003e {\n        self.expect(Token::Drop)?;\n        self.expect(Token::Table)?;\n        let name = match self.next() {\n            Some(Token::Identifier(name)) =\u003e name,\n            _ =\u003e return Err(\"Expected table name\".to_string()),\n        };\n\n        Ok(Statement::DropTable(DropTableStatement { name }))\n    }\n}\n\n/// Parse a SQL string into statements\npub fn parse(sql: \u0026str) -\u003e Result\u003cStatement, String\u003e {\n    let tokens = Lexer::new(sql).tokenize();\n    let mut parser = Parser::new(tokens);\n    parser.parse_statement()\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_parse_select() {\n        let result = parse(\"SELECT id FROM users\");\n        assert!(result.is_ok());\n        match result.unwrap() {\n            Statement::Select(s) =\u003e {\n                assert_eq!(s.table, \"users\");\n                assert_eq!(s.columns.len(), 1);\n            }\n            _ =\u003e panic!(\"Expected SELECT statement\"),\n        }\n    }\n\n    #[test]\n    fn test_parse_insert() {\n        let result = parse(\"INSERT INTO users VALUES (1)\");\n        assert!(result.is_ok());\n        match result.unwrap() {\n            Statement::Insert(i) =\u003e {\n                assert_eq!(i.table, \"users\");\n                assert_eq!(i.values.len(), 1); // 1 row\n                assert_eq!(i.values[0].len(), 1); // 1 value per row\n            }\n            _ =\u003e panic!(\"Expected INSERT statement\"),\n        }\n    }\n\n    #[test]\n    fn test_parse_insert_with_values() {\n        let result = parse(\"INSERT INTO users VALUES (1, 'Alice')\");\n        assert!(result.is_ok());\n        match result.unwrap() {\n            Statement::Insert(i) =\u003e {\n                assert_eq!(i.table, \"users\");\n                assert_eq!(i.values.len(), 1); // 1 row\n                assert_eq!(i.values[0].len(), 2); // 2 values per row\n            }\n            _ =\u003e panic!(\"Expected INSERT statement\"),\n        }\n    }\n\n    #[test]\n    fn test_parse_insert_with_columns() {\n        let result = parse(\"INSERT INTO users (id, name) VALUES (1, 'Alice')\");\n        assert!(result.is_ok());\n        match result.unwrap() {\n            Statement::Insert(i) =\u003e {\n                assert_eq!(i.table, \"users\");\n                assert_eq!(i.columns, vec![\"id\", \"name\"]);\n                assert_eq!(i.values.len(), 1); // 1 row\n                assert_eq!(i.values[0].len(), 2); // 2 values\n            }\n            _ =\u003e panic!(\"Expected INSERT statement\"),\n        }\n    }\n\n    #[test]\n    fn test_parse_insert_multi_row() {\n        let result = parse(\"INSERT INTO users VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie')\");\n        assert!(result.is_ok());\n        match result.unwrap() {\n            Statement::Insert(i) =\u003e {\n                assert_eq!(i.table, \"users\");\n                assert_eq!(i.values.len(), 3); // 3 rows\n                assert_eq!(i.values[0].len(), 2); // 2 values per row\n                assert_eq!(i.values[1].len(), 2);\n                assert_eq!(i.values[2].len(), 2);\n            }\n            _ =\u003e panic!(\"Expected INSERT statement\"),\n        }\n    }\n\n    #[test]\n    fn test_parse_update() {\n        let result = parse(\"UPDATE users SET name = 'Bob'\");\n        assert!(result.is_ok());\n        match result.unwrap() {\n            Statement::Update(u) =\u003e {\n                assert_eq!(u.table, \"users\");\n                assert_eq!(u.set_clauses.len(), 1);\n                assert_eq!(u.set_clauses[0].0, \"name\");\n            }\n            _ =\u003e panic!(\"Expected UPDATE statement\"),\n        }\n    }\n\n    #[test]\n    fn test_parse_update_with_where() {\n        let result = parse(\"UPDATE users SET name = 'Bob' WHERE id = 1\");\n        assert!(result.is_ok());\n        match result.unwrap() {\n            Statement::Update(u) =\u003e {\n                assert_eq!(u.table, \"users\");\n                assert_eq!(u.set_clauses.len(), 1);\n                assert!(u.where_clause.is_some());\n            }\n            _ =\u003e panic!(\"Expected UPDATE statement\"),\n        }\n    }\n\n    #[test]\n    fn test_parse_delete() {\n        let result = parse(\"DELETE FROM users\");\n        assert!(result.is_ok());\n        match result.unwrap() {\n            Statement::Delete(d) =\u003e {\n                assert_eq!(d.table, \"users\");\n            }\n            _ =\u003e panic!(\"Expected DELETE statement\"),\n        }\n    }\n\n    #[test]\n    fn test_parse_delete_with_where() {\n        let result = parse(\"DELETE FROM users WHERE id = 1\");\n        assert!(result.is_ok());\n        match result.unwrap() {\n            Statement::Delete(d) =\u003e {\n                assert_eq!(d.table, \"users\");\n                assert!(d.where_clause.is_some());\n            }\n            _ =\u003e panic!(\"Expected DELETE statement\"),\n        }\n    }\n\n    #[test]\n    fn test_parse_create() {\n        let result = parse(\"CREATE TABLE users\");\n        assert!(result.is_ok());\n        match result.unwrap() {\n            Statement::CreateTable(c) =\u003e {\n                assert_eq!(c.name, \"users\");\n            }\n            _ =\u003e panic!(\"Expected CREATE TABLE statement\"),\n        }\n    }\n\n    #[test]\n    fn test_parse_create_with_columns() {\n        let result = parse(\"CREATE TABLE users (id INTEGER, name TEXT)\");\n        assert!(result.is_ok());\n        match result.unwrap() {\n            Statement::CreateTable(c) =\u003e {\n                assert_eq!(c.name, \"users\");\n                assert_eq!(c.columns.len(), 2);\n                assert_eq!(c.columns[0].name, \"id\");\n                assert_eq!(c.columns[1].name, \"name\");\n            }\n            _ =\u003e panic!(\"Expected CREATE TABLE statement\"),\n        }\n    }\n\n    #[test]\n    fn test_parse_drop() {\n        let result = parse(\"DROP TABLE users\");\n        assert!(result.is_ok());\n        match result.unwrap() {\n            Statement::DropTable(d) =\u003e {\n                assert_eq!(d.name, \"users\");\n            }\n            _ =\u003e panic!(\"Expected DROP TABLE statement\"),\n        }\n    }\n}\n","traces":[{"line":105,"address":[],"length":0,"stats":{"Line":92}},{"line":113,"address":[],"length":0,"stats":{"Line":766}},{"line":114,"address":[],"length":0,"stats":{"Line":1532}},{"line":119,"address":[],"length":0,"stats":{"Line":0}},{"line":120,"address":[],"length":0,"stats":{"Line":0}},{"line":124,"address":[],"length":0,"stats":{"Line":650}},{"line":125,"address":[],"length":0,"stats":{"Line":650}},{"line":126,"address":[],"length":0,"stats":{"Line":1950}},{"line":130,"address":[],"length":0,"stats":{"Line":171}},{"line":131,"address":[],"length":0,"stats":{"Line":342}},{"line":132,"address":[],"length":0,"stats":{"Line":855}},{"line":133,"address":[],"length":0,"stats":{"Line":0}},{"line":134,"address":[],"length":0,"stats":{"Line":0}},{"line":139,"address":[],"length":0,"stats":{"Line":92}},{"line":140,"address":[],"length":0,"stats":{"Line":184}},{"line":141,"address":[],"length":0,"stats":{"Line":32}},{"line":142,"address":[],"length":0,"stats":{"Line":46}},{"line":143,"address":[],"length":0,"stats":{"Line":14}},{"line":144,"address":[],"length":0,"stats":{"Line":14}},{"line":145,"address":[],"length":0,"stats":{"Line":64}},{"line":146,"address":[],"length":0,"stats":{"Line":10}},{"line":147,"address":[],"length":0,"stats":{"Line":4}},{"line":148,"address":[],"length":0,"stats":{"Line":0}},{"line":152,"address":[],"length":0,"stats":{"Line":16}},{"line":153,"address":[],"length":0,"stats":{"Line":48}},{"line":155,"address":[],"length":0,"stats":{"Line":32}},{"line":157,"address":[],"length":0,"stats":{"Line":68}},{"line":158,"address":[],"length":0,"stats":{"Line":14}},{"line":159,"address":[],"length":0,"stats":{"Line":7}},{"line":160,"address":[],"length":0,"stats":{"Line":28}},{"line":161,"address":[],"length":0,"stats":{"Line":21}},{"line":162,"address":[],"length":0,"stats":{"Line":14}},{"line":164,"address":[],"length":0,"stats":{"Line":7}},{"line":167,"address":[],"length":0,"stats":{"Line":36}},{"line":168,"address":[],"length":0,"stats":{"Line":27}},{"line":171,"address":[],"length":0,"stats":{"Line":2}},{"line":172,"address":[],"length":0,"stats":{"Line":2}},{"line":175,"address":[],"length":0,"stats":{"Line":2}},{"line":180,"address":[],"length":0,"stats":{"Line":42}},{"line":182,"address":[],"length":0,"stats":{"Line":42}},{"line":183,"address":[],"length":0,"stats":{"Line":28}},{"line":184,"address":[],"length":0,"stats":{"Line":0}},{"line":185,"address":[],"length":0,"stats":{"Line":0}},{"line":189,"address":[],"length":0,"stats":{"Line":53}},{"line":190,"address":[],"length":0,"stats":{"Line":6}},{"line":191,"address":[],"length":0,"stats":{"Line":6}},{"line":193,"address":[],"length":0,"stats":{"Line":11}},{"line":196,"address":[],"length":0,"stats":{"Line":14}},{"line":197,"address":[],"length":0,"stats":{"Line":28}},{"line":198,"address":[],"length":0,"stats":{"Line":14}},{"line":199,"address":[],"length":0,"stats":{"Line":14}},{"line":203,"address":[],"length":0,"stats":{"Line":23}},{"line":204,"address":[],"length":0,"stats":{"Line":69}},{"line":205,"address":[],"length":0,"stats":{"Line":69}},{"line":207,"address":[],"length":0,"stats":{"Line":69}},{"line":208,"address":[],"length":0,"stats":{"Line":46}},{"line":209,"address":[],"length":0,"stats":{"Line":0}},{"line":213,"address":[],"length":0,"stats":{"Line":91}},{"line":214,"address":[],"length":0,"stats":{"Line":2}},{"line":215,"address":[],"length":0,"stats":{"Line":2}},{"line":217,"address":[],"length":0,"stats":{"Line":8}},{"line":218,"address":[],"length":0,"stats":{"Line":4}},{"line":219,"address":[],"length":0,"stats":{"Line":10}},{"line":220,"address":[],"length":0,"stats":{"Line":2}},{"line":223,"address":[],"length":0,"stats":{"Line":2}},{"line":224,"address":[],"length":0,"stats":{"Line":1}},{"line":226,"address":[],"length":0,"stats":{"Line":1}},{"line":227,"address":[],"length":0,"stats":{"Line":1}},{"line":229,"address":[],"length":0,"stats":{"Line":0}},{"line":232,"address":[],"length":0,"stats":{"Line":1}},{"line":234,"address":[],"length":0,"stats":{"Line":22}},{"line":238,"address":[],"length":0,"stats":{"Line":46}},{"line":239,"address":[],"length":0,"stats":{"Line":0}},{"line":241,"address":[],"length":0,"stats":{"Line":46}},{"line":244,"address":[],"length":0,"stats":{"Line":46}},{"line":247,"address":[],"length":0,"stats":{"Line":46}},{"line":248,"address":[],"length":0,"stats":{"Line":0}},{"line":253,"address":[],"length":0,"stats":{"Line":50}},{"line":254,"address":[],"length":0,"stats":{"Line":0}},{"line":258,"address":[],"length":0,"stats":{"Line":50}},{"line":259,"address":[],"length":0,"stats":{"Line":50}},{"line":261,"address":[],"length":0,"stats":{"Line":172}},{"line":263,"address":[],"length":0,"stats":{"Line":50}},{"line":264,"address":[],"length":0,"stats":{"Line":25}},{"line":266,"address":[],"length":0,"stats":{"Line":0}},{"line":267,"address":[],"length":0,"stats":{"Line":0}},{"line":268,"address":[],"length":0,"stats":{"Line":0}},{"line":270,"address":[],"length":0,"stats":{"Line":54}},{"line":271,"address":[],"length":0,"stats":{"Line":108}},{"line":272,"address":[],"length":0,"stats":{"Line":27}},{"line":274,"address":[],"length":0,"stats":{"Line":32}},{"line":275,"address":[],"length":0,"stats":{"Line":64}},{"line":276,"address":[],"length":0,"stats":{"Line":16}},{"line":278,"address":[],"length":0,"stats":{"Line":18}},{"line":279,"address":[],"length":0,"stats":{"Line":18}},{"line":281,"address":[],"length":0,"stats":{"Line":0}},{"line":282,"address":[],"length":0,"stats":{"Line":0}},{"line":283,"address":[],"length":0,"stats":{"Line":0}},{"line":287,"address":[],"length":0,"stats":{"Line":0}},{"line":288,"address":[],"length":0,"stats":{"Line":0}},{"line":289,"address":[],"length":0,"stats":{"Line":0}},{"line":290,"address":[],"length":0,"stats":{"Line":0}},{"line":292,"address":[],"length":0,"stats":{"Line":0}},{"line":295,"address":[],"length":0,"stats":{"Line":0}},{"line":298,"address":[],"length":0,"stats":{"Line":75}},{"line":301,"address":[],"length":0,"stats":{"Line":50}},{"line":302,"address":[],"length":0,"stats":{"Line":2}},{"line":303,"address":[],"length":0,"stats":{"Line":2}},{"line":305,"address":[],"length":0,"stats":{"Line":23}},{"line":309,"address":[],"length":0,"stats":{"Line":46}},{"line":310,"address":[],"length":0,"stats":{"Line":0}},{"line":313,"address":[],"length":0,"stats":{"Line":23}},{"line":314,"address":[],"length":0,"stats":{"Line":46}},{"line":315,"address":[],"length":0,"stats":{"Line":23}},{"line":316,"address":[],"length":0,"stats":{"Line":23}},{"line":320,"address":[],"length":0,"stats":{"Line":7}},{"line":321,"address":[],"length":0,"stats":{"Line":21}},{"line":322,"address":[],"length":0,"stats":{"Line":21}},{"line":323,"address":[],"length":0,"stats":{"Line":14}},{"line":324,"address":[],"length":0,"stats":{"Line":0}},{"line":328,"address":[],"length":0,"stats":{"Line":14}},{"line":329,"address":[],"length":0,"stats":{"Line":0}},{"line":331,"address":[],"length":0,"stats":{"Line":14}},{"line":334,"address":[],"length":0,"stats":{"Line":14}},{"line":336,"address":[],"length":0,"stats":{"Line":21}},{"line":337,"address":[],"length":0,"stats":{"Line":21}},{"line":338,"address":[],"length":0,"stats":{"Line":0}},{"line":340,"address":[],"length":0,"stats":{"Line":14}},{"line":343,"address":[],"length":0,"stats":{"Line":14}},{"line":344,"address":[],"length":0,"stats":{"Line":7}},{"line":345,"address":[],"length":0,"stats":{"Line":0}},{"line":347,"address":[],"length":0,"stats":{"Line":14}},{"line":350,"address":[],"length":0,"stats":{"Line":21}},{"line":351,"address":[],"length":0,"stats":{"Line":0}},{"line":352,"address":[],"length":0,"stats":{"Line":4}},{"line":353,"address":[],"length":0,"stats":{"Line":10}},{"line":354,"address":[],"length":0,"stats":{"Line":0}},{"line":356,"address":[],"length":0,"stats":{"Line":0}},{"line":357,"address":[],"length":0,"stats":{"Line":0}},{"line":358,"address":[],"length":0,"stats":{"Line":0}},{"line":360,"address":[],"length":0,"stats":{"Line":0}},{"line":363,"address":[],"length":0,"stats":{"Line":0}},{"line":365,"address":[],"length":0,"stats":{"Line":14}},{"line":367,"address":[],"length":0,"stats":{"Line":21}},{"line":370,"address":[],"length":0,"stats":{"Line":14}},{"line":371,"address":[],"length":0,"stats":{"Line":0}},{"line":372,"address":[],"length":0,"stats":{"Line":0}},{"line":374,"address":[],"length":0,"stats":{"Line":7}},{"line":375,"address":[],"length":0,"stats":{"Line":0}},{"line":380,"address":[],"length":0,"stats":{"Line":22}},{"line":381,"address":[],"length":0,"stats":{"Line":12}},{"line":382,"address":[],"length":0,"stats":{"Line":12}},{"line":384,"address":[],"length":0,"stats":{"Line":1}},{"line":387,"address":[],"length":0,"stats":{"Line":7}},{"line":388,"address":[],"length":0,"stats":{"Line":14}},{"line":389,"address":[],"length":0,"stats":{"Line":7}},{"line":390,"address":[],"length":0,"stats":{"Line":7}},{"line":395,"address":[],"length":0,"stats":{"Line":15}},{"line":396,"address":[],"length":0,"stats":{"Line":45}},{"line":397,"address":[],"length":0,"stats":{"Line":30}},{"line":398,"address":[],"length":0,"stats":{"Line":0}},{"line":399,"address":[],"length":0,"stats":{"Line":0}},{"line":400,"address":[],"length":0,"stats":{"Line":0}},{"line":402,"address":[],"length":0,"stats":{"Line":0}},{"line":403,"address":[],"length":0,"stats":{"Line":0}},{"line":404,"address":[],"length":0,"stats":{"Line":0}},{"line":406,"address":[],"length":0,"stats":{"Line":0}},{"line":409,"address":[],"length":0,"stats":{"Line":0}},{"line":411,"address":[],"length":0,"stats":{"Line":30}},{"line":414,"address":[],"length":0,"stats":{"Line":45}},{"line":415,"address":[],"length":0,"stats":{"Line":13}},{"line":416,"address":[],"length":0,"stats":{"Line":0}},{"line":417,"address":[],"length":0,"stats":{"Line":0}},{"line":418,"address":[],"length":0,"stats":{"Line":0}},{"line":419,"address":[],"length":0,"stats":{"Line":2}},{"line":420,"address":[],"length":0,"stats":{"Line":0}},{"line":421,"address":[],"length":0,"stats":{"Line":0}},{"line":423,"address":[],"length":0,"stats":{"Line":30}},{"line":425,"address":[],"length":0,"stats":{"Line":45}},{"line":426,"address":[],"length":0,"stats":{"Line":0}},{"line":427,"address":[],"length":0,"stats":{"Line":30}},{"line":428,"address":[],"length":0,"stats":{"Line":0}},{"line":429,"address":[],"length":0,"stats":{"Line":0}},{"line":431,"address":[],"length":0,"stats":{"Line":0}},{"line":432,"address":[],"length":0,"stats":{"Line":0}},{"line":433,"address":[],"length":0,"stats":{"Line":0}},{"line":435,"address":[],"length":0,"stats":{"Line":0}},{"line":438,"address":[],"length":0,"stats":{"Line":0}},{"line":440,"address":[],"length":0,"stats":{"Line":30}},{"line":442,"address":[],"length":0,"stats":{"Line":15}},{"line":443,"address":[],"length":0,"stats":{"Line":45}},{"line":444,"address":[],"length":0,"stats":{"Line":45}},{"line":445,"address":[],"length":0,"stats":{"Line":15}},{"line":449,"address":[],"length":0,"stats":{"Line":7}},{"line":450,"address":[],"length":0,"stats":{"Line":21}},{"line":451,"address":[],"length":0,"stats":{"Line":21}},{"line":452,"address":[],"length":0,"stats":{"Line":21}},{"line":453,"address":[],"length":0,"stats":{"Line":14}},{"line":454,"address":[],"length":0,"stats":{"Line":0}},{"line":458,"address":[],"length":0,"stats":{"Line":22}},{"line":459,"address":[],"length":0,"stats":{"Line":12}},{"line":460,"address":[],"length":0,"stats":{"Line":12}},{"line":462,"address":[],"length":0,"stats":{"Line":1}},{"line":465,"address":[],"length":0,"stats":{"Line":7}},{"line":466,"address":[],"length":0,"stats":{"Line":7}},{"line":467,"address":[],"length":0,"stats":{"Line":7}},{"line":471,"address":[],"length":0,"stats":{"Line":32}},{"line":472,"address":[],"length":0,"stats":{"Line":96}},{"line":473,"address":[],"length":0,"stats":{"Line":96}},{"line":474,"address":[],"length":0,"stats":{"Line":96}},{"line":475,"address":[],"length":0,"stats":{"Line":64}},{"line":476,"address":[],"length":0,"stats":{"Line":0}},{"line":480,"address":[],"length":0,"stats":{"Line":64}},{"line":481,"address":[],"length":0,"stats":{"Line":70}},{"line":482,"address":[],"length":0,"stats":{"Line":52}},{"line":484,"address":[],"length":0,"stats":{"Line":160}},{"line":485,"address":[],"length":0,"stats":{"Line":40}},{"line":486,"address":[],"length":0,"stats":{"Line":120}},{"line":487,"address":[],"length":0,"stats":{"Line":80}},{"line":489,"address":[],"length":0,"stats":{"Line":120}},{"line":490,"address":[],"length":0,"stats":{"Line":0}},{"line":491,"address":[],"length":0,"stats":{"Line":0}},{"line":492,"address":[],"length":0,"stats":{"Line":0}},{"line":493,"address":[],"length":0,"stats":{"Line":0}},{"line":496,"address":[],"length":0,"stats":{"Line":56}},{"line":497,"address":[],"length":0,"stats":{"Line":56}},{"line":500,"address":[],"length":0,"stats":{"Line":24}},{"line":501,"address":[],"length":0,"stats":{"Line":24}},{"line":503,"address":[],"length":0,"stats":{"Line":0}},{"line":505,"address":[],"length":0,"stats":{"Line":120}},{"line":506,"address":[],"length":0,"stats":{"Line":40}},{"line":507,"address":[],"length":0,"stats":{"Line":40}},{"line":508,"address":[],"length":0,"stats":{"Line":40}},{"line":512,"address":[],"length":0,"stats":{"Line":48}},{"line":513,"address":[],"length":0,"stats":{"Line":24}},{"line":515,"address":[],"length":0,"stats":{"Line":14}},{"line":516,"address":[],"length":0,"stats":{"Line":14}},{"line":518,"address":[],"length":0,"stats":{"Line":2}},{"line":523,"address":[],"length":0,"stats":{"Line":32}},{"line":524,"address":[],"length":0,"stats":{"Line":32}},{"line":525,"address":[],"length":0,"stats":{"Line":32}},{"line":529,"address":[],"length":0,"stats":{"Line":5}},{"line":530,"address":[],"length":0,"stats":{"Line":15}},{"line":531,"address":[],"length":0,"stats":{"Line":15}},{"line":532,"address":[],"length":0,"stats":{"Line":15}},{"line":533,"address":[],"length":0,"stats":{"Line":10}},{"line":534,"address":[],"length":0,"stats":{"Line":0}},{"line":537,"address":[],"length":0,"stats":{"Line":5}},{"line":542,"address":[],"length":0,"stats":{"Line":92}},{"line":543,"address":[],"length":0,"stats":{"Line":276}},{"line":544,"address":[],"length":0,"stats":{"Line":276}},{"line":545,"address":[],"length":0,"stats":{"Line":184}}],"covered":184,"coverable":252},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","storage","bplus_tree","mod.rs"],"content":"//! B+ Tree Index Module\n\nmod tree;\npub use tree::BPlusTree;\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","storage","bplus_tree","node.rs"],"content":"//! B+ Tree Node structures\n\n/// B+ Tree Node types\n#[derive(Debug, Clone, PartialEq)]\npub enum Node {\n    Internal(InternalNode),\n    Leaf(LeafNode),\n}\n\n/// Internal node (for branching in the tree)\n#[derive(Debug, Clone, PartialEq)]\npub struct InternalNode {\n    pub keys: Vec\u003cu64\u003e,      // Separating keys\n    pub children: Vec\u003cu32\u003e,   // Child page IDs\n    pub is_root: bool,\n}\n\nimpl InternalNode {\n    pub fn new() -\u003e Self {\n        Self {\n            keys: Vec::new(),\n            children: Vec::new(),\n            is_root: false,\n        }\n    }\n    \n    pub fn is_leaf(\u0026self) -\u003e bool {\n        false\n    }\n}\n\n/// Leaf node (contains actual key-value pairs)\n#[derive(Debug, Clone, PartialEq)]\npub struct LeafNode {\n    pub keys: Vec\u003cu64\u003e,\n    pub values: Vec\u003cu32\u003e,    // Record IDs or row pointers\n    pub next: Option\u003cu32\u003e,   // Linked list for range scans\n    pub is_root: bool,\n}\n\nimpl LeafNode {\n    pub fn new() -\u003e Self {\n        Self {\n            keys: Vec::new(),\n            values: Vec::new(),\n            next: None,\n            is_root: false,\n        }\n    }\n    \n    pub fn is_leaf(\u0026self) -\u003e bool {\n        true\n    }\n}\n\n/// Maximum keys per node (adjust based on page size)\npub const MAX_KEYS: usize = 100;\npub const MIN_KEYS: usize = 50;\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","storage","bplus_tree","tree.rs"],"content":"//! B+ Tree implementation with proper node structure\n\nuse serde::{Deserialize, Serialize};\n\n/// Maximum keys per node (fanout)\nconst MAX_KEYS: usize = 4;\n\n/// B+ Tree index\n#[derive(Debug, Clone, Serialize, Deserialize)]\npub struct BPlusTree {\n    root: Option\u003cNode\u003e,\n    #[serde(skip)]\n    len: usize,\n}\n\nimpl BPlusTree {\n    /// Create a new B+ Tree\n    pub fn new() -\u003e Self {\n        Self {\n            root: None,\n            len: 0,\n        }\n    }\n\n    /// Get the number of entries\n    pub fn len(\u0026self) -\u003e usize {\n        self.len\n    }\n\n    /// Check if empty\n    pub fn is_empty(\u0026self) -\u003e bool {\n        self.root.is_none()\n    }\n\n    /// Insert a key-value pair\n    pub fn insert(\u0026mut self, key: i64, value: u32) {\n        if self.root.is_none() {\n            let mut leaf = LeafNode::new();\n            leaf.keys.push(key);\n            leaf.values.push(value);\n            self.root = Some(Node::Leaf(leaf));\n            self.len = 1;\n            return;\n        }\n\n        // Take root out, process, put back\n        let root = self.root.take();\n        let new_root = match root {\n            Some(Node::Leaf(mut leaf)) =\u003e {\n                if leaf.keys.len() \u003c MAX_KEYS {\n                    leaf.insert_sorted(key, value);\n                    self.len += 1;\n                    Some(Node::Leaf(leaf))\n                } else {\n                    // Split leaf root\n                    self.split_leaf_root(leaf, key, value)\n                }\n            }\n            Some(Node::Internal(mut internal)) =\u003e {\n                self.insert_into_internal(\u0026mut internal, key, value);\n                self.len += 1;\n                Some(Node::Internal(internal))\n            }\n            None =\u003e None,\n        };\n        self.root = new_root;\n    }\n\n    /// Split leaf root node\n    fn split_leaf_root(\u0026mut self, leaf: LeafNode, key: i64, value: u32) -\u003e Option\u003cNode\u003e {\n        let mut keys = leaf.keys;\n        let mut values = leaf.values;\n        keys.push(key);\n        values.push(value);\n\n        // Sort by key\n        let mut pairs: Vec\u003c_\u003e = keys.into_iter().zip(values.into_iter()).collect();\n        pairs.sort_by_key(|(k, _)| *k);\n\n        let mid = (pairs.len() + 1) / 2;\n        let left_pairs: Vec\u003c_\u003e = pairs[..mid].to_vec();\n        let right_pairs: Vec\u003c_\u003e = pairs[mid..].to_vec();\n\n        let left_leaf = LeafNode {\n            keys: left_pairs.iter().map(|(k, _)| *k).collect(),\n            values: left_pairs.iter().map(|(_, v)| *v).collect(),\n            next: None,\n        };\n\n        let right_leaf = LeafNode {\n            keys: right_pairs.iter().map(|(k, _)| *k).collect(),\n            values: right_pairs.iter().map(|(_, v)| *v).collect(),\n            next: None,\n        };\n\n        let mid_key = right_leaf.keys[0];\n\n        let mut internal = InternalNode::new();\n        internal.keys.push(mid_key);\n        internal.children.push(NodeBox::Leaf(left_leaf));\n        internal.children.push(NodeBox::Leaf(right_leaf));\n\n        self.len += 1;\n        Some(Node::Internal(internal))\n    }\n\n    /// Insert into internal node\n    fn insert_into_internal(\u0026mut self, internal: \u0026mut InternalNode, key: i64, value: u32) {\n        let pos = internal.find_child_position(key);\n\n        match \u0026mut internal.children[pos] {\n            NodeBox::Leaf(child) =\u003e {\n                if child.keys.len() \u003c MAX_KEYS {\n                    child.insert_sorted(key, value);\n                } else {\n                    // Split leaf - this is simplified, just add without full split\n                    child.insert_sorted(key, value);\n                }\n            }\n            NodeBox::Internal(child) =\u003e {\n                self.insert_into_internal(child, key, value);\n            }\n        }\n    }\n\n    /// Search for a key\n    pub fn search(\u0026self, key: i64) -\u003e Option\u003cu32\u003e {\n        self.search_node(self.root.as_ref()?, key)\n    }\n\n    fn search_node(\u0026self, node: \u0026Node, key: i64) -\u003e Option\u003cu32\u003e {\n        match node {\n            Node::Leaf(leaf) =\u003e leaf.search(key),\n            Node::Internal(internal) =\u003e {\n                let pos = internal.find_child_position(key);\n                self.search_node(\u0026internal.child(pos), key)\n            }\n        }\n    }\n\n    /// Range query: [start, end)\n    pub fn range_query(\u0026self, start: i64, end: i64) -\u003e Vec\u003cu32\u003e {\n        if self.root.is_none() {\n            return vec![];\n        }\n        self.range_query_node(self.root.as_ref().unwrap(), start, end)\n    }\n\n    fn range_query_node(\u0026self, node: \u0026Node, start: i64, end: i64) -\u003e Vec\u003cu32\u003e {\n        match node {\n            Node::Leaf(leaf) =\u003e leaf.range_query(start, end),\n            Node::Internal(internal) =\u003e {\n                let mut results = Vec::new();\n                for child in internal.children.iter() {\n                    results.extend(self.range_query_node(\u0026child.as_node(), start, end));\n                }\n                results\n            }\n        }\n    }\n\n    /// Get all keys in order\n    pub fn keys(\u0026self) -\u003e Vec\u003ci64\u003e {\n        if let Some(root) = \u0026self.root {\n            self.collect_keys(root)\n        } else {\n            vec![]\n        }\n    }\n\n    fn collect_keys(\u0026self, node: \u0026Node) -\u003e Vec\u003ci64\u003e {\n        match node {\n            Node::Leaf(leaf) =\u003e leaf.keys.clone(),\n            Node::Internal(internal) =\u003e {\n                let mut keys = Vec::new();\n                for child in internal.children.iter() {\n                    keys.extend(self.collect_keys(\u0026child.as_node()));\n                }\n                keys\n            }\n        }\n    }\n}\n\nimpl Default for BPlusTree {\n    fn default() -\u003e Self {\n        Self::new()\n    }\n}\n\n/// Leaf node - stores actual data\n#[derive(Debug, Clone, Serialize, Deserialize)]\nstruct LeafNode {\n    keys: Vec\u003ci64\u003e,\n    values: Vec\u003cu32\u003e,\n    next: Option\u003cusize\u003e,\n}\n\nimpl LeafNode {\n    fn new() -\u003e Self {\n        Self {\n            keys: Vec::new(),\n            values: Vec::new(),\n            next: None,\n        }\n    }\n\n    fn insert_sorted(\u0026mut self, key: i64, value: u32) {\n        let pos = self.keys.binary_search(\u0026key).unwrap_or_else(|e| e);\n        self.keys.insert(pos, key);\n        self.values.insert(pos, value);\n    }\n\n    fn search(\u0026self, key: i64) -\u003e Option\u003cu32\u003e {\n        self.keys\n            .binary_search(\u0026key)\n            .ok()\n            .and_then(|i| self.values.get(i).copied())\n    }\n\n    fn range_query(\u0026self, start: i64, end: i64) -\u003e Vec\u003cu32\u003e {\n        let start_pos = self.keys.binary_search(\u0026start).unwrap_or_else(|e| e);\n        let end_pos = self.keys.binary_search(\u0026end).unwrap_or_else(|e| e);\n        self.values[start_pos..end_pos].to_vec()\n    }\n}\n\n/// Internal node - points to child nodes\n#[derive(Debug, Clone, Serialize, Deserialize)]\nstruct InternalNode {\n    keys: Vec\u003ci64\u003e,\n    children: Vec\u003cNodeBox\u003e,\n}\n\nimpl InternalNode {\n    fn new() -\u003e Self {\n        Self {\n            keys: Vec::new(),\n            children: Vec::new(),\n        }\n    }\n\n    fn find_child_position(\u0026self, key: i64) -\u003e usize {\n        self.keys.iter().position(|k| *k \u003e key).unwrap_or(self.keys.len())\n    }\n\n    fn child(\u0026self, pos: usize) -\u003e Node {\n        match \u0026self.children[pos] {\n            NodeBox::Leaf(l) =\u003e Node::Leaf(l.clone()),\n            NodeBox::Internal(i) =\u003e Node::Internal(i.clone()),\n        }\n    }\n}\n\n/// Boxed node for type erasure\n#[derive(Debug, Clone, Serialize, Deserialize)]\nenum NodeBox {\n    Leaf(LeafNode),\n    Internal(InternalNode),\n}\n\nimpl NodeBox {\n    fn as_node(\u0026self) -\u003e Node {\n        match self {\n            NodeBox::Leaf(l) =\u003e Node::Leaf(l.clone()),\n            NodeBox::Internal(i) =\u003e Node::Internal(i.clone()),\n        }\n    }\n}\n\n/// B+ Tree node\n#[derive(Debug, Clone, Serialize, Deserialize)]\nenum Node {\n    Leaf(LeafNode),\n    Internal(InternalNode),\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_bplus_tree_insert_single() {\n        let mut tree = BPlusTree::new();\n        tree.insert(10, 100);\n        assert!(!tree.is_empty());\n        assert_eq!(tree.len(), 1);\n    }\n\n    #[test]\n    fn test_bplus_tree_insert_multiple() {\n        let mut tree = BPlusTree::new();\n        tree.insert(10, 100);\n        tree.insert(20, 200);\n        tree.insert(30, 300);\n        assert_eq!(tree.len(), 3);\n    }\n\n    #[test]\n    fn test_bplus_tree_search() {\n        let mut tree = BPlusTree::new();\n        tree.insert(10, 100);\n        tree.insert(20, 200);\n        tree.insert(30, 300);\n        assert_eq!(tree.search(10), Some(100));\n        assert_eq!(tree.search(20), Some(200));\n        assert_eq!(tree.search(99), None);\n    }\n\n    #[test]\n    fn test_bplus_tree_range_query() {\n        let mut tree = BPlusTree::new();\n        tree.insert(10, 100);\n        tree.insert(20, 200);\n        tree.insert(30, 300);\n        tree.insert(40, 400);\n        tree.insert(50, 500);\n\n        let results = tree.range_query(20, 40);\n        assert_eq!(results.len(), 2);\n    }\n\n    #[test]\n    fn test_bplus_tree_keys() {\n        let mut tree = BPlusTree::new();\n        tree.insert(30, 300);\n        tree.insert(10, 100);\n        tree.insert(20, 200);\n\n        let keys = tree.keys();\n        assert_eq!(keys, vec![10, 20, 30]);\n    }\n\n    #[test]\n    fn test_bplus_tree_empty() {\n        let tree = BPlusTree::new();\n        assert!(tree.is_empty());\n        assert_eq!(tree.search(10), None);\n    }\n}\n","traces":[{"line":18,"address":[],"length":0,"stats":{"Line":7}},{"line":26,"address":[],"length":0,"stats":{"Line":2}},{"line":27,"address":[],"length":0,"stats":{"Line":2}},{"line":31,"address":[],"length":0,"stats":{"Line":2}},{"line":32,"address":[],"length":0,"stats":{"Line":4}},{"line":36,"address":[],"length":0,"stats":{"Line":16}},{"line":37,"address":[],"length":0,"stats":{"Line":32}},{"line":38,"address":[],"length":0,"stats":{"Line":12}},{"line":39,"address":[],"length":0,"stats":{"Line":18}},{"line":40,"address":[],"length":0,"stats":{"Line":18}},{"line":41,"address":[],"length":0,"stats":{"Line":12}},{"line":42,"address":[],"length":0,"stats":{"Line":6}},{"line":43,"address":[],"length":0,"stats":{"Line":6}},{"line":47,"address":[],"length":0,"stats":{"Line":30}},{"line":48,"address":[],"length":0,"stats":{"Line":20}},{"line":49,"address":[],"length":0,"stats":{"Line":10}},{"line":50,"address":[],"length":0,"stats":{"Line":10}},{"line":51,"address":[],"length":0,"stats":{"Line":36}},{"line":52,"address":[],"length":0,"stats":{"Line":9}},{"line":53,"address":[],"length":0,"stats":{"Line":9}},{"line":56,"address":[],"length":0,"stats":{"Line":5}},{"line":59,"address":[],"length":0,"stats":{"Line":0}},{"line":60,"address":[],"length":0,"stats":{"Line":0}},{"line":61,"address":[],"length":0,"stats":{"Line":0}},{"line":62,"address":[],"length":0,"stats":{"Line":0}},{"line":64,"address":[],"length":0,"stats":{"Line":0}},{"line":66,"address":[],"length":0,"stats":{"Line":20}},{"line":70,"address":[],"length":0,"stats":{"Line":1}},{"line":71,"address":[],"length":0,"stats":{"Line":2}},{"line":72,"address":[],"length":0,"stats":{"Line":2}},{"line":73,"address":[],"length":0,"stats":{"Line":3}},{"line":74,"address":[],"length":0,"stats":{"Line":3}},{"line":77,"address":[],"length":0,"stats":{"Line":8}},{"line":78,"address":[],"length":0,"stats":{"Line":2}},{"line":80,"address":[],"length":0,"stats":{"Line":2}},{"line":81,"address":[],"length":0,"stats":{"Line":4}},{"line":82,"address":[],"length":0,"stats":{"Line":4}},{"line":85,"address":[],"length":0,"stats":{"Line":3}},{"line":86,"address":[],"length":0,"stats":{"Line":3}},{"line":91,"address":[],"length":0,"stats":{"Line":3}},{"line":92,"address":[],"length":0,"stats":{"Line":3}},{"line":96,"address":[],"length":0,"stats":{"Line":2}},{"line":98,"address":[],"length":0,"stats":{"Line":2}},{"line":99,"address":[],"length":0,"stats":{"Line":3}},{"line":100,"address":[],"length":0,"stats":{"Line":3}},{"line":101,"address":[],"length":0,"stats":{"Line":3}},{"line":103,"address":[],"length":0,"stats":{"Line":1}},{"line":104,"address":[],"length":0,"stats":{"Line":1}},{"line":108,"address":[],"length":0,"stats":{"Line":0}},{"line":109,"address":[],"length":0,"stats":{"Line":0}},{"line":111,"address":[],"length":0,"stats":{"Line":0}},{"line":112,"address":[],"length":0,"stats":{"Line":0}},{"line":113,"address":[],"length":0,"stats":{"Line":0}},{"line":114,"address":[],"length":0,"stats":{"Line":0}},{"line":117,"address":[],"length":0,"stats":{"Line":0}},{"line":120,"address":[],"length":0,"stats":{"Line":0}},{"line":121,"address":[],"length":0,"stats":{"Line":0}},{"line":127,"address":[],"length":0,"stats":{"Line":5}},{"line":128,"address":[],"length":0,"stats":{"Line":24}},{"line":131,"address":[],"length":0,"stats":{"Line":4}},{"line":132,"address":[],"length":0,"stats":{"Line":4}},{"line":133,"address":[],"length":0,"stats":{"Line":16}},{"line":134,"address":[],"length":0,"stats":{"Line":0}},{"line":135,"address":[],"length":0,"stats":{"Line":0}},{"line":136,"address":[],"length":0,"stats":{"Line":0}},{"line":142,"address":[],"length":0,"stats":{"Line":1}},{"line":143,"address":[],"length":0,"stats":{"Line":2}},{"line":144,"address":[],"length":0,"stats":{"Line":0}},{"line":146,"address":[],"length":0,"stats":{"Line":6}},{"line":149,"address":[],"length":0,"stats":{"Line":3}},{"line":150,"address":[],"length":0,"stats":{"Line":3}},{"line":151,"address":[],"length":0,"stats":{"Line":10}},{"line":152,"address":[],"length":0,"stats":{"Line":1}},{"line":153,"address":[],"length":0,"stats":{"Line":2}},{"line":154,"address":[],"length":0,"stats":{"Line":5}},{"line":155,"address":[],"length":0,"stats":{"Line":12}},{"line":157,"address":[],"length":0,"stats":{"Line":1}},{"line":163,"address":[],"length":0,"stats":{"Line":1}},{"line":164,"address":[],"length":0,"stats":{"Line":2}},{"line":165,"address":[],"length":0,"stats":{"Line":3}},{"line":167,"address":[],"length":0,"stats":{"Line":0}},{"line":171,"address":[],"length":0,"stats":{"Line":1}},{"line":172,"address":[],"length":0,"stats":{"Line":1}},{"line":173,"address":[],"length":0,"stats":{"Line":3}},{"line":174,"address":[],"length":0,"stats":{"Line":0}},{"line":175,"address":[],"length":0,"stats":{"Line":0}},{"line":176,"address":[],"length":0,"stats":{"Line":0}},{"line":177,"address":[],"length":0,"stats":{"Line":0}},{"line":179,"address":[],"length":0,"stats":{"Line":0}},{"line":186,"address":[],"length":0,"stats":{"Line":0}},{"line":187,"address":[],"length":0,"stats":{"Line":0}},{"line":200,"address":[],"length":0,"stats":{"Line":6}},{"line":202,"address":[],"length":0,"stats":{"Line":12}},{"line":203,"address":[],"length":0,"stats":{"Line":6}},{"line":208,"address":[],"length":0,"stats":{"Line":9}},{"line":209,"address":[],"length":0,"stats":{"Line":36}},{"line":210,"address":[],"length":0,"stats":{"Line":36}},{"line":211,"address":[],"length":0,"stats":{"Line":36}},{"line":214,"address":[],"length":0,"stats":{"Line":4}},{"line":215,"address":[],"length":0,"stats":{"Line":8}},{"line":216,"address":[],"length":0,"stats":{"Line":4}},{"line":218,"address":[],"length":0,"stats":{"Line":13}},{"line":221,"address":[],"length":0,"stats":{"Line":2}},{"line":222,"address":[],"length":0,"stats":{"Line":8}},{"line":223,"address":[],"length":0,"stats":{"Line":8}},{"line":224,"address":[],"length":0,"stats":{"Line":6}},{"line":236,"address":[],"length":0,"stats":{"Line":1}},{"line":238,"address":[],"length":0,"stats":{"Line":1}},{"line":239,"address":[],"length":0,"stats":{"Line":1}},{"line":243,"address":[],"length":0,"stats":{"Line":0}},{"line":244,"address":[],"length":0,"stats":{"Line":0}},{"line":247,"address":[],"length":0,"stats":{"Line":0}},{"line":248,"address":[],"length":0,"stats":{"Line":0}},{"line":249,"address":[],"length":0,"stats":{"Line":0}},{"line":250,"address":[],"length":0,"stats":{"Line":0}},{"line":263,"address":[],"length":0,"stats":{"Line":2}},{"line":264,"address":[],"length":0,"stats":{"Line":2}},{"line":265,"address":[],"length":0,"stats":{"Line":4}},{"line":266,"address":[],"length":0,"stats":{"Line":0}}],"covered":86,"coverable":119},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","storage","buffer_pool.rs"],"content":"//! Buffer Pool Manager\n\nuse super::page::Page;\nuse std::collections::HashMap;\nuse std::sync::{Arc, Mutex};\n\n/// Simple buffer pool with HashMap\npub struct BufferPool {\n    pages: Mutex\u003cHashMap\u003cu32, Arc\u003cPage\u003e\u003e\u003e,\n    capacity: usize,\n}\n\nimpl BufferPool {\n    /// Create a new buffer pool\n    pub fn new(capacity: usize) -\u003e Self {\n        Self {\n            pages: Mutex::new(HashMap::new()),\n            capacity,\n        }\n    }\n\n    /// Get a page\n    pub fn get(\u0026self, page_id: u32) -\u003e Option\u003cArc\u003cPage\u003e\u003e {\n        let pages = self.pages.lock().unwrap();\n        pages.get(\u0026page_id).cloned()\n    }\n\n    /// Insert a page\n    pub fn insert(\u0026self, page: Arc\u003cPage\u003e) {\n        let mut pages = self.pages.lock().unwrap();\n        if pages.len() \u003e= self.capacity {\n            pages.remove(\u00260); // Simple eviction\n        }\n        pages.insert(page.page_id(), page);\n    }\n\n    /// Allocate a new page\n    pub fn allocate(\u0026self, page_id: u32) -\u003e Arc\u003cPage\u003e {\n        let page = Arc::new(Page::new(page_id));\n        self.insert(Arc::clone(\u0026page));\n        page\n    }\n\n    /// Get capacity\n    pub fn capacity(\u0026self) -\u003e usize {\n        self.capacity\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_buffer_pool_basic() {\n        let pool = BufferPool::new(10);\n        assert_eq!(pool.capacity(), 10);\n    }\n\n    #[test]\n    fn test_buffer_pool_get_page() {\n        let pool = BufferPool::new(10);\n        let page = Arc::new(Page::new(1));\n        pool.insert(page);\n        let retrieved = pool.get(1);\n        assert!(retrieved.is_some());\n        assert_eq!(retrieved.unwrap().page_id(), 1);\n    }\n\n    #[test]\n    fn test_buffer_pool_allocate() {\n        let pool = BufferPool::new(10);\n        let page = pool.allocate(5);\n        assert_eq!(page.page_id(), 5);\n        let retrieved = pool.get(5);\n        assert!(retrieved.is_some());\n    }\n\n    #[test]\n    fn test_buffer_pool_empty() {\n        let pool = BufferPool::new(5);\n        let retrieved = pool.get(999);\n        assert!(retrieved.is_none());\n    }\n}\n","traces":[{"line":15,"address":[],"length":0,"stats":{"Line":36}},{"line":17,"address":[],"length":0,"stats":{"Line":72}},{"line":23,"address":[],"length":0,"stats":{"Line":3}},{"line":24,"address":[],"length":0,"stats":{"Line":12}},{"line":25,"address":[],"length":0,"stats":{"Line":9}},{"line":29,"address":[],"length":0,"stats":{"Line":2}},{"line":30,"address":[],"length":0,"stats":{"Line":8}},{"line":31,"address":[],"length":0,"stats":{"Line":2}},{"line":32,"address":[],"length":0,"stats":{"Line":0}},{"line":34,"address":[],"length":0,"stats":{"Line":6}},{"line":38,"address":[],"length":0,"stats":{"Line":1}},{"line":39,"address":[],"length":0,"stats":{"Line":4}},{"line":40,"address":[],"length":0,"stats":{"Line":4}},{"line":41,"address":[],"length":0,"stats":{"Line":1}},{"line":45,"address":[],"length":0,"stats":{"Line":1}},{"line":46,"address":[],"length":0,"stats":{"Line":1}}],"covered":15,"coverable":16},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","storage","file_storage.rs"],"content":"//! File-based table storage\n//! Persists table data to JSON files\n\nuse crate::executor::{TableData, TableInfo};\nuse crate::storage::BPlusTree;\nuse crate::types::Value;\nuse std::collections::HashMap;\nuse std::fs::{self, File};\nuse std::io::{BufReader, BufWriter, Write};\nuse std::path::PathBuf;\n\n/// File-based storage manager\npub struct FileStorage {\n    /// Base directory for database files\n    data_dir: PathBuf,\n    /// In-memory cache of tables\n    tables: HashMap\u003cString, TableData\u003e,\n    /// B+ Tree indexes: (table_name, column_name) -\u003e BPlusTree\n    indexes: HashMap\u003c(String, String), BPlusTree\u003e,\n}\n\nimpl FileStorage {\n    /// Create a new FileStorage with the given data directory\n    pub fn new(data_dir: PathBuf) -\u003e std::io::Result\u003cSelf\u003e {\n        // Create directory if it doesn't exist\n        fs::create_dir_all(\u0026data_dir)?;\n\n        let mut storage = Self {\n            data_dir,\n            tables: HashMap::new(),\n            indexes: HashMap::new(),\n        };\n\n        // Load existing tables\n        storage.load_all_tables()?;\n\n        // Load existing indexes\n        storage.load_all_indexes()?;\n\n        Ok(storage)\n    }\n\n    /// Get the path for a table file\n    fn table_path(\u0026self, table_name: \u0026str) -\u003e PathBuf {\n        self.data_dir.join(format!(\"{}.json\", table_name))\n    }\n\n    /// Get the path for an index file\n    fn index_path(\u0026self, table_name: \u0026str, column_name: \u0026str) -\u003e PathBuf {\n        self.data_dir.join(format!(\"{}_idx_{}.json\", table_name, column_name))\n    }\n\n    /// Load all tables from the data directory\n    fn load_all_tables(\u0026mut self) -\u003e std::io::Result\u003c()\u003e {\n        if !self.data_dir.exists() {\n            return Ok(());\n        }\n\n        for entry in fs::read_dir(\u0026self.data_dir)? {\n            let entry = entry?;\n            let path = entry.path();\n\n            if path.extension().and_then(|s| s.to_str()) == Some(\"json\")\n                \u0026\u0026 let Some(table_name) = path.file_stem().and_then(|s| s.to_str())\n                \u0026\u0026 let Ok(table_data) = self.load_table(table_name)\n            {\n                self.tables.insert(table_name.to_string(), table_data);\n            }\n        }\n\n        Ok(())\n    }\n\n    /// Load all indexes from the data directory\n    fn load_all_indexes(\u0026mut self) -\u003e std::io::Result\u003c()\u003e {\n        if !self.data_dir.exists() {\n            return Ok(());\n        }\n\n        for entry in fs::read_dir(\u0026self.data_dir)? {\n            let entry = entry?;\n            let path = entry.path();\n\n            // Look for index files: table_idx_column.json\n            if let Some(file_name) = path.file_name().and_then(|s| s.to_str()) {\n                if file_name.ends_with(\".json\") \u0026\u0026 file_name.contains(\"_idx_\") {\n                    // Parse table_idx_column.json\n                    if let Some((table_name, column_name)) = file_name\n                        .strip_suffix(\".json\")\n                        .and_then(|s| s.split_once(\"_idx_\"))\n                    {\n                        if let Ok(index) = self.load_index(table_name, column_name) {\n                            self.indexes.insert(\n                                (table_name.to_string(), column_name.to_string()),\n                                index,\n                            );\n                        }\n                    }\n                }\n            }\n        }\n\n        Ok(())\n    }\n\n    /// Load a single index from disk\n    fn load_index(\u0026self, table_name: \u0026str, column_name: \u0026str) -\u003e std::io::Result\u003cBPlusTree\u003e {\n        let path = self.index_path(table_name, column_name);\n        let file = File::open(\u0026path)?;\n        let reader = BufReader::new(file);\n        let index: BPlusTree = serde_json::from_reader(reader)\n            .map_err(|e| std::io::Error::new(std::io::ErrorKind::InvalidData, e))?;\n\n        Ok(index)\n    }\n\n    /// Save an index to disk\n    fn save_index(\u0026self, table_name: \u0026str, column_name: \u0026str, index: \u0026BPlusTree) -\u003e std::io::Result\u003c()\u003e {\n        let path = self.index_path(table_name, column_name);\n        let file = File::create(\u0026path)?;\n        let mut writer = BufWriter::new(file);\n\n        let json = serde_json::to_string_pretty(index)\n            .map_err(|e| std::io::Error::new(std::io::ErrorKind::InvalidData, e))?;\n\n        writer.write_all(json.as_bytes())?;\n        writer.flush()?;\n\n        Ok(())\n    }\n\n    /// Load a single table from disk\n    fn load_table(\u0026self, table_name: \u0026str) -\u003e std::io::Result\u003cTableData\u003e {\n        let path = self.table_path(table_name);\n        let file = File::open(\u0026path)?;\n        let reader = BufReader::new(file);\n        let stored: StoredTableData = serde_json::from_reader(reader)\n            .map_err(|e| std::io::Error::new(std::io::ErrorKind::InvalidData, e))?;\n\n        Ok(TableData {\n            info: TableInfo {\n                name: stored.name,\n                columns: stored.columns,\n            },\n            rows: stored.rows,\n        })\n    }\n\n    /// Save a table to disk\n    fn save_table(\u0026self, table_name: \u0026str, table_data: \u0026TableData) -\u003e std::io::Result\u003c()\u003e {\n        let path = self.table_path(table_name);\n        let file = File::create(\u0026path)?;\n        let mut writer = BufWriter::new(file);\n\n        let stored = StoredTableData {\n            name: table_data.info.name.clone(),\n            columns: table_data.info.columns.clone(),\n            rows: table_data.rows.clone(),\n        };\n\n        let json = serde_json::to_string_pretty(\u0026stored)\n            .map_err(|e| std::io::Error::new(std::io::ErrorKind::InvalidData, e))?;\n\n        writer.write_all(json.as_bytes())?;\n        writer.flush()?;\n\n        Ok(())\n    }\n\n    /// Get a table by name\n    pub fn get_table(\u0026self, name: \u0026str) -\u003e Option\u003c\u0026TableData\u003e {\n        self.tables.get(name)\n    }\n\n    /// Get a mutable table by name\n    pub fn get_table_mut(\u0026mut self, name: \u0026str) -\u003e Option\u003c\u0026mut TableData\u003e {\n        self.tables.get_mut(name)\n    }\n\n    /// Insert a new table\n    pub fn insert_table(\u0026mut self, name: String, table_data: TableData) -\u003e std::io::Result\u003c()\u003e {\n        self.tables.insert(name.clone(), table_data.clone());\n        self.save_table(\u0026name, \u0026table_data)\n    }\n\n    /// Drop (delete) a table\n    pub fn drop_table(\u0026mut self, name: \u0026str) -\u003e std::io::Result\u003c()\u003e {\n        self.tables.remove(name);\n\n        let path = self.table_path(name);\n        if path.exists() {\n            fs::remove_file(path)?;\n        }\n\n        Ok(())\n    }\n\n    /// Get all table names\n    pub fn table_names(\u0026self) -\u003e Vec\u003cString\u003e {\n        self.tables.keys().cloned().collect()\n    }\n\n    /// Force save all dirty tables to disk\n    pub fn flush(\u0026self) -\u003e std::io::Result\u003c()\u003e {\n        for (name, table_data) in \u0026self.tables {\n            self.save_table(name, table_data)?;\n        }\n        Ok(())\n    }\n\n    /// Check if a table exists\n    pub fn contains_table(\u0026self, name: \u0026str) -\u003e bool {\n        self.tables.contains_key(name)\n    }\n\n    /// Save a table to disk (call after modifications)\n    pub fn persist_table(\u0026self, name: \u0026str) -\u003e std::io::Result\u003c()\u003e {\n        if let Some(table_data) = self.tables.get(name) {\n            self.save_table(name, table_data)\n        } else {\n            Ok(())\n        }\n    }\n\n    // ==================== Index Methods ====================\n\n    /// Check if an index exists for a table column\n    pub fn has_index(\u0026self, table_name: \u0026str, column_name: \u0026str) -\u003e bool {\n        self.indexes.contains_key(\u0026(table_name.to_string(), column_name.to_string()))\n    }\n\n    /// Get an index for a table column (read-only)\n    pub fn get_index(\u0026self, table_name: \u0026str, column_name: \u0026str) -\u003e Option\u003c\u0026BPlusTree\u003e {\n        self.indexes.get(\u0026(table_name.to_string(), column_name.to_string()))\n    }\n\n    /// Create or update an index for a table column from existing data\n    pub fn create_index(\n        \u0026mut self,\n        table_name: \u0026str,\n        column_name: \u0026str,\n        column_index: usize,\n    ) -\u003e std::io::Result\u003c()\u003e {\n        let table = self\n            .tables\n            .get(table_name)\n            .ok_or_else(|| std::io::Error::new(std::io::ErrorKind::NotFound, \"Table not found\"))?;\n\n        // Build B+ Tree from existing rows\n        let mut index = BPlusTree::new();\n        for (row_id, row) in table.rows.iter().enumerate() {\n            if let Some(value) = row.get(column_index) {\n                if let Value::Integer(key) = value {\n                    index.insert(*key, row_id as u32);\n                }\n            }\n        }\n\n        // Save to disk\n        self.save_index(table_name, column_name, \u0026index)?;\n\n        // Store in memory\n        self.indexes.insert(\n            (table_name.to_string(), column_name.to_string()),\n            index,\n        );\n\n        Ok(())\n    }\n\n    /// Insert a row and update index\n    pub fn insert_with_index(\n        \u0026mut self,\n        table_name: \u0026str,\n        column_name: \u0026str,\n        key: i64,\n        row_id: u32,\n    ) -\u003e std::io::Result\u003c()\u003e {\n        let key_exists = (table_name.to_string(), column_name.to_string());\n\n        // Clone the key for later use\n        let has_index = self.indexes.contains_key(\u0026key_exists);\n\n        if has_index {\n            // Get mutable reference, insert, then save\n            if let Some(index) = self.indexes.get_mut(\u0026key_exists) {\n                index.insert(key, row_id);\n            }\n            // Now we can borrow immutably to save\n            if let Some(index) = self.indexes.get(\u0026key_exists) {\n                self.save_index(table_name, column_name, index)?;\n            }\n        }\n\n        Ok(())\n    }\n\n    /// Search using index - returns row IDs matching the key\n    pub fn search_index(\u0026self, table_name: \u0026str, column_name: \u0026str, key: i64) -\u003e Option\u003cu32\u003e {\n        self.indexes\n            .get(\u0026(table_name.to_string(), column_name.to_string()))\n            .and_then(|index| index.search(key))\n    }\n\n    /// Range query using index\n    pub fn range_index(\n        \u0026self,\n        table_name: \u0026str,\n        column_name: \u0026str,\n        start: i64,\n        end: i64,\n    ) -\u003e Vec\u003cu32\u003e {\n        self.indexes\n            .get(\u0026(table_name.to_string(), column_name.to_string()))\n            .map(|index| index.range_query(start, end))\n            .unwrap_or_default()\n    }\n\n    /// Drop an index\n    pub fn drop_index(\u0026mut self, table_name: \u0026str, column_name: \u0026str) -\u003e std::io::Result\u003c()\u003e {\n        let key = (table_name.to_string(), column_name.to_string());\n        self.indexes.remove(\u0026key);\n\n        let path = self.index_path(table_name, column_name);\n        if path.exists() {\n            fs::remove_file(path)?;\n        }\n\n        Ok(())\n    }\n\n    /// Flush all indexes to disk\n    pub fn flush_indexes(\u0026self) -\u003e std::io::Result\u003c()\u003e {\n        for ((table_name, column_name), index) in \u0026self.indexes {\n            self.save_index(table_name, column_name, index)?;\n        }\n        Ok(())\n    }\n}\n\n/// Stored table data (for serialization)\n#[derive(serde::Serialize, serde::Deserialize)]\nstruct StoredTableData {\n    name: String,\n    columns: Vec\u003ccrate::parser::ColumnDefinition\u003e,\n    rows: Vec\u003cVec\u003cValue\u003e\u003e,\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use crate::parser::ColumnDefinition;\n    use std::fs::remove_dir_all;\n\n    #[test]\n    fn test_file_storage_crud() {\n        let temp_dir = std::env::temp_dir().join(\"sqlrustgo_test_crud\");\n        let _ = remove_dir_all(\u0026temp_dir);\n\n        // Create storage\n        let mut storage = FileStorage::new(temp_dir.clone()).unwrap();\n\n        // CREATE: Insert first table\n        let table1 = TableData {\n            info: TableInfo {\n                name: \"test_table\".to_string(),\n                columns: vec![ColumnDefinition {\n                    name: \"id\".to_string(),\n                    data_type: \"INTEGER\".to_string(),\n                    nullable: false,\n                }],\n            },\n            rows: vec![vec![Value::Integer(1)]],\n        };\n        storage\n            .insert_table(\"test_table\".to_string(), table1)\n            .unwrap();\n\n        // READ: Verify table exists\n        assert!(storage.contains_table(\"test_table\"));\n        let retrieved = storage.get_table(\"test_table\").unwrap();\n        assert_eq!(retrieved.info.name, \"test_table\");\n        assert_eq!(retrieved.rows.len(), 1);\n\n        // UPDATE: Add more rows\n        {\n            let table = storage.get_table_mut(\"test_table\").unwrap();\n            table.rows.push(vec![Value::Integer(2)]);\n        }\n        storage.persist_table(\"test_table\").unwrap();\n\n        // Verify update persisted\n        let updated = storage.get_table(\"test_table\").unwrap();\n        assert_eq!(updated.rows.len(), 2);\n\n        // DELETE: Drop table\n        storage.drop_table(\"test_table\").unwrap();\n        assert!(!storage.contains_table(\"test_table\"));\n        assert!(storage.get_table(\"test_table\").is_none());\n\n        // Cleanup\n        let _ = remove_dir_all(\u0026temp_dir);\n    }\n\n    #[test]\n    fn test_file_storage_multiple_tables() {\n        let temp_dir = std::env::temp_dir().join(\"sqlrustgo_test_multi\");\n        let _ = remove_dir_all(\u0026temp_dir);\n\n        let mut storage = FileStorage::new(temp_dir.clone()).unwrap();\n\n        // Create multiple tables\n        let table_a = TableData {\n            info: TableInfo {\n                name: \"table_a\".to_string(),\n                columns: vec![ColumnDefinition {\n                    name: \"col1\".to_string(),\n                    data_type: \"TEXT\".to_string(),\n                    nullable: false,\n                }],\n            },\n            rows: vec![vec![Value::Text(\"hello\".to_string())]],\n        };\n        storage\n            .insert_table(\"table_a\".to_string(), table_a)\n            .unwrap();\n\n        let table_b = TableData {\n            info: TableInfo {\n                name: \"table_b\".to_string(),\n                columns: vec![ColumnDefinition {\n                    name: \"col2\".to_string(),\n                    data_type: \"INTEGER\".to_string(),\n                    nullable: true,\n                }],\n            },\n            rows: vec![vec![Value::Integer(100)], vec![Value::Integer(200)]],\n        };\n        storage\n            .insert_table(\"table_b\".to_string(), table_b)\n            .unwrap();\n\n        // Verify all tables exist\n        let names = storage.table_names();\n        assert_eq!(names.len(), 2);\n        assert!(names.contains(\u0026\"table_a\".to_string()));\n        assert!(names.contains(\u0026\"table_b\".to_string()));\n\n        // Verify individual tables\n        assert!(storage.contains_table(\"table_a\"));\n        assert!(storage.contains_table(\"table_b\"));\n        assert_eq!(storage.get_table(\"table_b\").unwrap().rows.len(), 2);\n\n        // Drop one table, verify other still exists\n        storage.drop_table(\"table_a\").unwrap();\n        assert!(!storage.contains_table(\"table_a\"));\n        assert!(storage.contains_table(\"table_b\"));\n\n        // Cleanup\n        let _ = remove_dir_all(\u0026temp_dir);\n    }\n\n    #[test]\n    fn test_file_storage_persistence() {\n        let temp_dir = std::env::temp_dir().join(\"sqlrustgo_test_persist\");\n        let _ = remove_dir_all(\u0026temp_dir);\n\n        // First session: create and populate table\n        {\n            let mut storage = FileStorage::new(temp_dir.clone()).unwrap();\n            let table = TableData {\n                info: TableInfo {\n                    name: \"persistent_table\".to_string(),\n                    columns: vec![\n                        ColumnDefinition {\n                            name: \"id\".to_string(),\n                            data_type: \"INTEGER\".to_string(),\n                            nullable: false,\n                        },\n                        ColumnDefinition {\n                            name: \"value\".to_string(),\n                            data_type: \"TEXT\".to_string(),\n                            nullable: true,\n                        },\n                    ],\n                },\n                rows: vec![\n                    vec![Value::Integer(1), Value::Text(\"first\".to_string())],\n                    vec![Value::Integer(2), Value::Text(\"second\".to_string())],\n                    vec![Value::Integer(3), Value::Text(\"third\".to_string())],\n                ],\n            };\n            storage\n                .insert_table(\"persistent_table\".to_string(), table)\n                .unwrap();\n        }\n\n        // Second session: verify data persisted\n        {\n            let storage = FileStorage::new(temp_dir.clone()).unwrap();\n            assert!(storage.contains_table(\"persistent_table\"));\n\n            let table = storage.get_table(\"persistent_table\").unwrap();\n            assert_eq!(table.info.columns.len(), 2);\n            assert_eq!(table.rows.len(), 3);\n            assert_eq!(\n                table.rows[0],\n                vec![Value::Integer(1), Value::Text(\"first\".to_string())]\n            );\n            assert_eq!(\n                table.rows[1],\n                vec![Value::Integer(2), Value::Text(\"second\".to_string())]\n            );\n            assert_eq!(\n                table.rows[2],\n                vec![Value::Integer(3), Value::Text(\"third\".to_string())]\n            );\n        }\n\n        // Cleanup\n        let _ = remove_dir_all(\u0026temp_dir);\n    }\n\n    #[test]\n    fn test_file_storage_drop_nonexistent() {\n        let temp_dir = std::env::temp_dir().join(\"sqlrustgo_test_drop_nonexistent\");\n        let _ = remove_dir_all(\u0026temp_dir);\n\n        let mut storage = FileStorage::new(temp_dir.clone()).unwrap();\n\n        // Dropping non-existent table should not error\n        let result = storage.drop_table(\"nonexistent\");\n        assert!(result.is_ok());\n        assert!(!storage.contains_table(\"nonexistent\"));\n\n        // Cleanup\n        let _ = remove_dir_all(\u0026temp_dir);\n    }\n\n    #[test]\n    fn test_file_storage_flush() {\n        let temp_dir = std::env::temp_dir().join(\"sqlrustgo_test_flush\");\n        let _ = remove_dir_all(\u0026temp_dir);\n\n        let mut storage = FileStorage::new(temp_dir.clone()).unwrap();\n\n        let table = TableData {\n            info: TableInfo {\n                name: \"flush_test\".to_string(),\n                columns: vec![ColumnDefinition {\n                    name: \"x\".to_string(),\n                    data_type: \"INTEGER\".to_string(),\n                    nullable: false,\n                }],\n            },\n            rows: vec![],\n        };\n        storage\n            .insert_table(\"flush_test\".to_string(), table)\n            .unwrap();\n\n        // Add rows\n        {\n            let table = storage.get_table_mut(\"flush_test\").unwrap();\n            table.rows.push(vec![Value::Integer(42)]);\n        }\n\n        // Flush should persist changes\n        storage.flush().unwrap();\n\n        // Verify flush worked by creating new storage instance\n        let storage2 = FileStorage::new(temp_dir.clone()).unwrap();\n        let table = storage2.get_table(\"flush_test\").unwrap();\n        assert_eq!(table.rows.len(), 1);\n        assert_eq!(table.rows[0], vec![Value::Integer(42)]);\n\n        // Cleanup\n        let _ = remove_dir_all(\u0026temp_dir);\n    }\n\n    #[test]\n    fn test_file_storage_get_mut() {\n        let temp_dir = std::env::temp_dir().join(\"sqlrustgo_test_get_mut\");\n        let _ = remove_dir_all(\u0026temp_dir);\n\n        let mut storage = FileStorage::new(temp_dir.clone()).unwrap();\n\n        let table = TableData {\n            info: TableInfo {\n                name: \"mut_test\".to_string(),\n                columns: vec![ColumnDefinition {\n                    name: \"val\".to_string(),\n                    data_type: \"INTEGER\".to_string(),\n                    nullable: false,\n                }],\n            },\n            rows: vec![vec![Value::Integer(10)]],\n        };\n        storage.insert_table(\"mut_test\".to_string(), table).unwrap();\n\n        // Modify via get_mut\n        {\n            let mut_table = storage.get_table_mut(\"mut_test\").unwrap();\n            mut_table.rows[0] = vec![Value::Integer(99)];\n        }\n        storage.persist_table(\"mut_test\").unwrap();\n\n        // Verify\n        let table = storage.get_table(\"mut_test\").unwrap();\n        assert_eq!(table.rows[0], vec![Value::Integer(99)]);\n\n        // Cleanup\n        let _ = remove_dir_all(\u0026temp_dir);\n    }\n}\n","traces":[{"line":24,"address":[],"length":0,"stats":{"Line":40}},{"line":26,"address":[],"length":0,"stats":{"Line":80}},{"line":30,"address":[],"length":0,"stats":{"Line":40}},{"line":31,"address":[],"length":0,"stats":{"Line":40}},{"line":35,"address":[],"length":0,"stats":{"Line":80}},{"line":38,"address":[],"length":0,"stats":{"Line":80}},{"line":40,"address":[],"length":0,"stats":{"Line":40}},{"line":44,"address":[],"length":0,"stats":{"Line":164}},{"line":45,"address":[],"length":0,"stats":{"Line":328}},{"line":49,"address":[],"length":0,"stats":{"Line":0}},{"line":50,"address":[],"length":0,"stats":{"Line":0}},{"line":54,"address":[],"length":0,"stats":{"Line":40}},{"line":55,"address":[],"length":0,"stats":{"Line":40}},{"line":56,"address":[],"length":0,"stats":{"Line":0}},{"line":59,"address":[],"length":0,"stats":{"Line":169}},{"line":60,"address":[],"length":0,"stats":{"Line":178}},{"line":61,"address":[],"length":0,"stats":{"Line":267}},{"line":63,"address":[],"length":0,"stats":{"Line":445}},{"line":64,"address":[],"length":0,"stats":{"Line":445}},{"line":65,"address":[],"length":0,"stats":{"Line":267}},{"line":67,"address":[],"length":0,"stats":{"Line":356}},{"line":71,"address":[],"length":0,"stats":{"Line":40}},{"line":75,"address":[],"length":0,"stats":{"Line":40}},{"line":76,"address":[],"length":0,"stats":{"Line":40}},{"line":77,"address":[],"length":0,"stats":{"Line":0}},{"line":80,"address":[],"length":0,"stats":{"Line":169}},{"line":81,"address":[],"length":0,"stats":{"Line":178}},{"line":82,"address":[],"length":0,"stats":{"Line":267}},{"line":85,"address":[],"length":0,"stats":{"Line":445}},{"line":86,"address":[],"length":0,"stats":{"Line":356}},{"line":88,"address":[],"length":0,"stats":{"Line":0}},{"line":90,"address":[],"length":0,"stats":{"Line":0}},{"line":92,"address":[],"length":0,"stats":{"Line":0}},{"line":93,"address":[],"length":0,"stats":{"Line":0}},{"line":94,"address":[],"length":0,"stats":{"Line":0}},{"line":95,"address":[],"length":0,"stats":{"Line":0}},{"line":103,"address":[],"length":0,"stats":{"Line":40}},{"line":107,"address":[],"length":0,"stats":{"Line":0}},{"line":108,"address":[],"length":0,"stats":{"Line":0}},{"line":109,"address":[],"length":0,"stats":{"Line":0}},{"line":110,"address":[],"length":0,"stats":{"Line":0}},{"line":111,"address":[],"length":0,"stats":{"Line":0}},{"line":112,"address":[],"length":0,"stats":{"Line":0}},{"line":114,"address":[],"length":0,"stats":{"Line":0}},{"line":118,"address":[],"length":0,"stats":{"Line":0}},{"line":119,"address":[],"length":0,"stats":{"Line":0}},{"line":120,"address":[],"length":0,"stats":{"Line":0}},{"line":121,"address":[],"length":0,"stats":{"Line":0}},{"line":123,"address":[],"length":0,"stats":{"Line":0}},{"line":124,"address":[],"length":0,"stats":{"Line":0}},{"line":126,"address":[],"length":0,"stats":{"Line":0}},{"line":127,"address":[],"length":0,"stats":{"Line":0}},{"line":129,"address":[],"length":0,"stats":{"Line":0}},{"line":133,"address":[],"length":0,"stats":{"Line":89}},{"line":134,"address":[],"length":0,"stats":{"Line":356}},{"line":135,"address":[],"length":0,"stats":{"Line":267}},{"line":136,"address":[],"length":0,"stats":{"Line":267}},{"line":137,"address":[],"length":0,"stats":{"Line":356}},{"line":138,"address":[],"length":0,"stats":{"Line":89}},{"line":140,"address":[],"length":0,"stats":{"Line":89}},{"line":141,"address":[],"length":0,"stats":{"Line":89}},{"line":142,"address":[],"length":0,"stats":{"Line":89}},{"line":143,"address":[],"length":0,"stats":{"Line":89}},{"line":145,"address":[],"length":0,"stats":{"Line":89}},{"line":150,"address":[],"length":0,"stats":{"Line":68}},{"line":151,"address":[],"length":0,"stats":{"Line":272}},{"line":152,"address":[],"length":0,"stats":{"Line":204}},{"line":153,"address":[],"length":0,"stats":{"Line":204}},{"line":156,"address":[],"length":0,"stats":{"Line":204}},{"line":157,"address":[],"length":0,"stats":{"Line":204}},{"line":158,"address":[],"length":0,"stats":{"Line":68}},{"line":161,"address":[],"length":0,"stats":{"Line":204}},{"line":162,"address":[],"length":0,"stats":{"Line":68}},{"line":164,"address":[],"length":0,"stats":{"Line":204}},{"line":165,"address":[],"length":0,"stats":{"Line":136}},{"line":167,"address":[],"length":0,"stats":{"Line":68}},{"line":171,"address":[],"length":0,"stats":{"Line":56}},{"line":172,"address":[],"length":0,"stats":{"Line":168}},{"line":176,"address":[],"length":0,"stats":{"Line":32}},{"line":177,"address":[],"length":0,"stats":{"Line":96}},{"line":181,"address":[],"length":0,"stats":{"Line":36}},{"line":182,"address":[],"length":0,"stats":{"Line":216}},{"line":183,"address":[],"length":0,"stats":{"Line":144}},{"line":187,"address":[],"length":0,"stats":{"Line":7}},{"line":188,"address":[],"length":0,"stats":{"Line":21}},{"line":190,"address":[],"length":0,"stats":{"Line":28}},{"line":191,"address":[],"length":0,"stats":{"Line":7}},{"line":192,"address":[],"length":0,"stats":{"Line":12}},{"line":195,"address":[],"length":0,"stats":{"Line":7}},{"line":199,"address":[],"length":0,"stats":{"Line":2}},{"line":200,"address":[],"length":0,"stats":{"Line":8}},{"line":204,"address":[],"length":0,"stats":{"Line":1}},{"line":205,"address":[],"length":0,"stats":{"Line":3}},{"line":206,"address":[],"length":0,"stats":{"Line":4}},{"line":208,"address":[],"length":0,"stats":{"Line":1}},{"line":212,"address":[],"length":0,"stats":{"Line":37}},{"line":213,"address":[],"length":0,"stats":{"Line":111}},{"line":217,"address":[],"length":0,"stats":{"Line":31}},{"line":218,"address":[],"length":0,"stats":{"Line":93}},{"line":219,"address":[],"length":0,"stats":{"Line":124}},{"line":221,"address":[],"length":0,"stats":{"Line":0}},{"line":228,"address":[],"length":0,"stats":{"Line":29}},{"line":229,"address":[],"length":0,"stats":{"Line":145}},{"line":233,"address":[],"length":0,"stats":{"Line":0}},{"line":234,"address":[],"length":0,"stats":{"Line":0}},{"line":238,"address":[],"length":0,"stats":{"Line":0}},{"line":244,"address":[],"length":0,"stats":{"Line":0}},{"line":245,"address":[],"length":0,"stats":{"Line":0}},{"line":246,"address":[],"length":0,"stats":{"Line":0}},{"line":247,"address":[],"length":0,"stats":{"Line":0}},{"line":250,"address":[],"length":0,"stats":{"Line":0}},{"line":251,"address":[],"length":0,"stats":{"Line":0}},{"line":252,"address":[],"length":0,"stats":{"Line":0}},{"line":253,"address":[],"length":0,"stats":{"Line":0}},{"line":254,"address":[],"length":0,"stats":{"Line":0}},{"line":260,"address":[],"length":0,"stats":{"Line":0}},{"line":263,"address":[],"length":0,"stats":{"Line":0}},{"line":264,"address":[],"length":0,"stats":{"Line":0}},{"line":265,"address":[],"length":0,"stats":{"Line":0}},{"line":268,"address":[],"length":0,"stats":{"Line":0}},{"line":272,"address":[],"length":0,"stats":{"Line":0}},{"line":279,"address":[],"length":0,"stats":{"Line":0}},{"line":282,"address":[],"length":0,"stats":{"Line":0}},{"line":284,"address":[],"length":0,"stats":{"Line":0}},{"line":286,"address":[],"length":0,"stats":{"Line":0}},{"line":287,"address":[],"length":0,"stats":{"Line":0}},{"line":290,"address":[],"length":0,"stats":{"Line":0}},{"line":291,"address":[],"length":0,"stats":{"Line":0}},{"line":295,"address":[],"length":0,"stats":{"Line":0}},{"line":299,"address":[],"length":0,"stats":{"Line":0}},{"line":300,"address":[],"length":0,"stats":{"Line":0}},{"line":301,"address":[],"length":0,"stats":{"Line":0}},{"line":302,"address":[],"length":0,"stats":{"Line":0}},{"line":306,"address":[],"length":0,"stats":{"Line":0}},{"line":313,"address":[],"length":0,"stats":{"Line":0}},{"line":314,"address":[],"length":0,"stats":{"Line":0}},{"line":315,"address":[],"length":0,"stats":{"Line":0}},{"line":320,"address":[],"length":0,"stats":{"Line":0}},{"line":321,"address":[],"length":0,"stats":{"Line":0}},{"line":322,"address":[],"length":0,"stats":{"Line":0}},{"line":324,"address":[],"length":0,"stats":{"Line":0}},{"line":325,"address":[],"length":0,"stats":{"Line":0}},{"line":326,"address":[],"length":0,"stats":{"Line":0}},{"line":329,"address":[],"length":0,"stats":{"Line":0}},{"line":333,"address":[],"length":0,"stats":{"Line":0}},{"line":334,"address":[],"length":0,"stats":{"Line":0}},{"line":335,"address":[],"length":0,"stats":{"Line":0}},{"line":337,"address":[],"length":0,"stats":{"Line":0}}],"covered":76,"coverable":148},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","storage","mod.rs"],"content":"//! Storage Engine Module\n\npub mod bplus_tree;\npub mod buffer_pool;\npub mod file_storage;\npub mod page;\n\npub use bplus_tree::BPlusTree;\npub use buffer_pool::BufferPool;\npub use file_storage::FileStorage;\npub use page::Page;\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","storage","page.rs"],"content":"//! Page management for storage engine\n\n/// Page structure\n#[derive(Debug, Clone)]\npub struct Page {\n    pub page_id: u32,\n    pub data: Vec\u003cu8\u003e,\n}\n\nimpl Page {\n    /// Create a new page\n    pub fn new(page_id: u32) -\u003e Self {\n        Self {\n            page_id,\n            data: vec![0u8; 4096],\n        }\n    }\n\n    /// Get page ID\n    pub fn page_id(\u0026self) -\u003e u32 {\n        self.page_id\n    }\n\n    /// Get page size\n    pub fn size() -\u003e usize {\n        4096\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_page_creation() {\n        let page = Page::new(1);\n        assert_eq!(page.page_id(), 1);\n        assert_eq!(page.data.len(), 4096);\n    }\n\n    #[test]\n    fn test_page_data_access() {\n        let mut page = Page::new(1);\n        // Write some data\n        page.data[0] = 0xAB;\n        page.data[1] = 0xCD;\n        // Read it back\n        assert_eq!(page.data[0], 0xAB);\n        assert_eq!(page.data[1], 0xCD);\n    }\n\n    #[test]\n    fn test_page_default_size() {\n        assert_eq!(Page::size(), 4096);\n    }\n}\n","traces":[{"line":12,"address":[],"length":0,"stats":{"Line":5}},{"line":15,"address":[],"length":0,"stats":{"Line":5}},{"line":20,"address":[],"length":0,"stats":{"Line":6}},{"line":21,"address":[],"length":0,"stats":{"Line":6}},{"line":25,"address":[],"length":0,"stats":{"Line":1}},{"line":26,"address":[],"length":0,"stats":{"Line":1}}],"covered":6,"coverable":6},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","transaction","manager.rs"],"content":"//! Transaction Manager\n//! Handles transaction lifecycle: BEGIN, COMMIT, ROLLBACK\n\nuse super::wal::{WalRecord, WriteAheadLog};\nuse std::collections::HashMap;\nuse std::sync::{Arc, Mutex};\n\n/// Transaction state\n#[derive(Debug, Clone, PartialEq)]\npub enum TxState {\n    Active,\n    Committed,\n    Aborted,\n}\n\n/// Transaction record\n#[derive(Debug)]\npub struct Transaction {\n    pub tx_id: u64,\n    pub state: TxState,\n    pub snapshot: Vec\u003cu64\u003e, // Snapshot of active transactions\n}\n\nimpl Transaction {\n    pub fn new(tx_id: u64) -\u003e Self {\n        Self {\n            tx_id,\n            state: TxState::Active,\n            snapshot: Vec::new(),\n        }\n    }\n}\n\n/// Transaction Manager\npub struct TransactionManager {\n    next_tx_id: Arc\u003cMutex\u003cu64\u003e\u003e,\n    active_transactions: Arc\u003cMutex\u003cHashMap\u003cu64, Transaction\u003e\u003e\u003e,\n    wal: Arc\u003cWriteAheadLog\u003e,\n}\n\nimpl TransactionManager {\n    /// Create a new transaction manager\n    pub fn new(wal: Arc\u003cWriteAheadLog\u003e) -\u003e Self {\n        Self {\n            next_tx_id: Arc::new(Mutex::new(1)),\n            active_transactions: Arc::new(Mutex::new(HashMap::new())),\n            wal,\n        }\n    }\n\n    /// Begin a new transaction\n    pub fn begin(\u0026self) -\u003e Result\u003cu64, String\u003e {\n        let tx_id = {\n            let mut next = self.next_tx_id.lock().unwrap();\n            let id = *next;\n            *next += 1;\n            id\n        };\n\n        // Get snapshot of active transactions\n        let snapshot: Vec\u003cu64\u003e = {\n            let active = self.active_transactions.lock().unwrap();\n            active.keys().cloned().collect()\n        };\n\n        // Create transaction record\n        let mut tx = Transaction::new(tx_id);\n        tx.snapshot = snapshot;\n\n        // Log BEGIN\n        self.wal\n            .append(\u0026WalRecord::Begin { tx_id })\n            .map_err(|e| e.to_string())?;\n\n        // Register transaction\n        self.active_transactions.lock().unwrap().insert(tx_id, tx);\n\n        Ok(tx_id)\n    }\n\n    /// Commit a transaction\n    pub fn commit(\u0026self, tx_id: u64) -\u003e Result\u003c(), String\u003e {\n        let mut active = self.active_transactions.lock().unwrap();\n\n        if let Some(tx) = active.get_mut(\u0026tx_id) {\n            if tx.state != TxState::Active {\n                return Err(\"Transaction not active\".to_string());\n            }\n\n            tx.state = TxState::Committed;\n        } else {\n            return Err(\"Transaction not found\".to_string());\n        }\n\n        // Log COMMIT\n        self.wal\n            .append(\u0026WalRecord::Commit { tx_id })\n            .map_err(|e| e.to_string())?;\n\n        // Remove from active\n        active.remove(\u0026tx_id);\n\n        Ok(())\n    }\n\n    /// Rollback a transaction\n    pub fn rollback(\u0026self, tx_id: u64) -\u003e Result\u003c(), String\u003e {\n        let mut active = self.active_transactions.lock().unwrap();\n\n        if let Some(tx) = active.get_mut(\u0026tx_id) {\n            if tx.state != TxState::Active {\n                return Err(\"Transaction not active\".to_string());\n            }\n\n            tx.state = TxState::Aborted;\n        } else {\n            return Err(\"Transaction not found\".to_string());\n        }\n\n        // Log ROLLBACK\n        self.wal\n            .append(\u0026WalRecord::Rollback { tx_id })\n            .map_err(|e| e.to_string())?;\n\n        // Remove from active\n        active.remove(\u0026tx_id);\n\n        Ok(())\n    }\n\n    /// Get transaction state\n    pub fn get_state(\u0026self, tx_id: u64) -\u003e Option\u003cTxState\u003e {\n        let active = self.active_transactions.lock().unwrap();\n        active.get(\u0026tx_id).map(|tx| tx.state.clone())\n    }\n\n    /// Check if transaction is active\n    pub fn is_active(\u0026self, tx_id: u64) -\u003e bool {\n        self.get_state(tx_id) == Some(TxState::Active)\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_transaction_begin() {\n        let path = \"/tmp/tm_test_begin.log\";\n        std::fs::remove_file(path).ok();\n\n        let wal = Arc::new(WriteAheadLog::new(path).unwrap());\n        let tm = TransactionManager::new(wal);\n\n        let tx_id = tm.begin().unwrap();\n        assert_eq!(tx_id, 1);\n        assert!(tm.is_active(1));\n\n        std::fs::remove_file(path).ok();\n    }\n\n    #[test]\n    fn test_transaction_commit() {\n        let path = \"/tmp/tm_test_commit.log\";\n        std::fs::remove_file(path).ok();\n\n        let wal = Arc::new(WriteAheadLog::new(path).unwrap());\n        let tm = TransactionManager::new(wal);\n\n        let tx_id = tm.begin().unwrap();\n        tm.commit(tx_id).unwrap();\n\n        assert!(!tm.is_active(tx_id));\n\n        std::fs::remove_file(path).ok();\n    }\n\n    #[test]\n    fn test_transaction_rollback() {\n        let path = \"/tmp/tm_test_rollback.log\";\n        std::fs::remove_file(path).ok();\n\n        let wal = Arc::new(WriteAheadLog::new(path).unwrap());\n        let tm = TransactionManager::new(wal);\n\n        let tx_id = tm.begin().unwrap();\n        tm.rollback(tx_id).unwrap();\n\n        assert!(!tm.is_active(tx_id));\n\n        std::fs::remove_file(path).ok();\n    }\n\n    #[test]\n    fn test_transaction_manager() {\n        let path = \"/tmp/test_tx.log\";\n        std::fs::remove_file(path).ok();\n\n        let wal = Arc::new(WriteAheadLog::new(path).unwrap());\n        let tm = TransactionManager::new(wal);\n\n        // Begin transaction\n        let tx_id = tm.begin().unwrap();\n        assert!(tm.is_active(tx_id));\n\n        // Commit\n        tm.commit(tx_id).unwrap();\n        assert!(!tm.is_active(tx_id));\n\n        std::fs::remove_file(path).ok();\n    }\n}\n","traces":[{"line":25,"address":[],"length":0,"stats":{"Line":7}},{"line":29,"address":[],"length":0,"stats":{"Line":7}},{"line":43,"address":[],"length":0,"stats":{"Line":7}},{"line":45,"address":[],"length":0,"stats":{"Line":21}},{"line":46,"address":[],"length":0,"stats":{"Line":21}},{"line":52,"address":[],"length":0,"stats":{"Line":7}},{"line":53,"address":[],"length":0,"stats":{"Line":7}},{"line":54,"address":[],"length":0,"stats":{"Line":21}},{"line":55,"address":[],"length":0,"stats":{"Line":14}},{"line":56,"address":[],"length":0,"stats":{"Line":7}},{"line":57,"address":[],"length":0,"stats":{"Line":7}},{"line":61,"address":[],"length":0,"stats":{"Line":14}},{"line":62,"address":[],"length":0,"stats":{"Line":21}},{"line":63,"address":[],"length":0,"stats":{"Line":21}},{"line":67,"address":[],"length":0,"stats":{"Line":21}},{"line":68,"address":[],"length":0,"stats":{"Line":14}},{"line":71,"address":[],"length":0,"stats":{"Line":14}},{"line":72,"address":[],"length":0,"stats":{"Line":7}},{"line":73,"address":[],"length":0,"stats":{"Line":7}},{"line":76,"address":[],"length":0,"stats":{"Line":21}},{"line":78,"address":[],"length":0,"stats":{"Line":7}},{"line":82,"address":[],"length":0,"stats":{"Line":5}},{"line":83,"address":[],"length":0,"stats":{"Line":15}},{"line":85,"address":[],"length":0,"stats":{"Line":15}},{"line":86,"address":[],"length":0,"stats":{"Line":5}},{"line":87,"address":[],"length":0,"stats":{"Line":0}},{"line":90,"address":[],"length":0,"stats":{"Line":5}},{"line":92,"address":[],"length":0,"stats":{"Line":0}},{"line":96,"address":[],"length":0,"stats":{"Line":10}},{"line":97,"address":[],"length":0,"stats":{"Line":5}},{"line":98,"address":[],"length":0,"stats":{"Line":5}},{"line":101,"address":[],"length":0,"stats":{"Line":10}},{"line":103,"address":[],"length":0,"stats":{"Line":5}},{"line":107,"address":[],"length":0,"stats":{"Line":1}},{"line":108,"address":[],"length":0,"stats":{"Line":3}},{"line":110,"address":[],"length":0,"stats":{"Line":3}},{"line":111,"address":[],"length":0,"stats":{"Line":1}},{"line":112,"address":[],"length":0,"stats":{"Line":0}},{"line":115,"address":[],"length":0,"stats":{"Line":1}},{"line":117,"address":[],"length":0,"stats":{"Line":0}},{"line":121,"address":[],"length":0,"stats":{"Line":2}},{"line":122,"address":[],"length":0,"stats":{"Line":1}},{"line":123,"address":[],"length":0,"stats":{"Line":1}},{"line":126,"address":[],"length":0,"stats":{"Line":2}},{"line":128,"address":[],"length":0,"stats":{"Line":1}},{"line":132,"address":[],"length":0,"stats":{"Line":11}},{"line":133,"address":[],"length":0,"stats":{"Line":33}},{"line":134,"address":[],"length":0,"stats":{"Line":43}},{"line":138,"address":[],"length":0,"stats":{"Line":11}},{"line":139,"address":[],"length":0,"stats":{"Line":22}}],"covered":46,"coverable":50},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","transaction","mod.rs"],"content":"//! Transaction Module\n//!\n//! # What (是什么)\n//! 事务管理模块，提供 ACID 特性保证\n//!\n//! # Why (为什么)\n//! 数据库的核心价值之一是提供事务支持，确保数据一致性\n//! 即使发生系统崩溃，也不会导致数据损坏\n//!\n//! # How (如何实现)\n//! - WAL (Write-Ahead Log)：先写日志再写数据\n//! - 事务状态机：Active -\u003e Committed / Aborted\n//! - Commit：持久化日志\n//! - Rollback：逆向操作\n\npub mod manager;\npub mod wal;\n\npub use manager::{Transaction, TransactionManager, TxState};\npub use wal::{WalRecord, WriteAheadLog};\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","transaction","wal.rs"],"content":"//! Write-Ahead Log (WAL) for transaction management\n//! Simple JSON-based logging for durability\n\nuse serde::{Deserialize, Serialize};\nuse std::fs::{File, OpenOptions};\nuse std::io::{Read, Seek, SeekFrom, Write};\nuse std::sync::Mutex;\n\n/// WAL record types\n#[derive(Debug, Clone, Serialize, Deserialize)]\npub enum WalRecord {\n    Begin { tx_id: u64 },\n    Commit { tx_id: u64 },\n    Rollback { tx_id: u64 },\n}\n\n/// Write-Ahead Log\n#[allow(dead_code)]\npub struct WriteAheadLog {\n    file: Mutex\u003cFile\u003e,\n    path: String,\n}\n\nimpl WriteAheadLog {\n    /// Create or open WAL\n    pub fn new(path: \u0026str) -\u003e Result\u003cSelf, std::io::Error\u003e {\n        #[allow(clippy::suspicious_open_options)]\n        let file = OpenOptions::new()\n            .read(true)\n            .write(true)\n            .create(true)\n            .truncate(true)\n            .open(path)?;\n\n        Ok(Self {\n            file: Mutex::new(file),\n            path: path.to_string(),\n        })\n    }\n\n    /// Append a record to the log\n    pub fn append(\u0026self, record: \u0026WalRecord) -\u003e Result\u003c(), std::io::Error\u003e {\n        let mut file = self.file.lock().unwrap();\n\n        // Serialize to JSON\n        let json = serde_json::to_string(record)\n            .map_err(|_| std::io::Error::other(\"serialization failed\"))?;\n\n        // Write length prefix + newline\n        let len_bytes = (json.len() as u32).to_le_bytes();\n        file.write_all(\u0026len_bytes)?;\n        file.write_all(json.as_bytes())?;\n        file.write_all(b\"\\n\")?;\n        file.flush()?;\n\n        Ok(())\n    }\n\n    /// Read all records from log\n    pub fn read_all(\u0026self) -\u003e Result\u003cVec\u003cWalRecord\u003e, std::io::Error\u003e {\n        let mut file = self.file.lock().unwrap();\n        let mut records = Vec::new();\n\n        // Seek to start\n        if file.seek(SeekFrom::Start(0)).is_err() {\n            return Ok(records);\n        }\n\n        loop {\n            let mut len_buf = [0u8; 4];\n            match file.read_exact(\u0026mut len_buf) {\n                Ok(()) =\u003e {}\n                Err(_) =\u003e break, // EOF\n            }\n\n            let len = u32::from_le_bytes(len_buf) as usize;\n            let mut data = vec![0u8; len];\n            if file.read_exact(\u0026mut data).is_err() {\n                break;\n            }\n\n            // Read newline\n            let mut newline = [0u8; 1];\n            let _ = file.read(\u0026mut newline);\n\n            if let Ok(record) = serde_json::from_slice(\u0026data) {\n                records.push(record);\n            }\n        }\n\n        Ok(records)\n    }\n\n    /// Truncate log (after successful checkpoint)\n    pub fn truncate(\u0026self) -\u003e Result\u003c(), std::io::Error\u003e {\n        let mut file = self.file.lock().unwrap();\n        file.set_len(0)?;\n        file.seek(SeekFrom::Start(0))?;\n        Ok(())\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_wal_append() {\n        let path = \"/tmp/wal_test_append.log\";\n        std::fs::remove_file(path).ok();\n\n        let wal = WriteAheadLog::new(path).unwrap();\n        let record = WalRecord::Begin { tx_id: 1 };\n        wal.append(\u0026record).unwrap();\n\n        let records = wal.read_all().unwrap();\n        assert_eq!(records.len(), 1);\n\n        std::fs::remove_file(path).ok();\n    }\n\n    #[test]\n    fn test_wal_commit() {\n        let path = \"/tmp/wal_test_commit.log\";\n        std::fs::remove_file(path).ok();\n\n        let wal = WriteAheadLog::new(path).unwrap();\n\n        wal.append(\u0026WalRecord::Begin { tx_id: 1 }).unwrap();\n        wal.append(\u0026WalRecord::Commit { tx_id: 1 }).unwrap();\n\n        let records = wal.read_all().unwrap();\n        assert_eq!(records.len(), 2);\n\n        std::fs::remove_file(path).ok();\n    }\n\n    #[test]\n    fn test_wal_basic_write() {\n        let path = \"/tmp/test_wal.log\";\n        std::fs::remove_file(path).ok();\n\n        let wal = WriteAheadLog::new(path).unwrap();\n        wal.append(\u0026WalRecord::Begin { tx_id: 1 }).unwrap();\n        wal.append(\u0026WalRecord::Commit { tx_id: 1 }).unwrap();\n\n        let records = wal.read_all().unwrap();\n        assert_eq!(records.len(), 2);\n\n        std::fs::remove_file(path).ok();\n    }\n}\n","traces":[{"line":26,"address":[],"length":0,"stats":{"Line":10}},{"line":28,"address":[],"length":0,"stats":{"Line":20}},{"line":33,"address":[],"length":0,"stats":{"Line":20}},{"line":35,"address":[],"length":0,"stats":{"Line":10}},{"line":36,"address":[],"length":0,"stats":{"Line":30}},{"line":37,"address":[],"length":0,"stats":{"Line":10}},{"line":42,"address":[],"length":0,"stats":{"Line":18}},{"line":43,"address":[],"length":0,"stats":{"Line":72}},{"line":46,"address":[],"length":0,"stats":{"Line":54}},{"line":47,"address":[],"length":0,"stats":{"Line":18}},{"line":50,"address":[],"length":0,"stats":{"Line":54}},{"line":51,"address":[],"length":0,"stats":{"Line":36}},{"line":52,"address":[],"length":0,"stats":{"Line":54}},{"line":53,"address":[],"length":0,"stats":{"Line":36}},{"line":54,"address":[],"length":0,"stats":{"Line":18}},{"line":56,"address":[],"length":0,"stats":{"Line":18}},{"line":60,"address":[],"length":0,"stats":{"Line":3}},{"line":61,"address":[],"length":0,"stats":{"Line":12}},{"line":62,"address":[],"length":0,"stats":{"Line":6}},{"line":65,"address":[],"length":0,"stats":{"Line":9}},{"line":66,"address":[],"length":0,"stats":{"Line":0}},{"line":70,"address":[],"length":0,"stats":{"Line":16}},{"line":71,"address":[],"length":0,"stats":{"Line":16}},{"line":72,"address":[],"length":0,"stats":{"Line":5}},{"line":73,"address":[],"length":0,"stats":{"Line":3}},{"line":76,"address":[],"length":0,"stats":{"Line":10}},{"line":77,"address":[],"length":0,"stats":{"Line":15}},{"line":78,"address":[],"length":0,"stats":{"Line":15}},{"line":79,"address":[],"length":0,"stats":{"Line":0}},{"line":83,"address":[],"length":0,"stats":{"Line":10}},{"line":84,"address":[],"length":0,"stats":{"Line":10}},{"line":86,"address":[],"length":0,"stats":{"Line":15}},{"line":87,"address":[],"length":0,"stats":{"Line":10}},{"line":91,"address":[],"length":0,"stats":{"Line":3}},{"line":95,"address":[],"length":0,"stats":{"Line":0}},{"line":96,"address":[],"length":0,"stats":{"Line":0}},{"line":97,"address":[],"length":0,"stats":{"Line":0}},{"line":98,"address":[],"length":0,"stats":{"Line":0}},{"line":99,"address":[],"length":0,"stats":{"Line":0}}],"covered":32,"coverable":39},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","types","error.rs"],"content":"//! SQL Error types\n//! Error handling for SQLRustGo database system\n//!\n//! # What (是什么)\n//! 本模块定义了 SQLRustGo 数据库的错误类型系统，包括 SqlError 枚举和 SqlResult 类型。\n//!\n//! # Why (为什么)\n//! 统一的错误处理是数据库系统的核心需求。通过定义标准化的错误类型，\n//! 可以让调用者清楚地知道发生了什么错误，并采取相应的恢复措施。\n//!\n//! # How (如何实现)\n//! - SqlError: 使用枚举变体表示不同类型的错误（解析错误、执行错误、存储错误等）\n//! - SqlResult: 是 Result 类型的别名，简化错误传播\n//! - SqlError 实现 Display trait 以便人类可读的错误信息\n\n/// SQL Error enum representing all possible error types\n///\n/// # 常见错误类型说明\n///\n/// - **ParseError**: SQL 语法错误，例如拼写错误、缺少关键字等\n/// - **ExecutionError**: 查询执行过程中的错误，例如除零运算、无效操作等\n/// - **TypeMismatch**: 数据类型不匹配，例如对字符串进行数值运算\n/// - **TableNotFound**: 引用的表不存在\n/// - **ColumnNotFound**: 引用的列不存在\n#[derive(thiserror::Error, Debug)]\npub enum SqlError {\n    /// Syntax error during parsing\n    /// 发生场景：用户输入的 SQL 语句不符合 SQL 语法规范\n    /// 示例：SELECT * FORM users (FORM 是拼写错误，应该是 FROM)\n    #[error(\"Parse error: {0}\")]\n    ParseError(String),\n\n    /// Execution error during query processing\n    /// 发生场景：SQL 语法正确，但在执行时出现错误\n    /// 示例：UPDATE non_existent_table SET col = 1\n    #[error(\"Execution error: {0}\")]\n    ExecutionError(String),\n\n    /// Type mismatch error\n    /// 发生场景：操作符两边的数据类型不兼容\n    /// 示例：SELECT 'string' + 1 (字符串不能与数字相加)\n    #[error(\"Type mismatch: {0}\")]\n    TypeMismatch(String),\n\n    /// Division by zero\n    /// 发生场景：进行除法运算时除数为零\n    /// 示例：SELECT 10 / 0\n    #[error(\"Division by zero\")]\n    DivisionByZero,\n\n    /// Null value error (operation on NULL)\n    /// 发生场景：对 NULL 值进行了不支持的操作\n    /// 示例：在 NOT NULL 约束的列中插入 NULL\n    #[error(\"Null value error: {0}\")]\n    NullValueError(String),\n\n    /// Constraint violation\n    /// 发生场景：违反了表定义的约束条件\n    /// 示例：外键引用不存在的主键、CHECK 约束失败等\n    #[error(\"Constraint violation: {0}\")]\n    ConstraintViolation(String),\n\n    /// Table not found\n    /// 发生场景：SQL 语句引用了不存在的表\n    /// 示例：SELECT * FROM non_existent_table\n    #[error(\"Table not found: {0}\")]\n    TableNotFound(String),\n\n    /// Column not found\n    /// 发生场景：SQL 语句引用了表中不存在的列\n    /// 示例：SELECT non_existent_column FROM users\n    #[error(\"Column not found: {0}\")]\n    ColumnNotFound(String),\n\n    /// Duplicate key error\n    /// 发生场景：插入或更新数据时，违反了唯一键约束\n    /// 示例：INSERT INTO users (id) VALUES (1) -- 假设 id 已经是 1\n    #[error(\"Duplicate key: {0}\")]\n    DuplicateKey(String),\n\n    /// I/O error\n    /// 发生场景：磁盘读写、文件操作等 I/O 失败\n    /// 示例：数据库文件损坏、磁盘空间不足等\n    #[error(\"I/O error: {0}\")]\n    IoError(String),\n\n    /// Network protocol error\n    #[error(\"Protocol error: {0}\")]\n    ProtocolError(String),\n}\n\n/// Result type alias for SQL operations\npub type SqlResult\u003cT\u003e = Result\u003cT, SqlError\u003e;\n\nimpl From\u003cString\u003e for SqlError {\n    fn from(s: String) -\u003e Self {\n        SqlError::ExecutionError(s)\n    }\n}\n\nimpl From\u003c\u0026str\u003e for SqlError {\n    fn from(s: \u0026str) -\u003e Self {\n        SqlError::ExecutionError(s.to_string())\n    }\n}\n\nimpl From\u003cstd::io::Error\u003e for SqlError {\n    fn from(e: std::io::Error) -\u003e Self {\n        SqlError::IoError(e.to_string())\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use std::io;\n\n    #[test]\n    fn test_error_messages() {\n        let err = SqlError::ParseError(\"invalid syntax\".to_string());\n        assert!(err.to_string().contains(\"Parse error\"));\n\n        let err = SqlError::TableNotFound(\"users\".to_string());\n        assert!(err.to_string().contains(\"Table not found\"));\n    }\n\n    #[test]\n    fn test_execution_error() {\n        let err = SqlError::ExecutionError(\"invalid operation\".to_string());\n        assert!(err.to_string().contains(\"Execution error\"));\n        assert!(err.to_string().contains(\"invalid operation\"));\n    }\n\n    #[test]\n    fn test_type_mismatch() {\n        let err = SqlError::TypeMismatch(\"cannot add string and number\".to_string());\n        assert!(err.to_string().contains(\"Type mismatch\"));\n        assert!(err.to_string().contains(\"cannot add string and number\"));\n    }\n\n    #[test]\n    fn test_division_by_zero() {\n        let err = SqlError::DivisionByZero;\n        assert!(err.to_string().contains(\"Division by zero\"));\n    }\n\n    #[test]\n    fn test_null_value_error() {\n        let err = SqlError::NullValueError(\"column cannot be null\".to_string());\n        assert!(err.to_string().contains(\"Null value error\"));\n        assert!(err.to_string().contains(\"column cannot be null\"));\n    }\n\n    #[test]\n    fn test_constraint_violation() {\n        let err = SqlError::ConstraintViolation(\"unique constraint failed\".to_string());\n        assert!(err.to_string().contains(\"Constraint violation\"));\n        assert!(err.to_string().contains(\"unique constraint failed\"));\n    }\n\n    #[test]\n    fn test_column_not_found() {\n        let err = SqlError::ColumnNotFound(\"age\".to_string());\n        assert!(err.to_string().contains(\"Column not found\"));\n        assert!(err.to_string().contains(\"age\"));\n    }\n\n    #[test]\n    fn test_duplicate_key() {\n        let err = SqlError::DuplicateKey(\"id=1\".to_string());\n        assert!(err.to_string().contains(\"Duplicate key\"));\n        assert!(err.to_string().contains(\"id=1\"));\n    }\n\n    #[test]\n    fn test_io_error() {\n        let err = SqlError::IoError(\"file not found\".to_string());\n        assert!(err.to_string().contains(\"I/O error\"));\n        assert!(err.to_string().contains(\"file not found\"));\n    }\n\n    #[test]\n    fn test_from_string() {\n        let err: SqlError = String::from(\"test error\").into();\n        assert!(matches!(err, SqlError::ExecutionError(_)));\n    }\n\n    #[test]\n    fn test_from_str() {\n        let err: SqlError = \"test error\".into();\n        assert!(matches!(err, SqlError::ExecutionError(_)));\n    }\n\n    #[test]\n    fn test_from_io_error() {\n        let io_err = io::Error::new(io::ErrorKind::NotFound, \"file not found\");\n        let err: SqlError = io_err.into();\n        assert!(matches!(err, SqlError::IoError(_)));\n    }\n\n    #[test]\n    fn test_error_debug() {\n        let err = SqlError::ParseError(\"test\".to_string());\n        let debug_str = format!(\"{:?}\", err);\n        assert!(debug_str.contains(\"ParseError\"));\n    }\n\n    #[test]\n    fn test_sql_result_alias() {\n        fn return_result() -\u003e SqlResult\u003ci32\u003e {\n            Ok(42)\n        }\n        fn return_error() -\u003e SqlResult\u003ci32\u003e {\n            Err(SqlError::TableNotFound(\"test\".to_string()))\n        }\n\n        assert_eq!(return_result().unwrap(), 42);\n        assert!(return_error().is_err());\n    }\n}\n","traces":[{"line":96,"address":[],"length":0,"stats":{"Line":1}},{"line":97,"address":[],"length":0,"stats":{"Line":1}},{"line":102,"address":[],"length":0,"stats":{"Line":1}},{"line":103,"address":[],"length":0,"stats":{"Line":1}},{"line":108,"address":[],"length":0,"stats":{"Line":1}},{"line":109,"address":[],"length":0,"stats":{"Line":1}}],"covered":6,"coverable":6},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","types","mod.rs"],"content":"//! Core Type System Module\n//!\n//! This module defines the fundamental types and errors for SQLRustGo.\n//! All SQL data types and error handling are centralized here.\n\npub mod error;\npub mod value;\n\npub use error::{SqlError, SqlResult};\npub use value::Value;\n\n/// Convert a SQL literal string to Value\n/// Supports: NULL, TRUE, FALSE, numbers, strings\npub fn parse_sql_literal(s: \u0026str) -\u003e Value {\n    let s = s.trim();\n\n    match s.to_uppercase().as_str() {\n        \"NULL\" =\u003e Value::Null,\n        \"TRUE\" =\u003e Value::Boolean(true),\n        \"FALSE\" =\u003e Value::Boolean(false),\n        _ if s.starts_with('\\'') \u0026\u0026 s.ends_with('\\'') =\u003e Value::Text(s[1..s.len() - 1].to_string()),\n        _ if s.parse::\u003ci64\u003e().is_ok() =\u003e Value::Integer(s.parse().unwrap()),\n        _ if s.parse::\u003cf64\u003e().is_ok() =\u003e Value::Float(s.parse().unwrap()),\n        _ =\u003e Value::Text(s.to_string()),\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_parse_sql_literal() {\n        assert_eq!(parse_sql_literal(\"NULL\"), Value::Null);\n        assert_eq!(parse_sql_literal(\"TRUE\"), Value::Boolean(true));\n        assert_eq!(parse_sql_literal(\"FALSE\"), Value::Boolean(false));\n        assert_eq!(parse_sql_literal(\"42\"), Value::Integer(42));\n        assert_eq!(parse_sql_literal(\"3.14\"), Value::Float(3.14));\n        assert_eq!(\n            parse_sql_literal(\"'hello'\"),\n            Value::Text(\"hello\".to_string())\n        );\n    }\n}\n","traces":[{"line":14,"address":[],"length":0,"stats":{"Line":62}},{"line":15,"address":[],"length":0,"stats":{"Line":186}},{"line":17,"address":[],"length":0,"stats":{"Line":124}},{"line":18,"address":[],"length":0,"stats":{"Line":65}},{"line":19,"address":[],"length":0,"stats":{"Line":60}},{"line":20,"address":[],"length":0,"stats":{"Line":59}},{"line":21,"address":[],"length":0,"stats":{"Line":189}},{"line":22,"address":[],"length":0,"stats":{"Line":201}},{"line":23,"address":[],"length":0,"stats":{"Line":15}},{"line":24,"address":[],"length":0,"stats":{"Line":0}}],"covered":9,"coverable":10},{"path":["/","Users","gaoxiaoyao","workspace","openheart","sqlrustgo","src","types","value.rs"],"content":"//! SQL Value types\n//! Core data types for SQLRustGo database system\n\nuse serde::{Deserialize, Serialize};\nuse std::fmt;\n\n/// SQL Value enum representing all supported SQL data types\n///\n/// # What (是什么)\n/// Value 是 SQL 数据的运行时表示，支持 NULL、布尔、整数、浮点、文本和二进制类型\n/// 这些是 SQL-92 标准中最常用的数据类型，涵盖了绝大多数业务场景的需求\n///\n/// # Why (为什么)\n/// SQL 标准定义了多种数据类型，数据库需要在内部统一表示这些类型：\n/// - 为 SQL 语句的执行结果提供标准化的数据结构\n/// - 支持类型检查和类型转换\n/// - 便于数据的序列化和持久化存储\n/// - 实现跨平台的数据交换（通过 serde）\n///\n/// # How (如何实现)\n/// - 使用 Rust 枚举表示 SQL 类型，每种变体对应一种 SQL 类型\n/// - 实现 Display trait 用于 SQL 输出格式（与 to_string() 保持一致）\n/// - 使用 serde 进行序列化/反序列化（支持持久化和网络传输）\n/// - 通过 type_name() 方法提供运行时类型信息\n#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]\npub enum Value {\n    /// NULL value - represents missing or unknown data\n    /// Example: INSERT INTO t VALUES (NULL)\n    Null,\n\n    /// Boolean - TRUE/FALSE values for logical operations\n    /// Example: WHERE active = true\n    Boolean(bool),\n\n    /// 64-bit signed integer - whole numbers in range [-2^63, 2^63-1]\n    /// Example: age = 25, quantity = 1000\n    Integer(i64),\n\n    /// 64-bit floating point - decimal numbers with double precision\n    /// Example: price = 19.99, ratio = 0.5\n    Float(f64),\n\n    /// Text string - variable-length Unicode text\n    /// Example: name = 'John', email = 'user@example.com'\n    Text(String),\n\n    /// Binary large object - arbitrary binary data\n    /// Example: image_data, file_content\n    Blob(Vec\u003cu8\u003e),\n}\n\nimpl Value {\n    /// Get integer value if this is an Integer\n    pub fn as_integer(\u0026self) -\u003e Option\u003ci64\u003e {\n        match self {\n            Value::Integer(i) =\u003e Some(*i),\n            _ =\u003e None,\n        }\n    }\n\n    /// Convert Value to SQL string representation\n    ///\n    /// # What\n    /// 将 Value 转换为标准的 SQL 字符串格式，用于：\n    /// - SQL 查询结果的显示输出\n    /// - SQL 语句的拼接和生成\n    ///\n    /// # Why\n    /// SQL 有其独特的字符串表示规范，需要特殊处理：\n    /// - NULL 显示为 \"NULL\"（非空字符串）\n    /// - Blob 显示为十六进制格式 X'...'\n    /// - 文本直接输出，不加引号（与 PostgreSQL 的 \\x 格式类似）\n    ///\n    /// # How\n    /// - 使用 match 遍历所有 Value 变体\n    /// - 对于 Blob，使用 hex::encode 转换为十六进制字符串\n    /// - 此方法通过 Display trait 实现，调用 to_string() 会自动使用 Display\n    #[allow(clippy::inherent_to_string_shadow_display)]\n    pub fn to_string(\u0026self) -\u003e String {\n        match self {\n            Value::Null =\u003e \"NULL\".to_string(),\n            Value::Boolean(b) =\u003e b.to_string(),\n            Value::Integer(i) =\u003e i.to_string(),\n            Value::Float(f) =\u003e f.to_string(),\n            Value::Text(s) =\u003e s.clone(),\n            Value::Blob(b) =\u003e format!(\"X'{}'\", hex::encode(b)),\n        }\n    }\n\n    /// Get the SQL type name as a string literal\n    ///\n    /// # What\n    /// 返回 Value 对应的 SQL 类型名称\n    ///\n    /// # Why\n    /// 在运行时需要知道 Value 的具体类型：\n    /// - 用于错误消息的生成（如类型不匹配错误）\n    /// - 用于元数据查询和 SHOW 命令\n    /// - 用于类型推断和类型转换\n    ///\n    /// # How\n    /// - 返回静态字符串字面量，避免运行时内存分配\n    /// - 使用 match 遍历所有变体\n    /// - 对于多态类型（如 Integer、Boolean），统一返回类型名称\n    pub fn type_name(\u0026self) -\u003e \u0026'static str {\n        match self {\n            Value::Null =\u003e \"NULL\",\n            Value::Boolean(_) =\u003e \"BOOLEAN\",\n            Value::Integer(_) =\u003e \"INTEGER\",\n            Value::Float(_) =\u003e \"FLOAT\",\n            Value::Text(_) =\u003e \"TEXT\",\n            Value::Blob(_) =\u003e \"BLOB\",\n        }\n    }\n}\n\nimpl fmt::Display for Value {\n    fn fmt(\u0026self, f: \u0026mut fmt::Formatter\u003c'_\u003e) -\u003e fmt::Result {\n        match self {\n            Value::Null =\u003e write!(f, \"NULL\"),\n            Value::Boolean(b) =\u003e write!(f, \"{}\", b),\n            Value::Integer(i) =\u003e write!(f, \"{}\", i),\n            Value::Float(fl) =\u003e write!(f, \"{}\", fl),\n            Value::Text(s) =\u003e write!(f, \"{}\", s),\n            Value::Blob(b) =\u003e write!(f, \"X'{}'\", hex::encode(b)),\n        }\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_value_to_string() {\n        assert_eq!(Value::Null.to_string(), \"NULL\");\n        assert_eq!(Value::Boolean(true).to_string(), \"true\");\n        assert_eq!(Value::Integer(42).to_string(), \"42\");\n        assert_eq!(Value::Float(3.14).to_string(), \"3.14\");\n        assert_eq!(Value::Text(\"hello\".to_string()).to_string(), \"hello\");\n    }\n\n    #[test]\n    fn test_value_type_name() {\n        assert_eq!(Value::Null.type_name(), \"NULL\");\n        assert_eq!(Value::Boolean(true).type_name(), \"BOOLEAN\");\n        assert_eq!(Value::Integer(1).type_name(), \"INTEGER\");\n        assert_eq!(Value::Float(1.0).type_name(), \"FLOAT\");\n        assert_eq!(Value::Text(\"test\".to_string()).type_name(), \"TEXT\");\n        assert_eq!(Value::Blob(vec![0x01, 0x02]).type_name(), \"BLOB\");\n    }\n}\n","traces":[{"line":54,"address":[],"length":0,"stats":{"Line":1}},{"line":55,"address":[],"length":0,"stats":{"Line":1}},{"line":56,"address":[],"length":0,"stats":{"Line":2}},{"line":57,"address":[],"length":0,"stats":{"Line":0}},{"line":79,"address":[],"length":0,"stats":{"Line":6}},{"line":80,"address":[],"length":0,"stats":{"Line":6}},{"line":81,"address":[],"length":0,"stats":{"Line":2}},{"line":82,"address":[],"length":0,"stats":{"Line":3}},{"line":83,"address":[],"length":0,"stats":{"Line":6}},{"line":84,"address":[],"length":0,"stats":{"Line":3}},{"line":85,"address":[],"length":0,"stats":{"Line":3}},{"line":86,"address":[],"length":0,"stats":{"Line":0}},{"line":105,"address":[],"length":0,"stats":{"Line":6}},{"line":106,"address":[],"length":0,"stats":{"Line":6}},{"line":107,"address":[],"length":0,"stats":{"Line":1}},{"line":108,"address":[],"length":0,"stats":{"Line":1}},{"line":109,"address":[],"length":0,"stats":{"Line":1}},{"line":110,"address":[],"length":0,"stats":{"Line":1}},{"line":111,"address":[],"length":0,"stats":{"Line":1}},{"line":112,"address":[],"length":0,"stats":{"Line":1}},{"line":118,"address":[],"length":0,"stats":{"Line":0}},{"line":119,"address":[],"length":0,"stats":{"Line":0}},{"line":120,"address":[],"length":0,"stats":{"Line":0}},{"line":121,"address":[],"length":0,"stats":{"Line":0}},{"line":122,"address":[],"length":0,"stats":{"Line":0}},{"line":123,"address":[],"length":0,"stats":{"Line":0}},{"line":124,"address":[],"length":0,"stats":{"Line":0}},{"line":125,"address":[],"length":0,"stats":{"Line":0}}],"covered":18,"coverable":28}]};
        var previousData = null;
    </script>
    <script crossorigin>/** @license React v16.13.1
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
'use strict';(function(d,r){"object"===typeof exports&&"undefined"!==typeof module?r(exports):"function"===typeof define&&define.amd?define(["exports"],r):(d=d||self,r(d.React={}))})(this,function(d){function r(a){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+a,c=1;c<arguments.length;c++)b+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+a+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}
function w(a,b,c){this.props=a;this.context=b;this.refs=ba;this.updater=c||ca}function da(){}function L(a,b,c){this.props=a;this.context=b;this.refs=ba;this.updater=c||ca}function ea(a,b,c){var g,e={},fa=null,d=null;if(null!=b)for(g in void 0!==b.ref&&(d=b.ref),void 0!==b.key&&(fa=""+b.key),b)ha.call(b,g)&&!ia.hasOwnProperty(g)&&(e[g]=b[g]);var h=arguments.length-2;if(1===h)e.children=c;else if(1<h){for(var k=Array(h),f=0;f<h;f++)k[f]=arguments[f+2];e.children=k}if(a&&a.defaultProps)for(g in h=a.defaultProps,
h)void 0===e[g]&&(e[g]=h[g]);return{$$typeof:x,type:a,key:fa,ref:d,props:e,_owner:M.current}}function va(a,b){return{$$typeof:x,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function N(a){return"object"===typeof a&&null!==a&&a.$$typeof===x}function wa(a){var b={"=":"=0",":":"=2"};return"$"+(""+a).replace(/[=:]/g,function(a){return b[a]})}function ja(a,b,c,g){if(C.length){var e=C.pop();e.result=a;e.keyPrefix=b;e.func=c;e.context=g;e.count=0;return e}return{result:a,keyPrefix:b,func:c,
context:g,count:0}}function ka(a){a.result=null;a.keyPrefix=null;a.func=null;a.context=null;a.count=0;10>C.length&&C.push(a)}function O(a,b,c,g){var e=typeof a;if("undefined"===e||"boolean"===e)a=null;var d=!1;if(null===a)d=!0;else switch(e){case "string":case "number":d=!0;break;case "object":switch(a.$$typeof){case x:case xa:d=!0}}if(d)return c(g,a,""===b?"."+P(a,0):b),1;d=0;b=""===b?".":b+":";if(Array.isArray(a))for(var f=0;f<a.length;f++){e=a[f];var h=b+P(e,f);d+=O(e,h,c,g)}else if(null===a||
"object"!==typeof a?h=null:(h=la&&a[la]||a["@@iterator"],h="function"===typeof h?h:null),"function"===typeof h)for(a=h.call(a),f=0;!(e=a.next()).done;)e=e.value,h=b+P(e,f++),d+=O(e,h,c,g);else if("object"===e)throw c=""+a,Error(r(31,"[object Object]"===c?"object with keys {"+Object.keys(a).join(", ")+"}":c,""));return d}function Q(a,b,c){return null==a?0:O(a,"",b,c)}function P(a,b){return"object"===typeof a&&null!==a&&null!=a.key?wa(a.key):b.toString(36)}function ya(a,b,c){a.func.call(a.context,b,
a.count++)}function za(a,b,c){var g=a.result,e=a.keyPrefix;a=a.func.call(a.context,b,a.count++);Array.isArray(a)?R(a,g,c,function(a){return a}):null!=a&&(N(a)&&(a=va(a,e+(!a.key||b&&b.key===a.key?"":(""+a.key).replace(ma,"$&/")+"/")+c)),g.push(a))}function R(a,b,c,g,e){var d="";null!=c&&(d=(""+c).replace(ma,"$&/")+"/");b=ja(b,d,g,e);Q(a,za,b);ka(b)}function t(){var a=na.current;if(null===a)throw Error(r(321));return a}function S(a,b){var c=a.length;a.push(b);a:for(;;){var g=c-1>>>1,e=a[g];if(void 0!==
e&&0<D(e,b))a[g]=b,a[c]=e,c=g;else break a}}function n(a){a=a[0];return void 0===a?null:a}function E(a){var b=a[0];if(void 0!==b){var c=a.pop();if(c!==b){a[0]=c;a:for(var g=0,e=a.length;g<e;){var d=2*(g+1)-1,f=a[d],h=d+1,k=a[h];if(void 0!==f&&0>D(f,c))void 0!==k&&0>D(k,f)?(a[g]=k,a[h]=c,g=h):(a[g]=f,a[d]=c,g=d);else if(void 0!==k&&0>D(k,c))a[g]=k,a[h]=c,g=h;else break a}}return b}return null}function D(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}function F(a){for(var b=n(u);null!==
b;){if(null===b.callback)E(u);else if(b.startTime<=a)E(u),b.sortIndex=b.expirationTime,S(p,b);else break;b=n(u)}}function T(a){y=!1;F(a);if(!v)if(null!==n(p))v=!0,z(U);else{var b=n(u);null!==b&&G(T,b.startTime-a)}}function U(a,b){v=!1;y&&(y=!1,V());H=!0;var c=m;try{F(b);for(l=n(p);null!==l&&(!(l.expirationTime>b)||a&&!W());){var g=l.callback;if(null!==g){l.callback=null;m=l.priorityLevel;var e=g(l.expirationTime<=b);b=q();"function"===typeof e?l.callback=e:l===n(p)&&E(p);F(b)}else E(p);l=n(p)}if(null!==
l)var d=!0;else{var f=n(u);null!==f&&G(T,f.startTime-b);d=!1}return d}finally{l=null,m=c,H=!1}}function oa(a){switch(a){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1E4;default:return 5E3}}var f="function"===typeof Symbol&&Symbol.for,x=f?Symbol.for("react.element"):60103,xa=f?Symbol.for("react.portal"):60106,Aa=f?Symbol.for("react.fragment"):60107,Ba=f?Symbol.for("react.strict_mode"):60108,Ca=f?Symbol.for("react.profiler"):60114,Da=f?Symbol.for("react.provider"):60109,
Ea=f?Symbol.for("react.context"):60110,Fa=f?Symbol.for("react.forward_ref"):60112,Ga=f?Symbol.for("react.suspense"):60113,Ha=f?Symbol.for("react.memo"):60115,Ia=f?Symbol.for("react.lazy"):60116,la="function"===typeof Symbol&&Symbol.iterator,pa=Object.getOwnPropertySymbols,Ja=Object.prototype.hasOwnProperty,Ka=Object.prototype.propertyIsEnumerable,I=function(){try{if(!Object.assign)return!1;var a=new String("abc");a[5]="de";if("5"===Object.getOwnPropertyNames(a)[0])return!1;var b={};for(a=0;10>a;a++)b["_"+
String.fromCharCode(a)]=a;if("0123456789"!==Object.getOwnPropertyNames(b).map(function(a){return b[a]}).join(""))return!1;var c={};"abcdefghijklmnopqrst".split("").forEach(function(a){c[a]=a});return"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},c)).join("")?!1:!0}catch(g){return!1}}()?Object.assign:function(a,b){if(null===a||void 0===a)throw new TypeError("Object.assign cannot be called with null or undefined");var c=Object(a);for(var g,e=1;e<arguments.length;e++){var d=Object(arguments[e]);
for(var f in d)Ja.call(d,f)&&(c[f]=d[f]);if(pa){g=pa(d);for(var h=0;h<g.length;h++)Ka.call(d,g[h])&&(c[g[h]]=d[g[h]])}}return c},ca={isMounted:function(a){return!1},enqueueForceUpdate:function(a,b,c){},enqueueReplaceState:function(a,b,c,d){},enqueueSetState:function(a,b,c,d){}},ba={};w.prototype.isReactComponent={};w.prototype.setState=function(a,b){if("object"!==typeof a&&"function"!==typeof a&&null!=a)throw Error(r(85));this.updater.enqueueSetState(this,a,b,"setState")};w.prototype.forceUpdate=
function(a){this.updater.enqueueForceUpdate(this,a,"forceUpdate")};da.prototype=w.prototype;f=L.prototype=new da;f.constructor=L;I(f,w.prototype);f.isPureReactComponent=!0;var M={current:null},ha=Object.prototype.hasOwnProperty,ia={key:!0,ref:!0,__self:!0,__source:!0},ma=/\/+/g,C=[],na={current:null},X;if("undefined"===typeof window||"function"!==typeof MessageChannel){var A=null,qa=null,ra=function(){if(null!==A)try{var a=q();A(!0,a);A=null}catch(b){throw setTimeout(ra,0),b;}},La=Date.now();var q=
function(){return Date.now()-La};var z=function(a){null!==A?setTimeout(z,0,a):(A=a,setTimeout(ra,0))};var G=function(a,b){qa=setTimeout(a,b)};var V=function(){clearTimeout(qa)};var W=function(){return!1};f=X=function(){}}else{var Y=window.performance,sa=window.Date,Ma=window.setTimeout,Na=window.clearTimeout;"undefined"!==typeof console&&(f=window.cancelAnimationFrame,"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),
"function"!==typeof f&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"));if("object"===typeof Y&&"function"===typeof Y.now)q=function(){return Y.now()};else{var Oa=sa.now();q=function(){return sa.now()-Oa}}var J=!1,K=null,Z=-1,ta=5,ua=0;W=function(){return q()>=ua};f=function(){};X=function(a){0>a||125<a?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):
ta=0<a?Math.floor(1E3/a):5};var B=new MessageChannel,aa=B.port2;B.port1.onmessage=function(){if(null!==K){var a=q();ua=a+ta;try{K(!0,a)?aa.postMessage(null):(J=!1,K=null)}catch(b){throw aa.postMessage(null),b;}}else J=!1};z=function(a){K=a;J||(J=!0,aa.postMessage(null))};G=function(a,b){Z=Ma(function(){a(q())},b)};V=function(){Na(Z);Z=-1}}var p=[],u=[],Pa=1,l=null,m=3,H=!1,v=!1,y=!1,Qa=0;B={ReactCurrentDispatcher:na,ReactCurrentOwner:M,IsSomeRendererActing:{current:!1},assign:I};I(B,{Scheduler:{__proto__:null,
unstable_ImmediatePriority:1,unstable_UserBlockingPriority:2,unstable_NormalPriority:3,unstable_IdlePriority:5,unstable_LowPriority:4,unstable_runWithPriority:function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=m;m=a;try{return b()}finally{m=c}},unstable_next:function(a){switch(m){case 1:case 2:case 3:var b=3;break;default:b=m}var c=m;m=b;try{return a()}finally{m=c}},unstable_scheduleCallback:function(a,b,c){var d=q();if("object"===typeof c&&null!==c){var e=c.delay;
e="number"===typeof e&&0<e?d+e:d;c="number"===typeof c.timeout?c.timeout:oa(a)}else c=oa(a),e=d;c=e+c;a={id:Pa++,callback:b,priorityLevel:a,startTime:e,expirationTime:c,sortIndex:-1};e>d?(a.sortIndex=e,S(u,a),null===n(p)&&a===n(u)&&(y?V():y=!0,G(T,e-d))):(a.sortIndex=c,S(p,a),v||H||(v=!0,z(U)));return a},unstable_cancelCallback:function(a){a.callback=null},unstable_wrapCallback:function(a){var b=m;return function(){var c=m;m=b;try{return a.apply(this,arguments)}finally{m=c}}},unstable_getCurrentPriorityLevel:function(){return m},
unstable_shouldYield:function(){var a=q();F(a);var b=n(p);return b!==l&&null!==l&&null!==b&&null!==b.callback&&b.startTime<=a&&b.expirationTime<l.expirationTime||W()},unstable_requestPaint:f,unstable_continueExecution:function(){v||H||(v=!0,z(U))},unstable_pauseExecution:function(){},unstable_getFirstCallbackNode:function(){return n(p)},get unstable_now(){return q},get unstable_forceFrameRate(){return X},unstable_Profiling:null},SchedulerTracing:{__proto__:null,__interactionsRef:null,__subscriberRef:null,
unstable_clear:function(a){return a()},unstable_getCurrent:function(){return null},unstable_getThreadID:function(){return++Qa},unstable_trace:function(a,b,c){return c()},unstable_wrap:function(a){return a},unstable_subscribe:function(a){},unstable_unsubscribe:function(a){}}});d.Children={map:function(a,b,c){if(null==a)return a;var d=[];R(a,d,null,b,c);return d},forEach:function(a,b,c){if(null==a)return a;b=ja(null,null,b,c);Q(a,ya,b);ka(b)},count:function(a){return Q(a,function(){return null},null)},
toArray:function(a){var b=[];R(a,b,null,function(a){return a});return b},only:function(a){if(!N(a))throw Error(r(143));return a}};d.Component=w;d.Fragment=Aa;d.Profiler=Ca;d.PureComponent=L;d.StrictMode=Ba;d.Suspense=Ga;d.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B;d.cloneElement=function(a,b,c){if(null===a||void 0===a)throw Error(r(267,a));var d=I({},a.props),e=a.key,f=a.ref,m=a._owner;if(null!=b){void 0!==b.ref&&(f=b.ref,m=M.current);void 0!==b.key&&(e=""+b.key);if(a.type&&a.type.defaultProps)var h=
a.type.defaultProps;for(k in b)ha.call(b,k)&&!ia.hasOwnProperty(k)&&(d[k]=void 0===b[k]&&void 0!==h?h[k]:b[k])}var k=arguments.length-2;if(1===k)d.children=c;else if(1<k){h=Array(k);for(var l=0;l<k;l++)h[l]=arguments[l+2];d.children=h}return{$$typeof:x,type:a.type,key:e,ref:f,props:d,_owner:m}};d.createContext=function(a,b){void 0===b&&(b=null);a={$$typeof:Ea,_calculateChangedBits:b,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null};a.Provider={$$typeof:Da,_context:a};return a.Consumer=
a};d.createElement=ea;d.createFactory=function(a){var b=ea.bind(null,a);b.type=a;return b};d.createRef=function(){return{current:null}};d.forwardRef=function(a){return{$$typeof:Fa,render:a}};d.isValidElement=N;d.lazy=function(a){return{$$typeof:Ia,_ctor:a,_status:-1,_result:null}};d.memo=function(a,b){return{$$typeof:Ha,type:a,compare:void 0===b?null:b}};d.useCallback=function(a,b){return t().useCallback(a,b)};d.useContext=function(a,b){return t().useContext(a,b)};d.useDebugValue=function(a,b){};
d.useEffect=function(a,b){return t().useEffect(a,b)};d.useImperativeHandle=function(a,b,c){return t().useImperativeHandle(a,b,c)};d.useLayoutEffect=function(a,b){return t().useLayoutEffect(a,b)};d.useMemo=function(a,b){return t().useMemo(a,b)};d.useReducer=function(a,b,c){return t().useReducer(a,b,c)};d.useRef=function(a){return t().useRef(a)};d.useState=function(a){return t().useState(a)};d.version="16.13.1"});
</script>
    <script crossorigin>/** @license React v16.13.1
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
/*
 Modernizr 3.0.0pre (Custom Build) | MIT
*/
'use strict';(function(I,ea){"object"===typeof exports&&"undefined"!==typeof module?ea(exports,require("react")):"function"===typeof define&&define.amd?define(["exports","react"],ea):(I=I||self,ea(I.ReactDOM={},I.React))})(this,function(I,ea){function k(a){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+a,c=1;c<arguments.length;c++)b+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+a+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}
function ji(a,b,c,d,e,f,g,h,m){yb=!1;gc=null;ki.apply(li,arguments)}function mi(a,b,c,d,e,f,g,h,m){ji.apply(this,arguments);if(yb){if(yb){var n=gc;yb=!1;gc=null}else throw Error(k(198));hc||(hc=!0,pd=n)}}function lf(a,b,c){var d=a.type||"unknown-event";a.currentTarget=mf(c);mi(d,b,void 0,a);a.currentTarget=null}function nf(){if(ic)for(var a in cb){var b=cb[a],c=ic.indexOf(a);if(!(-1<c))throw Error(k(96,a));if(!jc[c]){if(!b.extractEvents)throw Error(k(97,a));jc[c]=b;c=b.eventTypes;for(var d in c){var e=
void 0;var f=c[d],g=b,h=d;if(qd.hasOwnProperty(h))throw Error(k(99,h));qd[h]=f;var m=f.phasedRegistrationNames;if(m){for(e in m)m.hasOwnProperty(e)&&of(m[e],g,h);e=!0}else f.registrationName?(of(f.registrationName,g,h),e=!0):e=!1;if(!e)throw Error(k(98,d,a));}}}}function of(a,b,c){if(db[a])throw Error(k(100,a));db[a]=b;rd[a]=b.eventTypes[c].dependencies}function pf(a){var b=!1,c;for(c in a)if(a.hasOwnProperty(c)){var d=a[c];if(!cb.hasOwnProperty(c)||cb[c]!==d){if(cb[c])throw Error(k(102,c));cb[c]=
d;b=!0}}b&&nf()}function qf(a){if(a=rf(a)){if("function"!==typeof sd)throw Error(k(280));var b=a.stateNode;b&&(b=td(b),sd(a.stateNode,a.type,b))}}function sf(a){eb?fb?fb.push(a):fb=[a]:eb=a}function tf(){if(eb){var a=eb,b=fb;fb=eb=null;qf(a);if(b)for(a=0;a<b.length;a++)qf(b[a])}}function ud(){if(null!==eb||null!==fb)vd(),tf()}function uf(a,b,c){if(wd)return a(b,c);wd=!0;try{return vf(a,b,c)}finally{wd=!1,ud()}}function ni(a){if(wf.call(xf,a))return!0;if(wf.call(yf,a))return!1;if(oi.test(a))return xf[a]=
!0;yf[a]=!0;return!1}function pi(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case "function":case "symbol":return!0;case "boolean":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return"data-"!==a&&"aria-"!==a;default:return!1}}function qi(a,b,c,d){if(null===b||"undefined"===typeof b||pi(a,b,c,d))return!0;if(d)return!1;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function L(a,
b,c,d,e,f){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=a;this.type=b;this.sanitizeURL=f}function xd(a,b,c,d){var e=E.hasOwnProperty(b)?E[b]:null;var f=null!==e?0===e.type:d?!1:!(2<b.length)||"o"!==b[0]&&"O"!==b[0]||"n"!==b[1]&&"N"!==b[1]?!1:!0;f||(qi(b,c,e,d)&&(c=null),d||null===e?ni(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,""+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:"":c:(b=e.attributeName,
d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?"":""+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,c))))}function zb(a){if(null===a||"object"!==typeof a)return null;a=zf&&a[zf]||a["@@iterator"];return"function"===typeof a?a:null}function ri(a){if(-1===a._status){a._status=0;var b=a._ctor;b=b();a._result=b;b.then(function(b){0===a._status&&(b=b.default,a._status=1,a._result=b)},function(b){0===a._status&&(a._status=2,a._result=b)})}}function na(a){if(null==a)return null;
if("function"===typeof a)return a.displayName||a.name||null;if("string"===typeof a)return a;switch(a){case Ma:return"Fragment";case gb:return"Portal";case kc:return"Profiler";case Af:return"StrictMode";case lc:return"Suspense";case yd:return"SuspenseList"}if("object"===typeof a)switch(a.$$typeof){case Bf:return"Context.Consumer";case Cf:return"Context.Provider";case zd:var b=a.render;b=b.displayName||b.name||"";return a.displayName||(""!==b?"ForwardRef("+b+")":"ForwardRef");case Ad:return na(a.type);
case Df:return na(a.render);case Ef:if(a=1===a._status?a._result:null)return na(a)}return null}function Bd(a){var b="";do{a:switch(a.tag){case 3:case 4:case 6:case 7:case 10:case 9:var c="";break a;default:var d=a._debugOwner,e=a._debugSource,f=na(a.type);c=null;d&&(c=na(d.type));d=f;f="";e?f=" (at "+e.fileName.replace(si,"")+":"+e.lineNumber+")":c&&(f=" (created by "+c+")");c="\n    in "+(d||"Unknown")+f}b+=c;a=a.return}while(a);return b}function va(a){switch(typeof a){case "boolean":case "number":case "object":case "string":case "undefined":return a;
default:return""}}function Ff(a){var b=a.type;return(a=a.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===b||"radio"===b)}function ti(a){var b=Ff(a)?"checked":"value",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=""+a[b];if(!a.hasOwnProperty(b)&&"undefined"!==typeof c&&"function"===typeof c.get&&"function"===typeof c.set){var e=c.get,f=c.set;Object.defineProperty(a,b,{configurable:!0,get:function(){return e.call(this)},set:function(a){d=""+a;f.call(this,a)}});Object.defineProperty(a,
b,{enumerable:c.enumerable});return{getValue:function(){return d},setValue:function(a){d=""+a},stopTracking:function(){a._valueTracker=null;delete a[b]}}}}function mc(a){a._valueTracker||(a._valueTracker=ti(a))}function Gf(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d="";a&&(d=Ff(a)?a.checked?"true":"false":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}function Cd(a,b){var c=b.checked;return M({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=
c?c:a._wrapperState.initialChecked})}function Hf(a,b){var c=null==b.defaultValue?"":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=va(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:"checkbox"===b.type||"radio"===b.type?null!=b.checked:null!=b.value}}function If(a,b){b=b.checked;null!=b&&xd(a,"checked",b,!1)}function Dd(a,b){If(a,b);var c=va(b.value),d=b.type;if(null!=c)if("number"===d){if(0===c&&""===a.value||a.value!=c)a.value=""+c}else a.value!==
""+c&&(a.value=""+c);else if("submit"===d||"reset"===d){a.removeAttribute("value");return}b.hasOwnProperty("value")?Ed(a,b.type,c):b.hasOwnProperty("defaultValue")&&Ed(a,b.type,va(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked)}function Jf(a,b,c){if(b.hasOwnProperty("value")||b.hasOwnProperty("defaultValue")){var d=b.type;if(!("submit"!==d&&"reset"!==d||void 0!==b.value&&null!==b.value))return;b=""+a._wrapperState.initialValue;c||b===a.value||(a.value=
b);a.defaultValue=b}c=a.name;""!==c&&(a.name="");a.defaultChecked=!!a._wrapperState.initialChecked;""!==c&&(a.name=c)}function Ed(a,b,c){if("number"!==b||a.ownerDocument.activeElement!==a)null==c?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+c&&(a.defaultValue=""+c)}function ui(a){var b="";ea.Children.forEach(a,function(a){null!=a&&(b+=a)});return b}function Fd(a,b){a=M({children:void 0},b);if(b=ui(b.children))a.children=b;return a}function hb(a,b,c,d){a=a.options;if(b){b={};
for(var e=0;e<c.length;e++)b["$"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty("$"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=""+va(c);b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}function Gd(a,b){if(null!=b.dangerouslySetInnerHTML)throw Error(k(91));return M({},b,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}
function Kf(a,b){var c=b.value;if(null==c){c=b.children;b=b.defaultValue;if(null!=c){if(null!=b)throw Error(k(92));if(Array.isArray(c)){if(!(1>=c.length))throw Error(k(93));c=c[0]}b=c}null==b&&(b="");c=b}a._wrapperState={initialValue:va(c)}}function Lf(a,b){var c=va(b.value),d=va(b.defaultValue);null!=c&&(c=""+c,c!==a.value&&(a.value=c),null==b.defaultValue&&a.defaultValue!==c&&(a.defaultValue=c));null!=d&&(a.defaultValue=""+d)}function Mf(a,b){b=a.textContent;b===a._wrapperState.initialValue&&""!==
b&&null!==b&&(a.value=b)}function Nf(a){switch(a){case "svg":return"http://www.w3.org/2000/svg";case "math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hd(a,b){return null==a||"http://www.w3.org/1999/xhtml"===a?Nf(b):"http://www.w3.org/2000/svg"===a&&"foreignObject"===b?"http://www.w3.org/1999/xhtml":a}function nc(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c["Webkit"+a]="webkit"+b;c["Moz"+a]="moz"+b;return c}function oc(a){if(Id[a])return Id[a];
if(!ib[a])return a;var b=ib[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in Of)return Id[a]=b[c];return a}function Jd(a){var b=Pf.get(a);void 0===b&&(b=new Map,Pf.set(a,b));return b}function Na(a){var b=a,c=a;if(a.alternate)for(;b.return;)b=b.return;else{a=b;do b=a,0!==(b.effectTag&1026)&&(c=b.return),a=b.return;while(a)}return 3===b.tag?c:null}function Qf(a){if(13===a.tag){var b=a.memoizedState;null===b&&(a=a.alternate,null!==a&&(b=a.memoizedState));if(null!==b)return b.dehydrated}return null}function Rf(a){if(Na(a)!==
a)throw Error(k(188));}function vi(a){var b=a.alternate;if(!b){b=Na(a);if(null===b)throw Error(k(188));return b!==a?null:a}for(var c=a,d=b;;){var e=c.return;if(null===e)break;var f=e.alternate;if(null===f){d=e.return;if(null!==d){c=d;continue}break}if(e.child===f.child){for(f=e.child;f;){if(f===c)return Rf(e),a;if(f===d)return Rf(e),b;f=f.sibling}throw Error(k(188));}if(c.return!==d.return)c=e,d=f;else{for(var g=!1,h=e.child;h;){if(h===c){g=!0;c=e;d=f;break}if(h===d){g=!0;d=e;c=f;break}h=h.sibling}if(!g){for(h=
f.child;h;){if(h===c){g=!0;c=f;d=e;break}if(h===d){g=!0;d=f;c=e;break}h=h.sibling}if(!g)throw Error(k(189));}}if(c.alternate!==d)throw Error(k(190));}if(3!==c.tag)throw Error(k(188));return c.stateNode.current===c?a:b}function Sf(a){a=vi(a);if(!a)return null;for(var b=a;;){if(5===b.tag||6===b.tag)return b;if(b.child)b.child.return=b,b=b.child;else{if(b===a)break;for(;!b.sibling;){if(!b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}}return null}function jb(a,b){if(null==
b)throw Error(k(30));if(null==a)return b;if(Array.isArray(a)){if(Array.isArray(b))return a.push.apply(a,b),a;a.push(b);return a}return Array.isArray(b)?[a].concat(b):[a,b]}function Kd(a,b,c){Array.isArray(a)?a.forEach(b,c):a&&b.call(c,a)}function pc(a){null!==a&&(Ab=jb(Ab,a));a=Ab;Ab=null;if(a){Kd(a,wi);if(Ab)throw Error(k(95));if(hc)throw a=pd,hc=!1,pd=null,a;}}function Ld(a){a=a.target||a.srcElement||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:
a}function Tf(a){if(!wa)return!1;a="on"+a;var b=a in document;b||(b=document.createElement("div"),b.setAttribute(a,"return;"),b="function"===typeof b[a]);return b}function Uf(a){a.topLevelType=null;a.nativeEvent=null;a.targetInst=null;a.ancestors.length=0;10>qc.length&&qc.push(a)}function Vf(a,b,c,d){if(qc.length){var e=qc.pop();e.topLevelType=a;e.eventSystemFlags=d;e.nativeEvent=b;e.targetInst=c;return e}return{topLevelType:a,eventSystemFlags:d,nativeEvent:b,targetInst:c,ancestors:[]}}function Wf(a){var b=
a.targetInst,c=b;do{if(!c){a.ancestors.push(c);break}var d=c;if(3===d.tag)d=d.stateNode.containerInfo;else{for(;d.return;)d=d.return;d=3!==d.tag?null:d.stateNode.containerInfo}if(!d)break;b=c.tag;5!==b&&6!==b||a.ancestors.push(c);c=Bb(d)}while(c);for(c=0;c<a.ancestors.length;c++){b=a.ancestors[c];var e=Ld(a.nativeEvent);d=a.topLevelType;var f=a.nativeEvent,g=a.eventSystemFlags;0===c&&(g|=64);for(var h=null,m=0;m<jc.length;m++){var n=jc[m];n&&(n=n.extractEvents(d,b,f,e,g))&&(h=jb(h,n))}pc(h)}}function Md(a,
b,c){if(!c.has(a)){switch(a){case "scroll":Cb(b,"scroll",!0);break;case "focus":case "blur":Cb(b,"focus",!0);Cb(b,"blur",!0);c.set("blur",null);c.set("focus",null);break;case "cancel":case "close":Tf(a)&&Cb(b,a,!0);break;case "invalid":case "submit":case "reset":break;default:-1===Db.indexOf(a)&&w(a,b)}c.set(a,null)}}function xi(a,b){var c=Jd(b);Nd.forEach(function(a){Md(a,b,c)});yi.forEach(function(a){Md(a,b,c)})}function Od(a,b,c,d,e){return{blockedOn:a,topLevelType:b,eventSystemFlags:c|32,nativeEvent:e,
container:d}}function Xf(a,b){switch(a){case "focus":case "blur":xa=null;break;case "dragenter":case "dragleave":ya=null;break;case "mouseover":case "mouseout":za=null;break;case "pointerover":case "pointerout":Eb.delete(b.pointerId);break;case "gotpointercapture":case "lostpointercapture":Fb.delete(b.pointerId)}}function Gb(a,b,c,d,e,f){if(null===a||a.nativeEvent!==f)return a=Od(b,c,d,e,f),null!==b&&(b=Hb(b),null!==b&&Yf(b)),a;a.eventSystemFlags|=d;return a}function zi(a,b,c,d,e){switch(b){case "focus":return xa=
Gb(xa,a,b,c,d,e),!0;case "dragenter":return ya=Gb(ya,a,b,c,d,e),!0;case "mouseover":return za=Gb(za,a,b,c,d,e),!0;case "pointerover":var f=e.pointerId;Eb.set(f,Gb(Eb.get(f)||null,a,b,c,d,e));return!0;case "gotpointercapture":return f=e.pointerId,Fb.set(f,Gb(Fb.get(f)||null,a,b,c,d,e)),!0}return!1}function Ai(a){var b=Bb(a.target);if(null!==b){var c=Na(b);if(null!==c)if(b=c.tag,13===b){if(b=Qf(c),null!==b){a.blockedOn=b;Pd(a.priority,function(){Bi(c)});return}}else if(3===b&&c.stateNode.hydrate){a.blockedOn=
3===c.tag?c.stateNode.containerInfo:null;return}}a.blockedOn=null}function rc(a){if(null!==a.blockedOn)return!1;var b=Qd(a.topLevelType,a.eventSystemFlags,a.container,a.nativeEvent);if(null!==b){var c=Hb(b);null!==c&&Yf(c);a.blockedOn=b;return!1}return!0}function Zf(a,b,c){rc(a)&&c.delete(b)}function Ci(){for(Rd=!1;0<fa.length;){var a=fa[0];if(null!==a.blockedOn){a=Hb(a.blockedOn);null!==a&&Di(a);break}var b=Qd(a.topLevelType,a.eventSystemFlags,a.container,a.nativeEvent);null!==b?a.blockedOn=b:fa.shift()}null!==
xa&&rc(xa)&&(xa=null);null!==ya&&rc(ya)&&(ya=null);null!==za&&rc(za)&&(za=null);Eb.forEach(Zf);Fb.forEach(Zf)}function Ib(a,b){a.blockedOn===b&&(a.blockedOn=null,Rd||(Rd=!0,$f(ag,Ci)))}function bg(a){if(0<fa.length){Ib(fa[0],a);for(var b=1;b<fa.length;b++){var c=fa[b];c.blockedOn===a&&(c.blockedOn=null)}}null!==xa&&Ib(xa,a);null!==ya&&Ib(ya,a);null!==za&&Ib(za,a);b=function(b){return Ib(b,a)};Eb.forEach(b);Fb.forEach(b);for(b=0;b<Jb.length;b++)c=Jb[b],c.blockedOn===a&&(c.blockedOn=null);for(;0<Jb.length&&
(b=Jb[0],null===b.blockedOn);)Ai(b),null===b.blockedOn&&Jb.shift()}function Sd(a,b){for(var c=0;c<a.length;c+=2){var d=a[c],e=a[c+1],f="on"+(e[0].toUpperCase()+e.slice(1));f={phasedRegistrationNames:{bubbled:f,captured:f+"Capture"},dependencies:[d],eventPriority:b};Td.set(d,b);cg.set(d,f);dg[e]=f}}function w(a,b){Cb(b,a,!1)}function Cb(a,b,c){var d=Td.get(b);switch(void 0===d?2:d){case 0:d=Ei.bind(null,b,1,a);break;case 1:d=Fi.bind(null,b,1,a);break;default:d=sc.bind(null,b,1,a)}c?a.addEventListener(b,
d,!0):a.addEventListener(b,d,!1)}function Ei(a,b,c,d){Oa||vd();var e=sc,f=Oa;Oa=!0;try{eg(e,a,b,c,d)}finally{(Oa=f)||ud()}}function Fi(a,b,c,d){Gi(Hi,sc.bind(null,a,b,c,d))}function sc(a,b,c,d){if(tc)if(0<fa.length&&-1<Nd.indexOf(a))a=Od(null,a,b,c,d),fa.push(a);else{var e=Qd(a,b,c,d);if(null===e)Xf(a,d);else if(-1<Nd.indexOf(a))a=Od(e,a,b,c,d),fa.push(a);else if(!zi(e,a,b,c,d)){Xf(a,d);a=Vf(a,d,null,b);try{uf(Wf,a)}finally{Uf(a)}}}}function Qd(a,b,c,d){c=Ld(d);c=Bb(c);if(null!==c){var e=Na(c);if(null===
e)c=null;else{var f=e.tag;if(13===f){c=Qf(e);if(null!==c)return c;c=null}else if(3===f){if(e.stateNode.hydrate)return 3===e.tag?e.stateNode.containerInfo:null;c=null}else e!==c&&(c=null)}}a=Vf(a,d,c,b);try{uf(Wf,a)}finally{Uf(a)}return null}function fg(a,b,c){return null==b||"boolean"===typeof b||""===b?"":c||"number"!==typeof b||0===b||Kb.hasOwnProperty(a)&&Kb[a]?(""+b).trim():b+"px"}function gg(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf("--"),e=fg(c,b[c],d);"float"===
c&&(c="cssFloat");d?a.setProperty(c,e):a[c]=e}}function Ud(a,b){if(b){if(Ii[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML))throw Error(k(137,a,""));if(null!=b.dangerouslySetInnerHTML){if(null!=b.children)throw Error(k(60));if(!("object"===typeof b.dangerouslySetInnerHTML&&"__html"in b.dangerouslySetInnerHTML))throw Error(k(61));}if(null!=b.style&&"object"!==typeof b.style)throw Error(k(62,""));}}function Vd(a,b){if(-1===a.indexOf("-"))return"string"===typeof b.is;switch(a){case "annotation-xml":case "color-profile":case "font-face":case "font-face-src":case "font-face-uri":case "font-face-format":case "font-face-name":case "missing-glyph":return!1;
default:return!0}}function oa(a,b){a=9===a.nodeType||11===a.nodeType?a:a.ownerDocument;var c=Jd(a);b=rd[b];for(var d=0;d<b.length;d++)Md(b[d],a,c)}function uc(){}function Wd(a){a=a||("undefined"!==typeof document?document:void 0);if("undefined"===typeof a)return null;try{return a.activeElement||a.body}catch(b){return a.body}}function hg(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function ig(a,b){var c=hg(a);a=0;for(var d;c;){if(3===c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,
offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=hg(c)}}function jg(a,b){return a&&b?a===b?!0:a&&3===a.nodeType?!1:b&&3===b.nodeType?jg(a,b.parentNode):"contains"in a?a.contains(b):a.compareDocumentPosition?!!(a.compareDocumentPosition(b)&16):!1:!1}function kg(){for(var a=window,b=Wd();b instanceof a.HTMLIFrameElement;){try{var c="string"===typeof b.contentWindow.location.href}catch(d){c=!1}if(c)a=b.contentWindow;else break;b=Wd(a.document)}return b}
function Xd(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&("input"===b&&("text"===a.type||"search"===a.type||"tel"===a.type||"url"===a.type||"password"===a.type)||"textarea"===b||"true"===a.contentEditable)}function lg(a,b){switch(a){case "button":case "input":case "select":case "textarea":return!!b.autoFocus}return!1}function Yd(a,b){return"textarea"===a||"option"===a||"noscript"===a||"string"===typeof b.children||"number"===typeof b.children||"object"===typeof b.dangerouslySetInnerHTML&&
null!==b.dangerouslySetInnerHTML&&null!=b.dangerouslySetInnerHTML.__html}function kb(a){for(;null!=a;a=a.nextSibling){var b=a.nodeType;if(1===b||3===b)break}return a}function mg(a){a=a.previousSibling;for(var b=0;a;){if(8===a.nodeType){var c=a.data;if(c===ng||c===Zd||c===$d){if(0===b)return a;b--}else c===og&&b++}a=a.previousSibling}return null}function Bb(a){var b=a[Aa];if(b)return b;for(var c=a.parentNode;c;){if(b=c[Lb]||c[Aa]){c=b.alternate;if(null!==b.child||null!==c&&null!==c.child)for(a=mg(a);null!==
a;){if(c=a[Aa])return c;a=mg(a)}return b}a=c;c=a.parentNode}return null}function Hb(a){a=a[Aa]||a[Lb];return!a||5!==a.tag&&6!==a.tag&&13!==a.tag&&3!==a.tag?null:a}function Pa(a){if(5===a.tag||6===a.tag)return a.stateNode;throw Error(k(33));}function ae(a){return a[vc]||null}function pa(a){do a=a.return;while(a&&5!==a.tag);return a?a:null}function pg(a,b){var c=a.stateNode;if(!c)return null;var d=td(c);if(!d)return null;c=d[b];a:switch(b){case "onClick":case "onClickCapture":case "onDoubleClick":case "onDoubleClickCapture":case "onMouseDown":case "onMouseDownCapture":case "onMouseMove":case "onMouseMoveCapture":case "onMouseUp":case "onMouseUpCapture":case "onMouseEnter":(d=
!d.disabled)||(a=a.type,d=!("button"===a||"input"===a||"select"===a||"textarea"===a));a=!d;break a;default:a=!1}if(a)return null;if(c&&"function"!==typeof c)throw Error(k(231,b,typeof c));return c}function qg(a,b,c){if(b=pg(a,c.dispatchConfig.phasedRegistrationNames[b]))c._dispatchListeners=jb(c._dispatchListeners,b),c._dispatchInstances=jb(c._dispatchInstances,a)}function Ji(a){if(a&&a.dispatchConfig.phasedRegistrationNames){for(var b=a._targetInst,c=[];b;)c.push(b),b=pa(b);for(b=c.length;0<b--;)qg(c[b],
"captured",a);for(b=0;b<c.length;b++)qg(c[b],"bubbled",a)}}function be(a,b,c){a&&c&&c.dispatchConfig.registrationName&&(b=pg(a,c.dispatchConfig.registrationName))&&(c._dispatchListeners=jb(c._dispatchListeners,b),c._dispatchInstances=jb(c._dispatchInstances,a))}function Ki(a){a&&a.dispatchConfig.registrationName&&be(a._targetInst,null,a)}function lb(a){Kd(a,Ji)}function rg(){if(wc)return wc;var a,b=ce,c=b.length,d,e="value"in Ba?Ba.value:Ba.textContent,f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=
c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return wc=e.slice(a,1<d?1-d:void 0)}function xc(){return!0}function yc(){return!1}function R(a,b,c,d){this.dispatchConfig=a;this._targetInst=b;this.nativeEvent=c;a=this.constructor.Interface;for(var e in a)a.hasOwnProperty(e)&&((b=a[e])?this[e]=b(c):"target"===e?this.target=d:this[e]=c[e]);this.isDefaultPrevented=(null!=c.defaultPrevented?c.defaultPrevented:!1===c.returnValue)?xc:yc;this.isPropagationStopped=yc;return this}function Li(a,b,c,d){if(this.eventPool.length){var e=
this.eventPool.pop();this.call(e,a,b,c,d);return e}return new this(a,b,c,d)}function Mi(a){if(!(a instanceof this))throw Error(k(279));a.destructor();10>this.eventPool.length&&this.eventPool.push(a)}function sg(a){a.eventPool=[];a.getPooled=Li;a.release=Mi}function tg(a,b){switch(a){case "keyup":return-1!==Ni.indexOf(b.keyCode);case "keydown":return 229!==b.keyCode;case "keypress":case "mousedown":case "blur":return!0;default:return!1}}function ug(a){a=a.detail;return"object"===typeof a&&"data"in
a?a.data:null}function Oi(a,b){switch(a){case "compositionend":return ug(b);case "keypress":if(32!==b.which)return null;vg=!0;return wg;case "textInput":return a=b.data,a===wg&&vg?null:a;default:return null}}function Pi(a,b){if(mb)return"compositionend"===a||!de&&tg(a,b)?(a=rg(),wc=ce=Ba=null,mb=!1,a):null;switch(a){case "paste":return null;case "keypress":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;
case "compositionend":return xg&&"ko"!==b.locale?null:b.data;default:return null}}function yg(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return"input"===b?!!Qi[a.type]:"textarea"===b?!0:!1}function zg(a,b,c){a=R.getPooled(Ag.change,a,b,c);a.type="change";sf(c);lb(a);return a}function Ri(a){pc(a)}function zc(a){var b=Pa(a);if(Gf(b))return a}function Si(a,b){if("change"===a)return b}function Bg(){Mb&&(Mb.detachEvent("onpropertychange",Cg),Nb=Mb=null)}function Cg(a){if("value"===a.propertyName&&
zc(Nb))if(a=zg(Nb,a,Ld(a)),Oa)pc(a);else{Oa=!0;try{ee(Ri,a)}finally{Oa=!1,ud()}}}function Ti(a,b,c){"focus"===a?(Bg(),Mb=b,Nb=c,Mb.attachEvent("onpropertychange",Cg)):"blur"===a&&Bg()}function Ui(a,b){if("selectionchange"===a||"keyup"===a||"keydown"===a)return zc(Nb)}function Vi(a,b){if("click"===a)return zc(b)}function Wi(a,b){if("input"===a||"change"===a)return zc(b)}function Xi(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=Yi[a])?!!b[a]:!1}function fe(a){return Xi}
function Zi(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}function Ob(a,b){if(Qa(a,b))return!0;if("object"!==typeof a||null===a||"object"!==typeof b||null===b)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++)if(!$i.call(b,c[d])||!Qa(a[c[d]],b[c[d]]))return!1;return!0}function Dg(a,b){var c=b.window===b?b.document:9===b.nodeType?b:b.ownerDocument;if(ge||null==nb||nb!==Wd(c))return null;c=nb;"selectionStart"in c&&Xd(c)?c={start:c.selectionStart,
end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset});return Pb&&Ob(Pb,c)?null:(Pb=c,a=R.getPooled(Eg.select,he,a,b),a.type="select",a.target=nb,lb(a),a)}function Ac(a){var b=a.keyCode;"charCode"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:0}function q(a,b){0>ob||(a.current=ie[ob],ie[ob]=null,ob--)}function y(a,b,c){ob++;
ie[ob]=a.current;a.current=b}function pb(a,b){var c=a.type.contextTypes;if(!c)return Ca;var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var e={},f;for(f in c)e[f]=b[f];d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e);return e}function N(a){a=a.childContextTypes;return null!==a&&void 0!==a}function Fg(a,b,c){if(B.current!==Ca)throw Error(k(168));y(B,b);y(G,c)}
function Gg(a,b,c){var d=a.stateNode;a=b.childContextTypes;if("function"!==typeof d.getChildContext)return c;d=d.getChildContext();for(var e in d)if(!(e in a))throw Error(k(108,na(b)||"Unknown",e));return M({},c,{},d)}function Bc(a){a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Ca;Ra=B.current;y(B,a);y(G,G.current);return!0}function Hg(a,b,c){var d=a.stateNode;if(!d)throw Error(k(169));c?(a=Gg(a,b,Ra),d.__reactInternalMemoizedMergedChildContext=a,q(G),q(B),y(B,a)):q(G);y(G,c)}function Cc(){switch(aj()){case Dc:return 99;
case Ig:return 98;case Jg:return 97;case Kg:return 96;case Lg:return 95;default:throw Error(k(332));}}function Mg(a){switch(a){case 99:return Dc;case 98:return Ig;case 97:return Jg;case 96:return Kg;case 95:return Lg;default:throw Error(k(332));}}function Da(a,b){a=Mg(a);return bj(a,b)}function Ng(a,b,c){a=Mg(a);return je(a,b,c)}function Og(a){null===qa?(qa=[a],Ec=je(Dc,Pg)):qa.push(a);return Qg}function ha(){if(null!==Ec){var a=Ec;Ec=null;Rg(a)}Pg()}function Pg(){if(!ke&&null!==qa){ke=!0;var a=0;
try{var b=qa;Da(99,function(){for(;a<b.length;a++){var c=b[a];do c=c(!0);while(null!==c)}});qa=null}catch(c){throw null!==qa&&(qa=qa.slice(a+1)),je(Dc,ha),c;}finally{ke=!1}}}function Fc(a,b,c){c/=10;return 1073741821-(((1073741821-a+b/10)/c|0)+1)*c}function aa(a,b){if(a&&a.defaultProps){b=M({},b);a=a.defaultProps;for(var c in a)void 0===b[c]&&(b[c]=a[c])}return b}function le(){Gc=qb=Hc=null}function me(a){var b=Ic.current;q(Ic);a.type._context._currentValue=b}function Sg(a,b){for(;null!==a;){var c=
a.alternate;if(a.childExpirationTime<b)a.childExpirationTime=b,null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);else if(null!==c&&c.childExpirationTime<b)c.childExpirationTime=b;else break;a=a.return}}function rb(a,b){Hc=a;Gc=qb=null;a=a.dependencies;null!==a&&null!==a.firstContext&&(a.expirationTime>=b&&(ia=!0),a.firstContext=null)}function W(a,b){if(Gc!==a&&!1!==b&&0!==b){if("number"!==typeof b||1073741823===b)Gc=a,b=1073741823;b={context:a,observedBits:b,next:null};if(null===qb){if(null===
Hc)throw Error(k(308));qb=b;Hc.dependencies={expirationTime:0,firstContext:b,responders:null}}else qb=qb.next=b}return a._currentValue}function ne(a){a.updateQueue={baseState:a.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function oe(a,b){a=a.updateQueue;b.updateQueue===a&&(b.updateQueue={baseState:a.baseState,baseQueue:a.baseQueue,shared:a.shared,effects:a.effects})}function Ea(a,b){a={expirationTime:a,suspenseConfig:b,tag:Tg,payload:null,callback:null,next:null};return a.next=
a}function Fa(a,b){a=a.updateQueue;if(null!==a){a=a.shared;var c=a.pending;null===c?b.next=b:(b.next=c.next,c.next=b);a.pending=b}}function Ug(a,b){var c=a.alternate;null!==c&&oe(c,a);a=a.updateQueue;c=a.baseQueue;null===c?(a.baseQueue=b.next=b,b.next=b):(b.next=c.next,c.next=b)}function Qb(a,b,c,d){var e=a.updateQueue;Ga=!1;var f=e.baseQueue,g=e.shared.pending;if(null!==g){if(null!==f){var h=f.next;f.next=g.next;g.next=h}f=g;e.shared.pending=null;h=a.alternate;null!==h&&(h=h.updateQueue,null!==h&&
(h.baseQueue=g))}if(null!==f){h=f.next;var m=e.baseState,n=0,k=null,ba=null,l=null;if(null!==h){var p=h;do{g=p.expirationTime;if(g<d){var t={expirationTime:p.expirationTime,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null};null===l?(ba=l=t,k=m):l=l.next=t;g>n&&(n=g)}else{null!==l&&(l=l.next={expirationTime:1073741823,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null});Vg(g,p.suspenseConfig);a:{var q=a,r=p;g=b;t=c;switch(r.tag){case 1:q=
r.payload;if("function"===typeof q){m=q.call(t,m,g);break a}m=q;break a;case 3:q.effectTag=q.effectTag&-4097|64;case Tg:q=r.payload;g="function"===typeof q?q.call(t,m,g):q;if(null===g||void 0===g)break a;m=M({},m,g);break a;case Jc:Ga=!0}}null!==p.callback&&(a.effectTag|=32,g=e.effects,null===g?e.effects=[p]:g.push(p))}p=p.next;if(null===p||p===h)if(g=e.shared.pending,null===g)break;else p=f.next=g.next,g.next=h,e.baseQueue=f=g,e.shared.pending=null}while(1)}null===l?k=m:l.next=ba;e.baseState=k;e.baseQueue=
l;Kc(n);a.expirationTime=n;a.memoizedState=m}}function Wg(a,b,c){a=b.effects;b.effects=null;if(null!==a)for(b=0;b<a.length;b++){var d=a[b],e=d.callback;if(null!==e){d.callback=null;d=e;e=c;if("function"!==typeof d)throw Error(k(191,d));d.call(e)}}}function Lc(a,b,c,d){b=a.memoizedState;c=c(d,b);c=null===c||void 0===c?b:M({},b,c);a.memoizedState=c;0===a.expirationTime&&(a.updateQueue.baseState=c)}function Xg(a,b,c,d,e,f,g){a=a.stateNode;return"function"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(d,
f,g):b.prototype&&b.prototype.isPureReactComponent?!Ob(c,d)||!Ob(e,f):!0}function Yg(a,b,c){var d=!1,e=Ca;var f=b.contextType;"object"===typeof f&&null!==f?f=W(f):(e=N(b)?Ra:B.current,d=b.contextTypes,f=(d=null!==d&&void 0!==d)?pb(a,e):Ca);b=new b(c,f);a.memoizedState=null!==b.state&&void 0!==b.state?b.state:null;b.updater=Mc;a.stateNode=b;b._reactInternalFiber=a;d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=e,a.__reactInternalMemoizedMaskedChildContext=f);return b}function Zg(a,
b,c,d){a=b.state;"function"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);"function"===typeof b.UNSAFE_componentWillReceiveProps&&b.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&Mc.enqueueReplaceState(b,b.state,null)}function pe(a,b,c,d){var e=a.stateNode;e.props=c;e.state=a.memoizedState;e.refs=$g;ne(a);var f=b.contextType;"object"===typeof f&&null!==f?e.context=W(f):(f=N(b)?Ra:B.current,e.context=pb(a,f));Qb(a,c,e,d);e.state=a.memoizedState;f=b.getDerivedStateFromProps;
"function"===typeof f&&(Lc(a,b,f,c),e.state=a.memoizedState);"function"===typeof b.getDerivedStateFromProps||"function"===typeof e.getSnapshotBeforeUpdate||"function"!==typeof e.UNSAFE_componentWillMount&&"function"!==typeof e.componentWillMount||(b=e.state,"function"===typeof e.componentWillMount&&e.componentWillMount(),"function"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),b!==e.state&&Mc.enqueueReplaceState(e,e.state,null),Qb(a,c,e,d),e.state=a.memoizedState);"function"===
typeof e.componentDidMount&&(a.effectTag|=4)}function Rb(a,b,c){a=c.ref;if(null!==a&&"function"!==typeof a&&"object"!==typeof a){if(c._owner){c=c._owner;if(c){if(1!==c.tag)throw Error(k(309));var d=c.stateNode}if(!d)throw Error(k(147,a));var e=""+a;if(null!==b&&null!==b.ref&&"function"===typeof b.ref&&b.ref._stringRef===e)return b.ref;b=function(a){var b=d.refs;b===$g&&(b=d.refs={});null===a?delete b[e]:b[e]=a};b._stringRef=e;return b}if("string"!==typeof a)throw Error(k(284));if(!c._owner)throw Error(k(290,
a));}return a}function Nc(a,b){if("textarea"!==a.type)throw Error(k(31,"[object Object]"===Object.prototype.toString.call(b)?"object with keys {"+Object.keys(b).join(", ")+"}":b,""));}function ah(a){function b(b,c){if(a){var d=b.lastEffect;null!==d?(d.nextEffect=c,b.lastEffect=c):b.firstEffect=b.lastEffect=c;c.nextEffect=null;c.effectTag=8}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,
b),b=b.sibling;return a}function e(a,b){a=Sa(a,b);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return c;d=b.alternate;if(null!==d)return d=d.index,d<c?(b.effectTag=2,c):d;b.effectTag=2;return c}function g(b){a&&null===b.alternate&&(b.effectTag=2);return b}function h(a,b,c,d){if(null===b||6!==b.tag)return b=qe(c,a.mode,d),b.return=a,b;b=e(b,c);b.return=a;return b}function m(a,b,c,d){if(null!==b&&b.elementType===c.type)return d=e(b,c.props),d.ref=Rb(a,b,c),d.return=a,d;d=Oc(c.type,
c.key,c.props,null,a.mode,d);d.ref=Rb(a,b,c);d.return=a;return d}function n(a,b,c,d){if(null===b||4!==b.tag||b.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==c.implementation)return b=re(c,a.mode,d),b.return=a,b;b=e(b,c.children||[]);b.return=a;return b}function l(a,b,c,d,f){if(null===b||7!==b.tag)return b=Ha(c,a.mode,d,f),b.return=a,b;b=e(b,c);b.return=a;return b}function ba(a,b,c){if("string"===typeof b||"number"===typeof b)return b=qe(""+b,a.mode,c),b.return=a,b;if("object"===
typeof b&&null!==b){switch(b.$$typeof){case Pc:return c=Oc(b.type,b.key,b.props,null,a.mode,c),c.ref=Rb(a,null,b),c.return=a,c;case gb:return b=re(b,a.mode,c),b.return=a,b}if(Qc(b)||zb(b))return b=Ha(b,a.mode,c,null),b.return=a,b;Nc(a,b)}return null}function p(a,b,c,d){var e=null!==b?b.key:null;if("string"===typeof c||"number"===typeof c)return null!==e?null:h(a,b,""+c,d);if("object"===typeof c&&null!==c){switch(c.$$typeof){case Pc:return c.key===e?c.type===Ma?l(a,b,c.props.children,d,e):m(a,b,c,
d):null;case gb:return c.key===e?n(a,b,c,d):null}if(Qc(c)||zb(c))return null!==e?null:l(a,b,c,d,null);Nc(a,c)}return null}function t(a,b,c,d,e){if("string"===typeof d||"number"===typeof d)return a=a.get(c)||null,h(b,a,""+d,e);if("object"===typeof d&&null!==d){switch(d.$$typeof){case Pc:return a=a.get(null===d.key?c:d.key)||null,d.type===Ma?l(b,a,d.props.children,e,d.key):m(b,a,d,e);case gb:return a=a.get(null===d.key?c:d.key)||null,n(b,a,d,e)}if(Qc(d)||zb(d))return a=a.get(c)||null,l(b,a,d,e,null);
Nc(b,d)}return null}function q(e,g,h,m){for(var n=null,k=null,l=g,r=g=0,C=null;null!==l&&r<h.length;r++){l.index>r?(C=l,l=null):C=l.sibling;var O=p(e,l,h[r],m);if(null===O){null===l&&(l=C);break}a&&l&&null===O.alternate&&b(e,l);g=f(O,g,r);null===k?n=O:k.sibling=O;k=O;l=C}if(r===h.length)return c(e,l),n;if(null===l){for(;r<h.length;r++)l=ba(e,h[r],m),null!==l&&(g=f(l,g,r),null===k?n=l:k.sibling=l,k=l);return n}for(l=d(e,l);r<h.length;r++)C=t(l,e,r,h[r],m),null!==C&&(a&&null!==C.alternate&&l.delete(null===
C.key?r:C.key),g=f(C,g,r),null===k?n=C:k.sibling=C,k=C);a&&l.forEach(function(a){return b(e,a)});return n}function w(e,g,h,n){var m=zb(h);if("function"!==typeof m)throw Error(k(150));h=m.call(h);if(null==h)throw Error(k(151));for(var l=m=null,r=g,C=g=0,O=null,v=h.next();null!==r&&!v.done;C++,v=h.next()){r.index>C?(O=r,r=null):O=r.sibling;var q=p(e,r,v.value,n);if(null===q){null===r&&(r=O);break}a&&r&&null===q.alternate&&b(e,r);g=f(q,g,C);null===l?m=q:l.sibling=q;l=q;r=O}if(v.done)return c(e,r),m;
if(null===r){for(;!v.done;C++,v=h.next())v=ba(e,v.value,n),null!==v&&(g=f(v,g,C),null===l?m=v:l.sibling=v,l=v);return m}for(r=d(e,r);!v.done;C++,v=h.next())v=t(r,e,C,v.value,n),null!==v&&(a&&null!==v.alternate&&r.delete(null===v.key?C:v.key),g=f(v,g,C),null===l?m=v:l.sibling=v,l=v);a&&r.forEach(function(a){return b(e,a)});return m}return function(a,d,f,h){var m="object"===typeof f&&null!==f&&f.type===Ma&&null===f.key;m&&(f=f.props.children);var n="object"===typeof f&&null!==f;if(n)switch(f.$$typeof){case Pc:a:{n=
f.key;for(m=d;null!==m;){if(m.key===n){switch(m.tag){case 7:if(f.type===Ma){c(a,m.sibling);d=e(m,f.props.children);d.return=a;a=d;break a}break;default:if(m.elementType===f.type){c(a,m.sibling);d=e(m,f.props);d.ref=Rb(a,m,f);d.return=a;a=d;break a}}c(a,m);break}else b(a,m);m=m.sibling}f.type===Ma?(d=Ha(f.props.children,a.mode,h,f.key),d.return=a,a=d):(h=Oc(f.type,f.key,f.props,null,a.mode,h),h.ref=Rb(a,d,f),h.return=a,a=h)}return g(a);case gb:a:{for(m=f.key;null!==d;){if(d.key===m)if(4===d.tag&&d.stateNode.containerInfo===
f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[]);d.return=a;a=d;break a}else{c(a,d);break}else b(a,d);d=d.sibling}d=re(f,a.mode,h);d.return=a;a=d}return g(a)}if("string"===typeof f||"number"===typeof f)return f=""+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f),d.return=a,a=d):(c(a,d),d=qe(f,a.mode,h),d.return=a,a=d),g(a);if(Qc(f))return q(a,d,f,h);if(zb(f))return w(a,d,f,h);n&&Nc(a,f);if("undefined"===typeof f&&!m)switch(a.tag){case 1:case 0:throw a=
a.type,Error(k(152,a.displayName||a.name||"Component"));}return c(a,d)}}function Ta(a){if(a===Sb)throw Error(k(174));return a}function se(a,b){y(Tb,b);y(Ub,a);y(ja,Sb);a=b.nodeType;switch(a){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:Hd(null,"");break;default:a=8===a?b.parentNode:b,b=a.namespaceURI||null,a=a.tagName,b=Hd(b,a)}q(ja);y(ja,b)}function tb(a){q(ja);q(Ub);q(Tb)}function bh(a){Ta(Tb.current);var b=Ta(ja.current);var c=Hd(b,a.type);b!==c&&(y(Ub,a),y(ja,c))}function te(a){Ub.current===
a&&(q(ja),q(Ub))}function Rc(a){for(var b=a;null!==b;){if(13===b.tag){var c=b.memoizedState;if(null!==c&&(c=c.dehydrated,null===c||c.data===$d||c.data===Zd))return b}else if(19===b.tag&&void 0!==b.memoizedProps.revealOrder){if(0!==(b.effectTag&64))return b}else if(null!==b.child){b.child.return=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}return null}function ue(a,b){return{responder:a,props:b}}
function S(){throw Error(k(321));}function ve(a,b){if(null===b)return!1;for(var c=0;c<b.length&&c<a.length;c++)if(!Qa(a[c],b[c]))return!1;return!0}function we(a,b,c,d,e,f){Ia=f;z=b;b.memoizedState=null;b.updateQueue=null;b.expirationTime=0;Sc.current=null===a||null===a.memoizedState?dj:ej;a=c(d,e);if(b.expirationTime===Ia){f=0;do{b.expirationTime=0;if(!(25>f))throw Error(k(301));f+=1;J=K=null;b.updateQueue=null;Sc.current=fj;a=c(d,e)}while(b.expirationTime===Ia)}Sc.current=Tc;b=null!==K&&null!==K.next;
Ia=0;J=K=z=null;Uc=!1;if(b)throw Error(k(300));return a}function ub(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};null===J?z.memoizedState=J=a:J=J.next=a;return J}function vb(){if(null===K){var a=z.alternate;a=null!==a?a.memoizedState:null}else a=K.next;var b=null===J?z.memoizedState:J.next;if(null!==b)J=b,K=a;else{if(null===a)throw Error(k(310));K=a;a={memoizedState:K.memoizedState,baseState:K.baseState,baseQueue:K.baseQueue,queue:K.queue,next:null};null===J?z.memoizedState=
J=a:J=J.next=a}return J}function Ua(a,b){return"function"===typeof b?b(a):b}function Vc(a,b,c){b=vb();c=b.queue;if(null===c)throw Error(k(311));c.lastRenderedReducer=a;var d=K,e=d.baseQueue,f=c.pending;if(null!==f){if(null!==e){var g=e.next;e.next=f.next;f.next=g}d.baseQueue=e=f;c.pending=null}if(null!==e){e=e.next;d=d.baseState;var h=g=f=null,m=e;do{var n=m.expirationTime;if(n<Ia){var l={expirationTime:m.expirationTime,suspenseConfig:m.suspenseConfig,action:m.action,eagerReducer:m.eagerReducer,eagerState:m.eagerState,
next:null};null===h?(g=h=l,f=d):h=h.next=l;n>z.expirationTime&&(z.expirationTime=n,Kc(n))}else null!==h&&(h=h.next={expirationTime:1073741823,suspenseConfig:m.suspenseConfig,action:m.action,eagerReducer:m.eagerReducer,eagerState:m.eagerState,next:null}),Vg(n,m.suspenseConfig),d=m.eagerReducer===a?m.eagerState:a(d,m.action);m=m.next}while(null!==m&&m!==e);null===h?f=d:h.next=g;Qa(d,b.memoizedState)||(ia=!0);b.memoizedState=d;b.baseState=f;b.baseQueue=h;c.lastRenderedState=d}return[b.memoizedState,
c.dispatch]}function Wc(a,b,c){b=vb();c=b.queue;if(null===c)throw Error(k(311));c.lastRenderedReducer=a;var d=c.dispatch,e=c.pending,f=b.memoizedState;if(null!==e){c.pending=null;var g=e=e.next;do f=a(f,g.action),g=g.next;while(g!==e);Qa(f,b.memoizedState)||(ia=!0);b.memoizedState=f;null===b.baseQueue&&(b.baseState=f);c.lastRenderedState=f}return[f,d]}function xe(a){var b=ub();"function"===typeof a&&(a=a());b.memoizedState=b.baseState=a;a=b.queue={pending:null,dispatch:null,lastRenderedReducer:Ua,
lastRenderedState:a};a=a.dispatch=ch.bind(null,z,a);return[b.memoizedState,a]}function ye(a,b,c,d){a={tag:a,create:b,destroy:c,deps:d,next:null};b=z.updateQueue;null===b?(b={lastEffect:null},z.updateQueue=b,b.lastEffect=a.next=a):(c=b.lastEffect,null===c?b.lastEffect=a.next=a:(d=c.next,c.next=a,a.next=d,b.lastEffect=a));return a}function dh(a){return vb().memoizedState}function ze(a,b,c,d){var e=ub();z.effectTag|=a;e.memoizedState=ye(1|b,c,void 0,void 0===d?null:d)}function Ae(a,b,c,d){var e=vb();
d=void 0===d?null:d;var f=void 0;if(null!==K){var g=K.memoizedState;f=g.destroy;if(null!==d&&ve(d,g.deps)){ye(b,c,f,d);return}}z.effectTag|=a;e.memoizedState=ye(1|b,c,f,d)}function eh(a,b){return ze(516,4,a,b)}function Xc(a,b){return Ae(516,4,a,b)}function fh(a,b){return Ae(4,2,a,b)}function gh(a,b){if("function"===typeof b)return a=a(),b(a),function(){b(null)};if(null!==b&&void 0!==b)return a=a(),b.current=a,function(){b.current=null}}function hh(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;
return Ae(4,2,gh.bind(null,b,a),c)}function Be(a,b){}function ih(a,b){ub().memoizedState=[a,void 0===b?null:b];return a}function Yc(a,b){var c=vb();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&ve(b,d[1]))return d[0];c.memoizedState=[a,b];return a}function jh(a,b){var c=vb();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&ve(b,d[1]))return d[0];a=a();c.memoizedState=[a,b];return a}function Ce(a,b,c){var d=Cc();Da(98>d?98:d,function(){a(!0)});Da(97<d?97:d,function(){var d=
X.suspense;X.suspense=void 0===b?null:b;try{a(!1),c()}finally{X.suspense=d}})}function ch(a,b,c){var d=ka(),e=Vb.suspense;d=Va(d,a,e);e={expirationTime:d,suspenseConfig:e,action:c,eagerReducer:null,eagerState:null,next:null};var f=b.pending;null===f?e.next=e:(e.next=f.next,f.next=e);b.pending=e;f=a.alternate;if(a===z||null!==f&&f===z)Uc=!0,e.expirationTime=Ia,z.expirationTime=Ia;else{if(0===a.expirationTime&&(null===f||0===f.expirationTime)&&(f=b.lastRenderedReducer,null!==f))try{var g=b.lastRenderedState,
h=f(g,c);e.eagerReducer=f;e.eagerState=h;if(Qa(h,g))return}catch(m){}finally{}Ja(a,d)}}function kh(a,b){var c=la(5,null,null,0);c.elementType="DELETED";c.type="DELETED";c.stateNode=b;c.return=a;c.effectTag=8;null!==a.lastEffect?(a.lastEffect.nextEffect=c,a.lastEffect=c):a.firstEffect=a.lastEffect=c}function lh(a,b){switch(a.tag){case 5:var c=a.type;b=1!==b.nodeType||c.toLowerCase()!==b.nodeName.toLowerCase()?null:b;return null!==b?(a.stateNode=b,!0):!1;case 6:return b=""===a.pendingProps||3!==b.nodeType?
null:b,null!==b?(a.stateNode=b,!0):!1;case 13:return!1;default:return!1}}function De(a){if(Wa){var b=Ka;if(b){var c=b;if(!lh(a,b)){b=kb(c.nextSibling);if(!b||!lh(a,b)){a.effectTag=a.effectTag&-1025|2;Wa=!1;ra=a;return}kh(ra,c)}ra=a;Ka=kb(b.firstChild)}else a.effectTag=a.effectTag&-1025|2,Wa=!1,ra=a}}function mh(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag&&13!==a.tag;)a=a.return;ra=a}function Zc(a){if(a!==ra)return!1;if(!Wa)return mh(a),Wa=!0,!1;var b=a.type;if(5!==a.tag||"head"!==b&&"body"!==
b&&!Yd(b,a.memoizedProps))for(b=Ka;b;)kh(a,b),b=kb(b.nextSibling);mh(a);if(13===a.tag){a=a.memoizedState;a=null!==a?a.dehydrated:null;if(!a)throw Error(k(317));a:{a=a.nextSibling;for(b=0;a;){if(8===a.nodeType){var c=a.data;if(c===og){if(0===b){Ka=kb(a.nextSibling);break a}b--}else c!==ng&&c!==Zd&&c!==$d||b++}a=a.nextSibling}Ka=null}}else Ka=ra?kb(a.stateNode.nextSibling):null;return!0}function Ee(){Ka=ra=null;Wa=!1}function T(a,b,c,d){b.child=null===a?Fe(b,null,c,d):wb(b,a.child,c,d)}function nh(a,
b,c,d,e){c=c.render;var f=b.ref;rb(b,e);d=we(a,b,c,d,f,e);if(null!==a&&!ia)return b.updateQueue=a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),sa(a,b,e);b.effectTag|=1;T(a,b,d,e);return b.child}function oh(a,b,c,d,e,f){if(null===a){var g=c.type;if("function"===typeof g&&!Ge(g)&&void 0===g.defaultProps&&null===c.compare&&void 0===c.defaultProps)return b.tag=15,b.type=g,ph(a,b,g,d,e,f);a=Oc(c.type,null,d,null,b.mode,f);a.ref=b.ref;a.return=b;return b.child=a}g=a.child;if(e<
f&&(e=g.memoizedProps,c=c.compare,c=null!==c?c:Ob,c(e,d)&&a.ref===b.ref))return sa(a,b,f);b.effectTag|=1;a=Sa(g,d);a.ref=b.ref;a.return=b;return b.child=a}function ph(a,b,c,d,e,f){return null!==a&&Ob(a.memoizedProps,d)&&a.ref===b.ref&&(ia=!1,e<f)?(b.expirationTime=a.expirationTime,sa(a,b,f)):He(a,b,c,d,f)}function qh(a,b){var c=b.ref;if(null===a&&null!==c||null!==a&&a.ref!==c)b.effectTag|=128}function He(a,b,c,d,e){var f=N(c)?Ra:B.current;f=pb(b,f);rb(b,e);c=we(a,b,c,d,f,e);if(null!==a&&!ia)return b.updateQueue=
a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),sa(a,b,e);b.effectTag|=1;T(a,b,c,e);return b.child}function rh(a,b,c,d,e){if(N(c)){var f=!0;Bc(b)}else f=!1;rb(b,e);if(null===b.stateNode)null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),Yg(b,c,d),pe(b,c,d,e),d=!0;else if(null===a){var g=b.stateNode,h=b.memoizedProps;g.props=h;var m=g.context,n=c.contextType;"object"===typeof n&&null!==n?n=W(n):(n=N(c)?Ra:B.current,n=pb(b,n));var l=c.getDerivedStateFromProps,k="function"===
typeof l||"function"===typeof g.getSnapshotBeforeUpdate;k||"function"!==typeof g.UNSAFE_componentWillReceiveProps&&"function"!==typeof g.componentWillReceiveProps||(h!==d||m!==n)&&Zg(b,g,d,n);Ga=!1;var p=b.memoizedState;g.state=p;Qb(b,d,g,e);m=b.memoizedState;h!==d||p!==m||G.current||Ga?("function"===typeof l&&(Lc(b,c,l,d),m=b.memoizedState),(h=Ga||Xg(b,c,h,d,p,m,n))?(k||"function"!==typeof g.UNSAFE_componentWillMount&&"function"!==typeof g.componentWillMount||("function"===typeof g.componentWillMount&&
g.componentWillMount(),"function"===typeof g.UNSAFE_componentWillMount&&g.UNSAFE_componentWillMount()),"function"===typeof g.componentDidMount&&(b.effectTag|=4)):("function"===typeof g.componentDidMount&&(b.effectTag|=4),b.memoizedProps=d,b.memoizedState=m),g.props=d,g.state=m,g.context=n,d=h):("function"===typeof g.componentDidMount&&(b.effectTag|=4),d=!1)}else g=b.stateNode,oe(a,b),h=b.memoizedProps,g.props=b.type===b.elementType?h:aa(b.type,h),m=g.context,n=c.contextType,"object"===typeof n&&null!==
n?n=W(n):(n=N(c)?Ra:B.current,n=pb(b,n)),l=c.getDerivedStateFromProps,(k="function"===typeof l||"function"===typeof g.getSnapshotBeforeUpdate)||"function"!==typeof g.UNSAFE_componentWillReceiveProps&&"function"!==typeof g.componentWillReceiveProps||(h!==d||m!==n)&&Zg(b,g,d,n),Ga=!1,m=b.memoizedState,g.state=m,Qb(b,d,g,e),p=b.memoizedState,h!==d||m!==p||G.current||Ga?("function"===typeof l&&(Lc(b,c,l,d),p=b.memoizedState),(l=Ga||Xg(b,c,h,d,m,p,n))?(k||"function"!==typeof g.UNSAFE_componentWillUpdate&&
"function"!==typeof g.componentWillUpdate||("function"===typeof g.componentWillUpdate&&g.componentWillUpdate(d,p,n),"function"===typeof g.UNSAFE_componentWillUpdate&&g.UNSAFE_componentWillUpdate(d,p,n)),"function"===typeof g.componentDidUpdate&&(b.effectTag|=4),"function"===typeof g.getSnapshotBeforeUpdate&&(b.effectTag|=256)):("function"!==typeof g.componentDidUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=4),"function"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&m===
a.memoizedState||(b.effectTag|=256),b.memoizedProps=d,b.memoizedState=p),g.props=d,g.state=p,g.context=n,d=l):("function"!==typeof g.componentDidUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=4),"function"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=256),d=!1);return Ie(a,b,c,d,f,e)}function Ie(a,b,c,d,e,f){qh(a,b);var g=0!==(b.effectTag&64);if(!d&&!g)return e&&Hg(b,c,!1),sa(a,b,f);d=b.stateNode;gj.current=b;var h=g&&"function"!==typeof c.getDerivedStateFromError?
null:d.render();b.effectTag|=1;null!==a&&g?(b.child=wb(b,a.child,null,f),b.child=wb(b,null,h,f)):T(a,b,h,f);b.memoizedState=d.state;e&&Hg(b,c,!0);return b.child}function sh(a){var b=a.stateNode;b.pendingContext?Fg(a,b.pendingContext,b.pendingContext!==b.context):b.context&&Fg(a,b.context,!1);se(a,b.containerInfo)}function th(a,b,c){var d=b.mode,e=b.pendingProps,f=D.current,g=!1,h;(h=0!==(b.effectTag&64))||(h=0!==(f&2)&&(null===a||null!==a.memoizedState));h?(g=!0,b.effectTag&=-65):null!==a&&null===
a.memoizedState||void 0===e.fallback||!0===e.unstable_avoidThisFallback||(f|=1);y(D,f&1);if(null===a){void 0!==e.fallback&&De(b);if(g){g=e.fallback;e=Ha(null,d,0,null);e.return=b;if(0===(b.mode&2))for(a=null!==b.memoizedState?b.child.child:b.child,e.child=a;null!==a;)a.return=e,a=a.sibling;c=Ha(g,d,c,null);c.return=b;e.sibling=c;b.memoizedState=Je;b.child=e;return c}d=e.children;b.memoizedState=null;return b.child=Fe(b,null,d,c)}if(null!==a.memoizedState){a=a.child;d=a.sibling;if(g){e=e.fallback;
c=Sa(a,a.pendingProps);c.return=b;if(0===(b.mode&2)&&(g=null!==b.memoizedState?b.child.child:b.child,g!==a.child))for(c.child=g;null!==g;)g.return=c,g=g.sibling;d=Sa(d,e);d.return=b;c.sibling=d;c.childExpirationTime=0;b.memoizedState=Je;b.child=c;return d}c=wb(b,a.child,e.children,c);b.memoizedState=null;return b.child=c}a=a.child;if(g){g=e.fallback;e=Ha(null,d,0,null);e.return=b;e.child=a;null!==a&&(a.return=e);if(0===(b.mode&2))for(a=null!==b.memoizedState?b.child.child:b.child,e.child=a;null!==
a;)a.return=e,a=a.sibling;c=Ha(g,d,c,null);c.return=b;e.sibling=c;c.effectTag|=2;e.childExpirationTime=0;b.memoizedState=Je;b.child=e;return c}b.memoizedState=null;return b.child=wb(b,a,e.children,c)}function uh(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);Sg(a.return,b)}function Ke(a,b,c,d,e,f){var g=a.memoizedState;null===g?a.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:d,tail:c,tailExpiration:0,tailMode:e,
lastEffect:f}:(g.isBackwards=b,g.rendering=null,g.renderingStartTime=0,g.last=d,g.tail=c,g.tailExpiration=0,g.tailMode=e,g.lastEffect=f)}function vh(a,b,c){var d=b.pendingProps,e=d.revealOrder,f=d.tail;T(a,b,d.children,c);d=D.current;if(0!==(d&2))d=d&1|2,b.effectTag|=64;else{if(null!==a&&0!==(a.effectTag&64))a:for(a=b.child;null!==a;){if(13===a.tag)null!==a.memoizedState&&uh(a,c);else if(19===a.tag)uh(a,c);else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===b)break a;for(;null===a.sibling;){if(null===
a.return||a.return===b)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}d&=1}y(D,d);if(0===(b.mode&2))b.memoizedState=null;else switch(e){case "forwards":c=b.child;for(e=null;null!==c;)a=c.alternate,null!==a&&null===Rc(a)&&(e=c),c=c.sibling;c=e;null===c?(e=b.child,b.child=null):(e=c.sibling,c.sibling=null);Ke(b,!1,e,c,f,b.lastEffect);break;case "backwards":c=null;e=b.child;for(b.child=null;null!==e;){a=e.alternate;if(null!==a&&null===Rc(a)){b.child=e;break}a=e.sibling;e.sibling=c;c=e;e=a}Ke(b,
!0,c,null,f,b.lastEffect);break;case "together":Ke(b,!1,null,null,void 0,b.lastEffect);break;default:b.memoizedState=null}return b.child}function sa(a,b,c){null!==a&&(b.dependencies=a.dependencies);var d=b.expirationTime;0!==d&&Kc(d);if(b.childExpirationTime<c)return null;if(null!==a&&b.child!==a.child)throw Error(k(153));if(null!==b.child){a=b.child;c=Sa(a,a.pendingProps);b.child=c;for(c.return=b;null!==a.sibling;)a=a.sibling,c=c.sibling=Sa(a,a.pendingProps),c.return=b;c.sibling=null}return b.child}
function $c(a,b){switch(a.tailMode){case "hidden":b=a.tail;for(var c=null;null!==b;)null!==b.alternate&&(c=b),b=b.sibling;null===c?a.tail=null:c.sibling=null;break;case "collapsed":c=a.tail;for(var d=null;null!==c;)null!==c.alternate&&(d=c),c=c.sibling;null===d?b||null===a.tail?a.tail=null:a.tail.sibling=null:d.sibling=null}}function hj(a,b,c){var d=b.pendingProps;switch(b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return N(b.type)&&(q(G),q(B)),
null;case 3:return tb(),q(G),q(B),c=b.stateNode,c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),null!==a&&null!==a.child||!Zc(b)||(b.effectTag|=4),wh(b),null;case 5:te(b);c=Ta(Tb.current);var e=b.type;if(null!==a&&null!=b.stateNode)ij(a,b,e,d,c),a.ref!==b.ref&&(b.effectTag|=128);else{if(!d){if(null===b.stateNode)throw Error(k(166));return null}a=Ta(ja.current);if(Zc(b)){d=b.stateNode;e=b.type;var f=b.memoizedProps;d[Aa]=b;d[vc]=f;switch(e){case "iframe":case "object":case "embed":w("load",
d);break;case "video":case "audio":for(a=0;a<Db.length;a++)w(Db[a],d);break;case "source":w("error",d);break;case "img":case "image":case "link":w("error",d);w("load",d);break;case "form":w("reset",d);w("submit",d);break;case "details":w("toggle",d);break;case "input":Hf(d,f);w("invalid",d);oa(c,"onChange");break;case "select":d._wrapperState={wasMultiple:!!f.multiple};w("invalid",d);oa(c,"onChange");break;case "textarea":Kf(d,f),w("invalid",d),oa(c,"onChange")}Ud(e,f);a=null;for(var g in f)if(f.hasOwnProperty(g)){var h=
f[g];"children"===g?"string"===typeof h?d.textContent!==h&&(a=["children",h]):"number"===typeof h&&d.textContent!==""+h&&(a=["children",""+h]):db.hasOwnProperty(g)&&null!=h&&oa(c,g)}switch(e){case "input":mc(d);Jf(d,f,!0);break;case "textarea":mc(d);Mf(d);break;case "select":case "option":break;default:"function"===typeof f.onClick&&(d.onclick=uc)}c=a;b.updateQueue=c;null!==c&&(b.effectTag|=4)}else{g=9===c.nodeType?c:c.ownerDocument;"http://www.w3.org/1999/xhtml"===a&&(a=Nf(e));"http://www.w3.org/1999/xhtml"===
a?"script"===e?(a=g.createElement("div"),a.innerHTML="<script>\x3c/script>",a=a.removeChild(a.firstChild)):"string"===typeof d.is?a=g.createElement(e,{is:d.is}):(a=g.createElement(e),"select"===e&&(g=a,d.multiple?g.multiple=!0:d.size&&(g.size=d.size))):a=g.createElementNS(a,e);a[Aa]=b;a[vc]=d;jj(a,b,!1,!1);b.stateNode=a;g=Vd(e,d);switch(e){case "iframe":case "object":case "embed":w("load",a);h=d;break;case "video":case "audio":for(h=0;h<Db.length;h++)w(Db[h],a);h=d;break;case "source":w("error",a);
h=d;break;case "img":case "image":case "link":w("error",a);w("load",a);h=d;break;case "form":w("reset",a);w("submit",a);h=d;break;case "details":w("toggle",a);h=d;break;case "input":Hf(a,d);h=Cd(a,d);w("invalid",a);oa(c,"onChange");break;case "option":h=Fd(a,d);break;case "select":a._wrapperState={wasMultiple:!!d.multiple};h=M({},d,{value:void 0});w("invalid",a);oa(c,"onChange");break;case "textarea":Kf(a,d);h=Gd(a,d);w("invalid",a);oa(c,"onChange");break;default:h=d}Ud(e,h);var m=h;for(f in m)if(m.hasOwnProperty(f)){var n=
m[f];"style"===f?gg(a,n):"dangerouslySetInnerHTML"===f?(n=n?n.__html:void 0,null!=n&&xh(a,n)):"children"===f?"string"===typeof n?("textarea"!==e||""!==n)&&Wb(a,n):"number"===typeof n&&Wb(a,""+n):"suppressContentEditableWarning"!==f&&"suppressHydrationWarning"!==f&&"autoFocus"!==f&&(db.hasOwnProperty(f)?null!=n&&oa(c,f):null!=n&&xd(a,f,n,g))}switch(e){case "input":mc(a);Jf(a,d,!1);break;case "textarea":mc(a);Mf(a);break;case "option":null!=d.value&&a.setAttribute("value",""+va(d.value));break;case "select":a.multiple=
!!d.multiple;c=d.value;null!=c?hb(a,!!d.multiple,c,!1):null!=d.defaultValue&&hb(a,!!d.multiple,d.defaultValue,!0);break;default:"function"===typeof h.onClick&&(a.onclick=uc)}lg(e,d)&&(b.effectTag|=4)}null!==b.ref&&(b.effectTag|=128)}return null;case 6:if(a&&null!=b.stateNode)kj(a,b,a.memoizedProps,d);else{if("string"!==typeof d&&null===b.stateNode)throw Error(k(166));c=Ta(Tb.current);Ta(ja.current);Zc(b)?(c=b.stateNode,d=b.memoizedProps,c[Aa]=b,c.nodeValue!==d&&(b.effectTag|=4)):(c=(9===c.nodeType?
c:c.ownerDocument).createTextNode(d),c[Aa]=b,b.stateNode=c)}return null;case 13:q(D);d=b.memoizedState;if(0!==(b.effectTag&64))return b.expirationTime=c,b;c=null!==d;d=!1;null===a?void 0!==b.memoizedProps.fallback&&Zc(b):(e=a.memoizedState,d=null!==e,c||null===e||(e=a.child.sibling,null!==e&&(f=b.firstEffect,null!==f?(b.firstEffect=e,e.nextEffect=f):(b.firstEffect=b.lastEffect=e,e.nextEffect=null),e.effectTag=8)));if(c&&!d&&0!==(b.mode&2))if(null===a&&!0!==b.memoizedProps.unstable_avoidThisFallback||
0!==(D.current&1))F===Xa&&(F=ad);else{if(F===Xa||F===ad)F=bd;0!==Xb&&null!==U&&(Ya(U,P),yh(U,Xb))}if(c||d)b.effectTag|=4;return null;case 4:return tb(),wh(b),null;case 10:return me(b),null;case 17:return N(b.type)&&(q(G),q(B)),null;case 19:q(D);d=b.memoizedState;if(null===d)return null;e=0!==(b.effectTag&64);f=d.rendering;if(null===f)if(e)$c(d,!1);else{if(F!==Xa||null!==a&&0!==(a.effectTag&64))for(f=b.child;null!==f;){a=Rc(f);if(null!==a){b.effectTag|=64;$c(d,!1);e=a.updateQueue;null!==e&&(b.updateQueue=
e,b.effectTag|=4);null===d.lastEffect&&(b.firstEffect=null);b.lastEffect=d.lastEffect;for(d=b.child;null!==d;)e=d,f=c,e.effectTag&=2,e.nextEffect=null,e.firstEffect=null,e.lastEffect=null,a=e.alternate,null===a?(e.childExpirationTime=0,e.expirationTime=f,e.child=null,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null):(e.childExpirationTime=a.childExpirationTime,e.expirationTime=a.expirationTime,e.child=a.child,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,
e.updateQueue=a.updateQueue,f=a.dependencies,e.dependencies=null===f?null:{expirationTime:f.expirationTime,firstContext:f.firstContext,responders:f.responders}),d=d.sibling;y(D,D.current&1|2);return b.child}f=f.sibling}}else{if(!e)if(a=Rc(f),null!==a){if(b.effectTag|=64,e=!0,c=a.updateQueue,null!==c&&(b.updateQueue=c,b.effectTag|=4),$c(d,!0),null===d.tail&&"hidden"===d.tailMode&&!f.alternate)return b=b.lastEffect=d.lastEffect,null!==b&&(b.nextEffect=null),null}else 2*Y()-d.renderingStartTime>d.tailExpiration&&
1<c&&(b.effectTag|=64,e=!0,$c(d,!1),b.expirationTime=b.childExpirationTime=c-1);d.isBackwards?(f.sibling=b.child,b.child=f):(c=d.last,null!==c?c.sibling=f:b.child=f,d.last=f)}return null!==d.tail?(0===d.tailExpiration&&(d.tailExpiration=Y()+500),c=d.tail,d.rendering=c,d.tail=c.sibling,d.lastEffect=b.lastEffect,d.renderingStartTime=Y(),c.sibling=null,b=D.current,y(D,e?b&1|2:b&1),c):null}throw Error(k(156,b.tag));}function lj(a,b){switch(a.tag){case 1:return N(a.type)&&(q(G),q(B)),b=a.effectTag,b&4096?
(a.effectTag=b&-4097|64,a):null;case 3:tb();q(G);q(B);b=a.effectTag;if(0!==(b&64))throw Error(k(285));a.effectTag=b&-4097|64;return a;case 5:return te(a),null;case 13:return q(D),b=a.effectTag,b&4096?(a.effectTag=b&-4097|64,a):null;case 19:return q(D),null;case 4:return tb(),null;case 10:return me(a),null;default:return null}}function Le(a,b){return{value:a,source:b,stack:Bd(b)}}function Me(a,b){var c=b.source,d=b.stack;null===d&&null!==c&&(d=Bd(c));null!==c&&na(c.type);b=b.value;null!==a&&1===a.tag&&
na(a.type);try{console.error(b)}catch(e){setTimeout(function(){throw e;})}}function mj(a,b){try{b.props=a.memoizedProps,b.state=a.memoizedState,b.componentWillUnmount()}catch(c){Za(a,c)}}function zh(a){var b=a.ref;if(null!==b)if("function"===typeof b)try{b(null)}catch(c){Za(a,c)}else b.current=null}function nj(a,b){switch(b.tag){case 0:case 11:case 15:case 22:return;case 1:if(b.effectTag&256&&null!==a){var c=a.memoizedProps,d=a.memoizedState;a=b.stateNode;b=a.getSnapshotBeforeUpdate(b.elementType===
b.type?c:aa(b.type,c),d);a.__reactInternalSnapshotBeforeUpdate=b}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(k(163));}function Ah(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.destroy;c.destroy=void 0;void 0!==d&&d()}c=c.next}while(c!==b)}}function Bh(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.create;c.destroy=d()}c=c.next}while(c!==b)}}function oj(a,b,c,d){switch(c.tag){case 0:case 11:case 15:case 22:Bh(3,
c);return;case 1:a=c.stateNode;c.effectTag&4&&(null===b?a.componentDidMount():(d=c.elementType===c.type?b.memoizedProps:aa(c.type,b.memoizedProps),a.componentDidUpdate(d,b.memoizedState,a.__reactInternalSnapshotBeforeUpdate)));b=c.updateQueue;null!==b&&Wg(c,b,a);return;case 3:b=c.updateQueue;if(null!==b){a=null;if(null!==c.child)switch(c.child.tag){case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}Wg(c,b,a)}return;case 5:a=c.stateNode;null===b&&c.effectTag&4&&lg(c.type,c.memoizedProps)&&
a.focus();return;case 6:return;case 4:return;case 12:return;case 13:null===c.memoizedState&&(c=c.alternate,null!==c&&(c=c.memoizedState,null!==c&&(c=c.dehydrated,null!==c&&bg(c))));return;case 19:case 17:case 20:case 21:return}throw Error(k(163));}function Ch(a,b,c){"function"===typeof Ne&&Ne(b);switch(b.tag){case 0:case 11:case 14:case 15:case 22:a=b.updateQueue;if(null!==a&&(a=a.lastEffect,null!==a)){var d=a.next;Da(97<c?97:c,function(){var a=d;do{var c=a.destroy;if(void 0!==c){var g=b;try{c()}catch(h){Za(g,
h)}}a=a.next}while(a!==d)})}break;case 1:zh(b);c=b.stateNode;"function"===typeof c.componentWillUnmount&&mj(b,c);break;case 5:zh(b);break;case 4:Dh(a,b,c)}}function Eh(a){var b=a.alternate;a.return=null;a.child=null;a.memoizedState=null;a.updateQueue=null;a.dependencies=null;a.alternate=null;a.firstEffect=null;a.lastEffect=null;a.pendingProps=null;a.memoizedProps=null;a.stateNode=null;null!==b&&Eh(b)}function Fh(a){return 5===a.tag||3===a.tag||4===a.tag}function Gh(a){a:{for(var b=a.return;null!==
b;){if(Fh(b)){var c=b;break a}b=b.return}throw Error(k(160));}b=c.stateNode;switch(c.tag){case 5:var d=!1;break;case 3:b=b.containerInfo;d=!0;break;case 4:b=b.containerInfo;d=!0;break;default:throw Error(k(161));}c.effectTag&16&&(Wb(b,""),c.effectTag&=-17);a:b:for(c=a;;){for(;null===c.sibling;){if(null===c.return||Fh(c.return)){c=null;break a}c=c.return}c.sibling.return=c.return;for(c=c.sibling;5!==c.tag&&6!==c.tag&&18!==c.tag;){if(c.effectTag&2)continue b;if(null===c.child||4===c.tag)continue b;
else c.child.return=c,c=c.child}if(!(c.effectTag&2)){c=c.stateNode;break a}}d?Oe(a,c,b):Pe(a,c,b)}function Oe(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?8===c.nodeType?c.parentNode.insertBefore(a,b):c.insertBefore(a,b):(8===c.nodeType?(b=c.parentNode,b.insertBefore(a,c)):(b=c,b.appendChild(a)),c=c._reactRootContainer,null!==c&&void 0!==c||null!==b.onclick||(b.onclick=uc));else if(4!==d&&(a=a.child,null!==a))for(Oe(a,b,c),a=a.sibling;null!==a;)Oe(a,b,c),a=a.sibling}
function Pe(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?c.insertBefore(a,b):c.appendChild(a);else if(4!==d&&(a=a.child,null!==a))for(Pe(a,b,c),a=a.sibling;null!==a;)Pe(a,b,c),a=a.sibling}function Dh(a,b,c){for(var d=b,e=!1,f,g;;){if(!e){e=d.return;a:for(;;){if(null===e)throw Error(k(160));f=e.stateNode;switch(e.tag){case 5:g=!1;break a;case 3:f=f.containerInfo;g=!0;break a;case 4:f=f.containerInfo;g=!0;break a}e=e.return}e=!0}if(5===d.tag||6===d.tag){a:for(var h=
a,m=d,n=c,l=m;;)if(Ch(h,l,n),null!==l.child&&4!==l.tag)l.child.return=l,l=l.child;else{if(l===m)break a;for(;null===l.sibling;){if(null===l.return||l.return===m)break a;l=l.return}l.sibling.return=l.return;l=l.sibling}g?(h=f,m=d.stateNode,8===h.nodeType?h.parentNode.removeChild(m):h.removeChild(m)):f.removeChild(d.stateNode)}else if(4===d.tag){if(null!==d.child){f=d.stateNode.containerInfo;g=!0;d.child.return=d;d=d.child;continue}}else if(Ch(a,d,c),null!==d.child){d.child.return=d;d=d.child;continue}if(d===
b)break;for(;null===d.sibling;){if(null===d.return||d.return===b)return;d=d.return;4===d.tag&&(e=!1)}d.sibling.return=d.return;d=d.sibling}}function Qe(a,b){switch(b.tag){case 0:case 11:case 14:case 15:case 22:Ah(3,b);return;case 1:return;case 5:var c=b.stateNode;if(null!=c){var d=b.memoizedProps,e=null!==a?a.memoizedProps:d;a=b.type;var f=b.updateQueue;b.updateQueue=null;if(null!==f){c[vc]=d;"input"===a&&"radio"===d.type&&null!=d.name&&If(c,d);Vd(a,e);b=Vd(a,d);for(e=0;e<f.length;e+=2){var g=f[e],
h=f[e+1];"style"===g?gg(c,h):"dangerouslySetInnerHTML"===g?xh(c,h):"children"===g?Wb(c,h):xd(c,g,h,b)}switch(a){case "input":Dd(c,d);break;case "textarea":Lf(c,d);break;case "select":b=c._wrapperState.wasMultiple,c._wrapperState.wasMultiple=!!d.multiple,a=d.value,null!=a?hb(c,!!d.multiple,a,!1):b!==!!d.multiple&&(null!=d.defaultValue?hb(c,!!d.multiple,d.defaultValue,!0):hb(c,!!d.multiple,d.multiple?[]:"",!1))}}}return;case 6:if(null===b.stateNode)throw Error(k(162));b.stateNode.nodeValue=b.memoizedProps;
return;case 3:b=b.stateNode;b.hydrate&&(b.hydrate=!1,bg(b.containerInfo));return;case 12:return;case 13:c=b;null===b.memoizedState?d=!1:(d=!0,c=b.child,Re=Y());if(null!==c)a:for(a=c;;){if(5===a.tag)f=a.stateNode,d?(f=f.style,"function"===typeof f.setProperty?f.setProperty("display","none","important"):f.display="none"):(f=a.stateNode,e=a.memoizedProps.style,e=void 0!==e&&null!==e&&e.hasOwnProperty("display")?e.display:null,f.style.display=fg("display",e));else if(6===a.tag)a.stateNode.nodeValue=d?
"":a.memoizedProps;else if(13===a.tag&&null!==a.memoizedState&&null===a.memoizedState.dehydrated){f=a.child.sibling;f.return=a;a=f;continue}else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===c)break;for(;null===a.sibling;){if(null===a.return||a.return===c)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}Hh(b);return;case 19:Hh(b);return;case 17:return}throw Error(k(163));}function Hh(a){var b=a.updateQueue;if(null!==b){a.updateQueue=null;var c=a.stateNode;null===c&&(c=a.stateNode=
new pj);b.forEach(function(b){var d=qj.bind(null,a,b);c.has(b)||(c.add(b),b.then(d,d))})}}function Ih(a,b,c){c=Ea(c,null);c.tag=3;c.payload={element:null};var d=b.value;c.callback=function(){cd||(cd=!0,Se=d);Me(a,b)};return c}function Jh(a,b,c){c=Ea(c,null);c.tag=3;var d=a.type.getDerivedStateFromError;if("function"===typeof d){var e=b.value;c.payload=function(){Me(a,b);return d(e)}}var f=a.stateNode;null!==f&&"function"===typeof f.componentDidCatch&&(c.callback=function(){"function"!==typeof d&&
(null===La?La=new Set([this]):La.add(this),Me(a,b));var c=b.stack;this.componentDidCatch(b.value,{componentStack:null!==c?c:""})});return c}function ka(){return(p&(ca|ma))!==H?1073741821-(Y()/10|0):0!==dd?dd:dd=1073741821-(Y()/10|0)}function Va(a,b,c){b=b.mode;if(0===(b&2))return 1073741823;var d=Cc();if(0===(b&4))return 99===d?1073741823:1073741822;if((p&ca)!==H)return P;if(null!==c)a=Fc(a,c.timeoutMs|0||5E3,250);else switch(d){case 99:a=1073741823;break;case 98:a=Fc(a,150,100);break;case 97:case 96:a=
Fc(a,5E3,250);break;case 95:a=2;break;default:throw Error(k(326));}null!==U&&a===P&&--a;return a}function ed(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);var d=a.return,e=null;if(null===d&&3===a.tag)e=a.stateNode;else for(;null!==d;){c=d.alternate;d.childExpirationTime<b&&(d.childExpirationTime=b);null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);if(null===d.return&&3===d.tag){e=d.stateNode;break}d=d.return}null!==e&&
(U===e&&(Kc(b),F===bd&&Ya(e,P)),yh(e,b));return e}function fd(a){var b=a.lastExpiredTime;if(0!==b)return b;b=a.firstPendingTime;if(!Kh(a,b))return b;var c=a.lastPingedTime;a=a.nextKnownPendingLevel;a=c>a?c:a;return 2>=a&&b!==a?0:a}function V(a){if(0!==a.lastExpiredTime)a.callbackExpirationTime=1073741823,a.callbackPriority=99,a.callbackNode=Og(Te.bind(null,a));else{var b=fd(a),c=a.callbackNode;if(0===b)null!==c&&(a.callbackNode=null,a.callbackExpirationTime=0,a.callbackPriority=90);else{var d=ka();
1073741823===b?d=99:1===b||2===b?d=95:(d=10*(1073741821-b)-10*(1073741821-d),d=0>=d?99:250>=d?98:5250>=d?97:95);if(null!==c){var e=a.callbackPriority;if(a.callbackExpirationTime===b&&e>=d)return;c!==Qg&&Rg(c)}a.callbackExpirationTime=b;a.callbackPriority=d;b=1073741823===b?Og(Te.bind(null,a)):Ng(d,Lh.bind(null,a),{timeout:10*(1073741821-b)-Y()});a.callbackNode=b}}}function Lh(a,b){dd=0;if(b)return b=ka(),Ue(a,b),V(a),null;var c=fd(a);if(0!==c){b=a.callbackNode;if((p&(ca|ma))!==H)throw Error(k(327));
xb();a===U&&c===P||$a(a,c);if(null!==t){var d=p;p|=ca;var e=Mh();do try{rj();break}catch(h){Nh(a,h)}while(1);le();p=d;gd.current=e;if(F===hd)throw b=id,$a(a,c),Ya(a,c),V(a),b;if(null===t)switch(e=a.finishedWork=a.current.alternate,a.finishedExpirationTime=c,d=F,U=null,d){case Xa:case hd:throw Error(k(345));case Oh:Ue(a,2<c?2:c);break;case ad:Ya(a,c);d=a.lastSuspendedTime;c===d&&(a.nextKnownPendingLevel=Ve(e));if(1073741823===ta&&(e=Re+Ph-Y(),10<e)){if(jd){var f=a.lastPingedTime;if(0===f||f>=c){a.lastPingedTime=
c;$a(a,c);break}}f=fd(a);if(0!==f&&f!==c)break;if(0!==d&&d!==c){a.lastPingedTime=d;break}a.timeoutHandle=We(ab.bind(null,a),e);break}ab(a);break;case bd:Ya(a,c);d=a.lastSuspendedTime;c===d&&(a.nextKnownPendingLevel=Ve(e));if(jd&&(e=a.lastPingedTime,0===e||e>=c)){a.lastPingedTime=c;$a(a,c);break}e=fd(a);if(0!==e&&e!==c)break;if(0!==d&&d!==c){a.lastPingedTime=d;break}1073741823!==Yb?d=10*(1073741821-Yb)-Y():1073741823===ta?d=0:(d=10*(1073741821-ta)-5E3,e=Y(),c=10*(1073741821-c)-e,d=e-d,0>d&&(d=0),d=
(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3E3>d?3E3:4320>d?4320:1960*sj(d/1960))-d,c<d&&(d=c));if(10<d){a.timeoutHandle=We(ab.bind(null,a),d);break}ab(a);break;case Xe:if(1073741823!==ta&&null!==kd){f=ta;var g=kd;d=g.busyMinDurationMs|0;0>=d?d=0:(e=g.busyDelayMs|0,f=Y()-(10*(1073741821-f)-(g.timeoutMs|0||5E3)),d=f<=e?0:e+d-f);if(10<d){Ya(a,c);a.timeoutHandle=We(ab.bind(null,a),d);break}}ab(a);break;default:throw Error(k(329));}V(a);if(a.callbackNode===b)return Lh.bind(null,a)}}return null}function Te(a){var b=
a.lastExpiredTime;b=0!==b?b:1073741823;if((p&(ca|ma))!==H)throw Error(k(327));xb();a===U&&b===P||$a(a,b);if(null!==t){var c=p;p|=ca;var d=Mh();do try{tj();break}catch(e){Nh(a,e)}while(1);le();p=c;gd.current=d;if(F===hd)throw c=id,$a(a,b),Ya(a,b),V(a),c;if(null!==t)throw Error(k(261));a.finishedWork=a.current.alternate;a.finishedExpirationTime=b;U=null;ab(a);V(a)}return null}function uj(){if(null!==bb){var a=bb;bb=null;a.forEach(function(a,c){Ue(c,a);V(c)});ha()}}function Qh(a,b){var c=p;p|=1;try{return a(b)}finally{p=
c,p===H&&ha()}}function Rh(a,b){var c=p;p&=-2;p|=Ye;try{return a(b)}finally{p=c,p===H&&ha()}}function $a(a,b){a.finishedWork=null;a.finishedExpirationTime=0;var c=a.timeoutHandle;-1!==c&&(a.timeoutHandle=-1,vj(c));if(null!==t)for(c=t.return;null!==c;){var d=c;switch(d.tag){case 1:d=d.type.childContextTypes;null!==d&&void 0!==d&&(q(G),q(B));break;case 3:tb();q(G);q(B);break;case 5:te(d);break;case 4:tb();break;case 13:q(D);break;case 19:q(D);break;case 10:me(d)}c=c.return}U=a;t=Sa(a.current,null);
P=b;F=Xa;id=null;Yb=ta=1073741823;kd=null;Xb=0;jd=!1}function Nh(a,b){do{try{le();Sc.current=Tc;if(Uc)for(var c=z.memoizedState;null!==c;){var d=c.queue;null!==d&&(d.pending=null);c=c.next}Ia=0;J=K=z=null;Uc=!1;if(null===t||null===t.return)return F=hd,id=b,t=null;a:{var e=a,f=t.return,g=t,h=b;b=P;g.effectTag|=2048;g.firstEffect=g.lastEffect=null;if(null!==h&&"object"===typeof h&&"function"===typeof h.then){var m=h;if(0===(g.mode&2)){var n=g.alternate;n?(g.updateQueue=n.updateQueue,g.memoizedState=
n.memoizedState,g.expirationTime=n.expirationTime):(g.updateQueue=null,g.memoizedState=null)}var l=0!==(D.current&1),k=f;do{var p;if(p=13===k.tag){var q=k.memoizedState;if(null!==q)p=null!==q.dehydrated?!0:!1;else{var w=k.memoizedProps;p=void 0===w.fallback?!1:!0!==w.unstable_avoidThisFallback?!0:l?!1:!0}}if(p){var y=k.updateQueue;if(null===y){var r=new Set;r.add(m);k.updateQueue=r}else y.add(m);if(0===(k.mode&2)){k.effectTag|=64;g.effectTag&=-2981;if(1===g.tag)if(null===g.alternate)g.tag=17;else{var O=
Ea(1073741823,null);O.tag=Jc;Fa(g,O)}g.expirationTime=1073741823;break a}h=void 0;g=b;var v=e.pingCache;null===v?(v=e.pingCache=new wj,h=new Set,v.set(m,h)):(h=v.get(m),void 0===h&&(h=new Set,v.set(m,h)));if(!h.has(g)){h.add(g);var x=xj.bind(null,e,m,g);m.then(x,x)}k.effectTag|=4096;k.expirationTime=b;break a}k=k.return}while(null!==k);h=Error((na(g.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+
Bd(g))}F!==Xe&&(F=Oh);h=Le(h,g);k=f;do{switch(k.tag){case 3:m=h;k.effectTag|=4096;k.expirationTime=b;var A=Ih(k,m,b);Ug(k,A);break a;case 1:m=h;var u=k.type,B=k.stateNode;if(0===(k.effectTag&64)&&("function"===typeof u.getDerivedStateFromError||null!==B&&"function"===typeof B.componentDidCatch&&(null===La||!La.has(B)))){k.effectTag|=4096;k.expirationTime=b;var H=Jh(k,m,b);Ug(k,H);break a}}k=k.return}while(null!==k)}t=Sh(t)}catch(cj){b=cj;continue}break}while(1)}function Mh(a){a=gd.current;gd.current=
Tc;return null===a?Tc:a}function Vg(a,b){a<ta&&2<a&&(ta=a);null!==b&&a<Yb&&2<a&&(Yb=a,kd=b)}function Kc(a){a>Xb&&(Xb=a)}function tj(){for(;null!==t;)t=Th(t)}function rj(){for(;null!==t&&!yj();)t=Th(t)}function Th(a){var b=zj(a.alternate,a,P);a.memoizedProps=a.pendingProps;null===b&&(b=Sh(a));Uh.current=null;return b}function Sh(a){t=a;do{var b=t.alternate;a=t.return;if(0===(t.effectTag&2048)){b=hj(b,t,P);if(1===P||1!==t.childExpirationTime){for(var c=0,d=t.child;null!==d;){var e=d.expirationTime,
f=d.childExpirationTime;e>c&&(c=e);f>c&&(c=f);d=d.sibling}t.childExpirationTime=c}if(null!==b)return b;null!==a&&0===(a.effectTag&2048)&&(null===a.firstEffect&&(a.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==a.lastEffect&&(a.lastEffect.nextEffect=t.firstEffect),a.lastEffect=t.lastEffect),1<t.effectTag&&(null!==a.lastEffect?a.lastEffect.nextEffect=t:a.firstEffect=t,a.lastEffect=t))}else{b=lj(t);if(null!==b)return b.effectTag&=2047,b;null!==a&&(a.firstEffect=a.lastEffect=null,a.effectTag|=
2048)}b=t.sibling;if(null!==b)return b;t=a}while(null!==t);F===Xa&&(F=Xe);return null}function Ve(a){var b=a.expirationTime;a=a.childExpirationTime;return b>a?b:a}function ab(a){var b=Cc();Da(99,Aj.bind(null,a,b));return null}function Aj(a,b){do xb();while(null!==Zb);if((p&(ca|ma))!==H)throw Error(k(327));var c=a.finishedWork,d=a.finishedExpirationTime;if(null===c)return null;a.finishedWork=null;a.finishedExpirationTime=0;if(c===a.current)throw Error(k(177));a.callbackNode=null;a.callbackExpirationTime=
0;a.callbackPriority=90;a.nextKnownPendingLevel=0;var e=Ve(c);a.firstPendingTime=e;d<=a.lastSuspendedTime?a.firstSuspendedTime=a.lastSuspendedTime=a.nextKnownPendingLevel=0:d<=a.firstSuspendedTime&&(a.firstSuspendedTime=d-1);d<=a.lastPingedTime&&(a.lastPingedTime=0);d<=a.lastExpiredTime&&(a.lastExpiredTime=0);a===U&&(t=U=null,P=0);1<c.effectTag?null!==c.lastEffect?(c.lastEffect.nextEffect=c,e=c.firstEffect):e=c:e=c.firstEffect;if(null!==e){var f=p;p|=ma;Uh.current=null;Ze=tc;var g=kg();if(Xd(g)){if("selectionStart"in
g)var h={start:g.selectionStart,end:g.selectionEnd};else a:{h=(h=g.ownerDocument)&&h.defaultView||window;var m=h.getSelection&&h.getSelection();if(m&&0!==m.rangeCount){h=m.anchorNode;var n=m.anchorOffset,q=m.focusNode;m=m.focusOffset;try{h.nodeType,q.nodeType}catch(sb){h=null;break a}var ba=0,w=-1,y=-1,B=0,D=0,r=g,z=null;b:for(;;){for(var v;;){r!==h||0!==n&&3!==r.nodeType||(w=ba+n);r!==q||0!==m&&3!==r.nodeType||(y=ba+m);3===r.nodeType&&(ba+=r.nodeValue.length);if(null===(v=r.firstChild))break;z=r;
r=v}for(;;){if(r===g)break b;z===h&&++B===n&&(w=ba);z===q&&++D===m&&(y=ba);if(null!==(v=r.nextSibling))break;r=z;z=r.parentNode}r=v}h=-1===w||-1===y?null:{start:w,end:y}}else h=null}h=h||{start:0,end:0}}else h=null;$e={activeElementDetached:null,focusedElem:g,selectionRange:h};tc=!1;l=e;do try{Bj()}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);l=e;do try{for(g=a,h=b;null!==l;){var x=l.effectTag;x&16&&Wb(l.stateNode,"");if(x&128){var A=l.alternate;if(null!==A){var u=
A.ref;null!==u&&("function"===typeof u?u(null):u.current=null)}}switch(x&1038){case 2:Gh(l);l.effectTag&=-3;break;case 6:Gh(l);l.effectTag&=-3;Qe(l.alternate,l);break;case 1024:l.effectTag&=-1025;break;case 1028:l.effectTag&=-1025;Qe(l.alternate,l);break;case 4:Qe(l.alternate,l);break;case 8:n=l,Dh(g,n,h),Eh(n)}l=l.nextEffect}}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);u=$e;A=kg();x=u.focusedElem;h=u.selectionRange;if(A!==x&&x&&x.ownerDocument&&jg(x.ownerDocument.documentElement,
x)){null!==h&&Xd(x)&&(A=h.start,u=h.end,void 0===u&&(u=A),"selectionStart"in x?(x.selectionStart=A,x.selectionEnd=Math.min(u,x.value.length)):(u=(A=x.ownerDocument||document)&&A.defaultView||window,u.getSelection&&(u=u.getSelection(),n=x.textContent.length,g=Math.min(h.start,n),h=void 0===h.end?g:Math.min(h.end,n),!u.extend&&g>h&&(n=h,h=g,g=n),n=ig(x,g),q=ig(x,h),n&&q&&(1!==u.rangeCount||u.anchorNode!==n.node||u.anchorOffset!==n.offset||u.focusNode!==q.node||u.focusOffset!==q.offset)&&(A=A.createRange(),
A.setStart(n.node,n.offset),u.removeAllRanges(),g>h?(u.addRange(A),u.extend(q.node,q.offset)):(A.setEnd(q.node,q.offset),u.addRange(A))))));A=[];for(u=x;u=u.parentNode;)1===u.nodeType&&A.push({element:u,left:u.scrollLeft,top:u.scrollTop});"function"===typeof x.focus&&x.focus();for(x=0;x<A.length;x++)u=A[x],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}tc=!!Ze;$e=Ze=null;a.current=c;l=e;do try{for(x=a;null!==l;){var F=l.effectTag;F&36&&oj(x,l.alternate,l);if(F&128){A=void 0;var E=l.ref;if(null!==
E){var G=l.stateNode;switch(l.tag){case 5:A=G;break;default:A=G}"function"===typeof E?E(A):E.current=A}}l=l.nextEffect}}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);l=null;Cj();p=f}else a.current=c;if(ld)ld=!1,Zb=a,$b=b;else for(l=e;null!==l;)b=l.nextEffect,l.nextEffect=null,l=b;b=a.firstPendingTime;0===b&&(La=null);1073741823===b?a===af?ac++:(ac=0,af=a):ac=0;"function"===typeof bf&&bf(c.stateNode,d);V(a);if(cd)throw cd=!1,a=Se,Se=null,a;if((p&Ye)!==H)return null;
ha();return null}function Bj(){for(;null!==l;){var a=l.effectTag;0!==(a&256)&&nj(l.alternate,l);0===(a&512)||ld||(ld=!0,Ng(97,function(){xb();return null}));l=l.nextEffect}}function xb(){if(90!==$b){var a=97<$b?97:$b;$b=90;return Da(a,Dj)}}function Dj(){if(null===Zb)return!1;var a=Zb;Zb=null;if((p&(ca|ma))!==H)throw Error(k(331));var b=p;p|=ma;for(a=a.current.firstEffect;null!==a;){try{var c=a;if(0!==(c.effectTag&512))switch(c.tag){case 0:case 11:case 15:case 22:Ah(5,c),Bh(5,c)}}catch(d){if(null===
a)throw Error(k(330));Za(a,d)}c=a.nextEffect;a.nextEffect=null;a=c}p=b;ha();return!0}function Vh(a,b,c){b=Le(c,b);b=Ih(a,b,1073741823);Fa(a,b);a=ed(a,1073741823);null!==a&&V(a)}function Za(a,b){if(3===a.tag)Vh(a,a,b);else for(var c=a.return;null!==c;){if(3===c.tag){Vh(c,a,b);break}else if(1===c.tag){var d=c.stateNode;if("function"===typeof c.type.getDerivedStateFromError||"function"===typeof d.componentDidCatch&&(null===La||!La.has(d))){a=Le(b,a);a=Jh(c,a,1073741823);Fa(c,a);c=ed(c,1073741823);null!==
c&&V(c);break}}c=c.return}}function xj(a,b,c){var d=a.pingCache;null!==d&&d.delete(b);U===a&&P===c?F===bd||F===ad&&1073741823===ta&&Y()-Re<Ph?$a(a,P):jd=!0:Kh(a,c)&&(b=a.lastPingedTime,0!==b&&b<c||(a.lastPingedTime=c,V(a)))}function qj(a,b){var c=a.stateNode;null!==c&&c.delete(b);b=0;0===b&&(b=ka(),b=Va(b,a,null));a=ed(a,b);null!==a&&V(a)}function Ej(a){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(b.isDisabled||!b.supportsFiber)return!0;try{var c=
b.inject(a);bf=function(a,e){try{b.onCommitFiberRoot(c,a,void 0,64===(a.current.effectTag&64))}catch(f){}};Ne=function(a){try{b.onCommitFiberUnmount(c,a)}catch(e){}}}catch(d){}return!0}function Fj(a,b,c,d){this.tag=a;this.key=c;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=b;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.effectTag=0;this.lastEffect=this.firstEffect=this.nextEffect=
null;this.childExpirationTime=this.expirationTime=0;this.alternate=null}function Ge(a){a=a.prototype;return!(!a||!a.isReactComponent)}function Gj(a){if("function"===typeof a)return Ge(a)?1:0;if(void 0!==a&&null!==a){a=a.$$typeof;if(a===zd)return 11;if(a===Ad)return 14}return 2}function Sa(a,b){var c=a.alternate;null===c?(c=la(a.tag,b,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=b,c.effectTag=0,c.nextEffect=null,c.firstEffect=
null,c.lastEffect=null);c.childExpirationTime=a.childExpirationTime;c.expirationTime=a.expirationTime;c.child=a.child;c.memoizedProps=a.memoizedProps;c.memoizedState=a.memoizedState;c.updateQueue=a.updateQueue;b=a.dependencies;c.dependencies=null===b?null:{expirationTime:b.expirationTime,firstContext:b.firstContext,responders:b.responders};c.sibling=a.sibling;c.index=a.index;c.ref=a.ref;return c}function Oc(a,b,c,d,e,f){var g=2;d=a;if("function"===typeof a)Ge(a)&&(g=1);else if("string"===typeof a)g=
5;else a:switch(a){case Ma:return Ha(c.children,e,f,b);case Hj:g=8;e|=7;break;case Af:g=8;e|=1;break;case kc:return a=la(12,c,b,e|8),a.elementType=kc,a.type=kc,a.expirationTime=f,a;case lc:return a=la(13,c,b,e),a.type=lc,a.elementType=lc,a.expirationTime=f,a;case yd:return a=la(19,c,b,e),a.elementType=yd,a.expirationTime=f,a;default:if("object"===typeof a&&null!==a)switch(a.$$typeof){case Cf:g=10;break a;case Bf:g=9;break a;case zd:g=11;break a;case Ad:g=14;break a;case Ef:g=16;d=null;break a;case Df:g=
22;break a}throw Error(k(130,null==a?a:typeof a,""));}b=la(g,c,b,e);b.elementType=a;b.type=d;b.expirationTime=f;return b}function Ha(a,b,c,d){a=la(7,a,d,b);a.expirationTime=c;return a}function qe(a,b,c){a=la(6,a,null,b);a.expirationTime=c;return a}function re(a,b,c){b=la(4,null!==a.children?a.children:[],a.key,b);b.expirationTime=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}function Ij(a,b,c){this.tag=b;this.current=null;this.containerInfo=
a;this.pingCache=this.pendingChildren=null;this.finishedExpirationTime=0;this.finishedWork=null;this.timeoutHandle=-1;this.pendingContext=this.context=null;this.hydrate=c;this.callbackNode=null;this.callbackPriority=90;this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Kh(a,b){var c=a.firstSuspendedTime;a=a.lastSuspendedTime;return 0!==c&&c>=b&&a<=b}function Ya(a,b){var c=a.firstSuspendedTime,d=a.lastSuspendedTime;
c<b&&(a.firstSuspendedTime=b);if(d>b||0===c)a.lastSuspendedTime=b;b<=a.lastPingedTime&&(a.lastPingedTime=0);b<=a.lastExpiredTime&&(a.lastExpiredTime=0)}function yh(a,b){b>a.firstPendingTime&&(a.firstPendingTime=b);var c=a.firstSuspendedTime;0!==c&&(b>=c?a.firstSuspendedTime=a.lastSuspendedTime=a.nextKnownPendingLevel=0:b>=a.lastSuspendedTime&&(a.lastSuspendedTime=b+1),b>a.nextKnownPendingLevel&&(a.nextKnownPendingLevel=b))}function Ue(a,b){var c=a.lastExpiredTime;if(0===c||c>b)a.lastExpiredTime=b}
function md(a,b,c,d){var e=b.current,f=ka(),g=Vb.suspense;f=Va(f,e,g);a:if(c){c=c._reactInternalFiber;b:{if(Na(c)!==c||1!==c.tag)throw Error(k(170));var h=c;do{switch(h.tag){case 3:h=h.stateNode.context;break b;case 1:if(N(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break b}}h=h.return}while(null!==h);throw Error(k(171));}if(1===c.tag){var m=c.type;if(N(m)){c=Gg(c,m,h);break a}}c=h}else c=Ca;null===b.context?b.context=c:b.pendingContext=c;b=Ea(f,g);b.payload={element:a};d=void 0===
d?null:d;null!==d&&(b.callback=d);Fa(e,b);Ja(e,f);return f}function cf(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function Wh(a,b){a=a.memoizedState;null!==a&&null!==a.dehydrated&&a.retryTime<b&&(a.retryTime=b)}function df(a,b){Wh(a,b);(a=a.alternate)&&Wh(a,b)}function ef(a,b,c){c=null!=c&&!0===c.hydrate;var d=new Ij(a,b,c),e=la(3,null,null,2===b?7:1===b?3:0);d.current=e;e.stateNode=d;ne(e);a[Lb]=d.current;c&&0!==b&&
xi(a,9===a.nodeType?a:a.ownerDocument);this._internalRoot=d}function bc(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||" react-mount-point-unstable "!==a.nodeValue))}function Jj(a,b){b||(b=a?9===a.nodeType?a.documentElement:a.firstChild:null,b=!(!b||1!==b.nodeType||!b.hasAttribute("data-reactroot")));if(!b)for(var c;c=a.lastChild;)a.removeChild(c);return new ef(a,0,b?{hydrate:!0}:void 0)}function nd(a,b,c,d,e){var f=c._reactRootContainer;if(f){var g=f._internalRoot;
if("function"===typeof e){var h=e;e=function(){var a=cf(g);h.call(a)}}md(b,g,a,e)}else{f=c._reactRootContainer=Jj(c,d);g=f._internalRoot;if("function"===typeof e){var m=e;e=function(){var a=cf(g);m.call(a)}}Rh(function(){md(b,g,a,e)})}return cf(g)}function Kj(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:gb,key:null==d?null:""+d,children:a,containerInfo:b,implementation:c}}function Xh(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;
if(!bc(b))throw Error(k(200));return Kj(a,b,null,c)}if(!ea)throw Error(k(227));var ki=function(a,b,c,d,e,f,g,h,m){var n=Array.prototype.slice.call(arguments,3);try{b.apply(c,n)}catch(C){this.onError(C)}},yb=!1,gc=null,hc=!1,pd=null,li={onError:function(a){yb=!0;gc=a}},td=null,rf=null,mf=null,ic=null,cb={},jc=[],qd={},db={},rd={},wa=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),M=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.assign,
sd=null,eb=null,fb=null,ee=function(a,b){return a(b)},eg=function(a,b,c,d,e){return a(b,c,d,e)},vd=function(){},vf=ee,Oa=!1,wd=!1,Z=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Scheduler,Lj=Z.unstable_cancelCallback,ff=Z.unstable_now,$f=Z.unstable_scheduleCallback,Mj=Z.unstable_shouldYield,Yh=Z.unstable_requestPaint,Pd=Z.unstable_runWithPriority,Nj=Z.unstable_getCurrentPriorityLevel,Oj=Z.unstable_ImmediatePriority,Zh=Z.unstable_UserBlockingPriority,ag=Z.unstable_NormalPriority,Pj=Z.unstable_LowPriority,
Qj=Z.unstable_IdlePriority,oi=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wf=Object.prototype.hasOwnProperty,yf={},xf={},E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){E[a]=
new L(a,0,!1,a,null,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var b=a[0];E[b]=new L(b,1,!1,a[1],null,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(a){E[a]=new L(a,2,!1,a.toLowerCase(),null,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){E[a]=new L(a,2,!1,a,null,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){E[a]=
new L(a,3,!1,a.toLowerCase(),null,!1)});["checked","multiple","muted","selected"].forEach(function(a){E[a]=new L(a,3,!0,a,null,!1)});["capture","download"].forEach(function(a){E[a]=new L(a,4,!1,a,null,!1)});["cols","rows","size","span"].forEach(function(a){E[a]=new L(a,6,!1,a,null,!1)});["rowSpan","start"].forEach(function(a){E[a]=new L(a,5,!1,a.toLowerCase(),null,!1)});var gf=/[\-:]([a-z])/g,hf=function(a){return a[1].toUpperCase()};"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var b=
a.replace(gf,hf);E[b]=new L(b,1,!1,a,null,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var b=a.replace(gf,hf);E[b]=new L(b,1,!1,a,"http://www.w3.org/1999/xlink",!1)});["xml:base","xml:lang","xml:space"].forEach(function(a){var b=a.replace(gf,hf);E[b]=new L(b,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1)});["tabIndex","crossOrigin"].forEach(function(a){E[a]=new L(a,1,!1,a.toLowerCase(),null,!1)});E.xlinkHref=new L("xlinkHref",1,
!1,"xlink:href","http://www.w3.org/1999/xlink",!0);["src","href","action","formAction"].forEach(function(a){E[a]=new L(a,1,!1,a.toLowerCase(),null,!0)});var da=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;da.hasOwnProperty("ReactCurrentDispatcher")||(da.ReactCurrentDispatcher={current:null});da.hasOwnProperty("ReactCurrentBatchConfig")||(da.ReactCurrentBatchConfig={suspense:null});var si=/^(.*)[\\\/]/,Q="function"===typeof Symbol&&Symbol.for,Pc=Q?Symbol.for("react.element"):60103,gb=Q?Symbol.for("react.portal"):
60106,Ma=Q?Symbol.for("react.fragment"):60107,Af=Q?Symbol.for("react.strict_mode"):60108,kc=Q?Symbol.for("react.profiler"):60114,Cf=Q?Symbol.for("react.provider"):60109,Bf=Q?Symbol.for("react.context"):60110,Hj=Q?Symbol.for("react.concurrent_mode"):60111,zd=Q?Symbol.for("react.forward_ref"):60112,lc=Q?Symbol.for("react.suspense"):60113,yd=Q?Symbol.for("react.suspense_list"):60120,Ad=Q?Symbol.for("react.memo"):60115,Ef=Q?Symbol.for("react.lazy"):60116,Df=Q?Symbol.for("react.block"):60121,zf="function"===
typeof Symbol&&Symbol.iterator,od,xh=function(a){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if("http://www.w3.org/2000/svg"!==a.namespaceURI||"innerHTML"in a)a.innerHTML=b;else{od=od||document.createElement("div");od.innerHTML="<svg>"+b.valueOf().toString()+"</svg>";for(b=od.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}}),Wb=function(a,
b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b},ib={animationend:nc("Animation","AnimationEnd"),animationiteration:nc("Animation","AnimationIteration"),animationstart:nc("Animation","AnimationStart"),transitionend:nc("Transition","TransitionEnd")},Id={},Of={};wa&&(Of=document.createElement("div").style,"AnimationEvent"in window||(delete ib.animationend.animation,delete ib.animationiteration.animation,delete ib.animationstart.animation),"TransitionEvent"in
window||delete ib.transitionend.transition);var $h=oc("animationend"),ai=oc("animationiteration"),bi=oc("animationstart"),ci=oc("transitionend"),Db="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pf=new ("function"===typeof WeakMap?WeakMap:Map),Ab=null,wi=function(a){if(a){var b=a._dispatchListeners,c=a._dispatchInstances;
if(Array.isArray(b))for(var d=0;d<b.length&&!a.isPropagationStopped();d++)lf(a,b[d],c[d]);else b&&lf(a,b,c);a._dispatchListeners=null;a._dispatchInstances=null;a.isPersistent()||a.constructor.release(a)}},qc=[],Rd=!1,fa=[],xa=null,ya=null,za=null,Eb=new Map,Fb=new Map,Jb=[],Nd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),
yi="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" "),dg={},cg=new Map,Td=new Map,Rj=["abort","abort",$h,"animationEnd",ai,"animationIteration",bi,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata",
"loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",ci,"transitionEnd","waiting","waiting"];Sd("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),
0);Sd("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1);Sd(Rj,2);(function(a,b){for(var c=0;c<a.length;c++)Td.set(a[c],b)})("change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),0);var Hi=Zh,Gi=Pd,tc=!0,Kb={animationIterationCount:!0,
borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,
strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sj=["Webkit","ms","Moz","O"];Object.keys(Kb).forEach(function(a){Sj.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);Kb[b]=Kb[a]})});var Ii=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),ng="$",og="/$",$d="$?",Zd="$!",Ze=null,$e=null,We="function"===typeof setTimeout?setTimeout:void 0,vj="function"===
typeof clearTimeout?clearTimeout:void 0,jf=Math.random().toString(36).slice(2),Aa="__reactInternalInstance$"+jf,vc="__reactEventHandlers$"+jf,Lb="__reactContainere$"+jf,Ba=null,ce=null,wc=null;M(R.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():"unknown"!==typeof a.returnValue&&(a.returnValue=!1),this.isDefaultPrevented=xc)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():"unknown"!==
typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=xc)},persist:function(){this.isPersistent=xc},isPersistent:yc,destructor:function(){var a=this.constructor.Interface,b;for(b in a)this[b]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null;this.isPropagationStopped=this.isDefaultPrevented=yc;this._dispatchInstances=this._dispatchListeners=null}});R.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(a){return a.timeStamp||
Date.now()},defaultPrevented:null,isTrusted:null};R.extend=function(a){function b(){return c.apply(this,arguments)}var c=this,d=function(){};d.prototype=c.prototype;d=new d;M(d,b.prototype);b.prototype=d;b.prototype.constructor=b;b.Interface=M({},c.Interface,a);b.extend=c.extend;sg(b);return b};sg(R);var Tj=R.extend({data:null}),Uj=R.extend({data:null}),Ni=[9,13,27,32],de=wa&&"CompositionEvent"in window,cc=null;wa&&"documentMode"in document&&(cc=document.documentMode);var Vj=wa&&"TextEvent"in window&&
!cc,xg=wa&&(!de||cc&&8<cc&&11>=cc),wg=String.fromCharCode(32),ua={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},
dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},vg=!1,mb=!1,Wj={eventTypes:ua,extractEvents:function(a,b,c,d,e){var f;if(de)b:{switch(a){case "compositionstart":var g=ua.compositionStart;break b;case "compositionend":g=ua.compositionEnd;break b;case "compositionupdate":g=
ua.compositionUpdate;break b}g=void 0}else mb?tg(a,c)&&(g=ua.compositionEnd):"keydown"===a&&229===c.keyCode&&(g=ua.compositionStart);g?(xg&&"ko"!==c.locale&&(mb||g!==ua.compositionStart?g===ua.compositionEnd&&mb&&(f=rg()):(Ba=d,ce="value"in Ba?Ba.value:Ba.textContent,mb=!0)),e=Tj.getPooled(g,b,c,d),f?e.data=f:(f=ug(c),null!==f&&(e.data=f)),lb(e),f=e):f=null;(a=Vj?Oi(a,c):Pi(a,c))?(b=Uj.getPooled(ua.beforeInput,b,c,d),b.data=a,lb(b)):b=null;return null===f?b:null===b?f:[f,b]}},Qi={color:!0,date:!0,
datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},Ag={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}},Mb=null,Nb=null,kf=!1;wa&&(kf=Tf("input")&&(!document.documentMode||9<document.documentMode));var Xj={eventTypes:Ag,_isInputEventSupported:kf,extractEvents:function(a,b,c,d,e){e=b?Pa(b):window;var f=
e.nodeName&&e.nodeName.toLowerCase();if("select"===f||"input"===f&&"file"===e.type)var g=Si;else if(yg(e))if(kf)g=Wi;else{g=Ui;var h=Ti}else(f=e.nodeName)&&"input"===f.toLowerCase()&&("checkbox"===e.type||"radio"===e.type)&&(g=Vi);if(g&&(g=g(a,b)))return zg(g,c,d);h&&h(a,e,b);"blur"===a&&(a=e._wrapperState)&&a.controlled&&"number"===e.type&&Ed(e,"number",e.value)}},dc=R.extend({view:null,detail:null}),Yi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"},di=0,ei=0,fi=!1,gi=!1,ec=dc.extend({screenX:null,
screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:fe,button:null,buttons:null,relatedTarget:function(a){return a.relatedTarget||(a.fromElement===a.srcElement?a.toElement:a.fromElement)},movementX:function(a){if("movementX"in a)return a.movementX;var b=di;di=a.screenX;return fi?"mousemove"===a.type?a.screenX-b:0:(fi=!0,0)},movementY:function(a){if("movementY"in a)return a.movementY;var b=ei;ei=a.screenY;return gi?"mousemove"===
a.type?a.screenY-b:0:(gi=!0,0)}}),hi=ec.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),fc={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout",
"pointerover"]}},Yj={eventTypes:fc,extractEvents:function(a,b,c,d,e){var f="mouseover"===a||"pointerover"===a,g="mouseout"===a||"pointerout"===a;if(f&&0===(e&32)&&(c.relatedTarget||c.fromElement)||!g&&!f)return null;f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window;if(g){if(g=b,b=(b=c.relatedTarget||c.toElement)?Bb(b):null,null!==b){var h=Na(b);if(b!==h||5!==b.tag&&6!==b.tag)b=null}}else g=null;if(g===b)return null;if("mouseout"===a||"mouseover"===a){var m=ec;var n=fc.mouseLeave;
var l=fc.mouseEnter;var k="mouse"}else if("pointerout"===a||"pointerover"===a)m=hi,n=fc.pointerLeave,l=fc.pointerEnter,k="pointer";a=null==g?f:Pa(g);f=null==b?f:Pa(b);n=m.getPooled(n,g,c,d);n.type=k+"leave";n.target=a;n.relatedTarget=f;c=m.getPooled(l,b,c,d);c.type=k+"enter";c.target=f;c.relatedTarget=a;d=g;k=b;if(d&&k)a:{m=d;l=k;g=0;for(a=m;a;a=pa(a))g++;a=0;for(b=l;b;b=pa(b))a++;for(;0<g-a;)m=pa(m),g--;for(;0<a-g;)l=pa(l),a--;for(;g--;){if(m===l||m===l.alternate)break a;m=pa(m);l=pa(l)}m=null}else m=
null;l=m;for(m=[];d&&d!==l;){g=d.alternate;if(null!==g&&g===l)break;m.push(d);d=pa(d)}for(d=[];k&&k!==l;){g=k.alternate;if(null!==g&&g===l)break;d.push(k);k=pa(k)}for(k=0;k<m.length;k++)be(m[k],"bubbled",n);for(k=d.length;0<k--;)be(d[k],"captured",c);return 0===(e&64)?[n]:[n,c]}},Qa="function"===typeof Object.is?Object.is:Zi,$i=Object.prototype.hasOwnProperty,Zj=wa&&"documentMode"in document&&11>=document.documentMode,Eg={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},
dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},nb=null,he=null,Pb=null,ge=!1,ak={eventTypes:Eg,extractEvents:function(a,b,c,d,e,f){e=f||(d.window===d?d.document:9===d.nodeType?d:d.ownerDocument);if(!(f=!e)){a:{e=Jd(e);f=rd.onSelect;for(var g=0;g<f.length;g++)if(!e.has(f[g])){e=!1;break a}e=!0}f=!e}if(f)return null;e=b?Pa(b):window;switch(a){case "focus":if(yg(e)||"true"===e.contentEditable)nb=e,he=b,Pb=null;break;case "blur":Pb=he=nb=null;
break;case "mousedown":ge=!0;break;case "contextmenu":case "mouseup":case "dragend":return ge=!1,Dg(c,d);case "selectionchange":if(Zj)break;case "keydown":case "keyup":return Dg(c,d)}return null}},bk=R.extend({animationName:null,elapsedTime:null,pseudoElement:null}),ck=R.extend({clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),dk=dc.extend({relatedTarget:null}),ek={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",
Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",
224:"Meta"},gk=dc.extend({key:function(a){if(a.key){var b=ek[a.key]||a.key;if("Unidentified"!==b)return b}return"keypress"===a.type?(a=Ac(a),13===a?"Enter":String.fromCharCode(a)):"keydown"===a.type||"keyup"===a.type?fk[a.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:fe,charCode:function(a){return"keypress"===a.type?Ac(a):0},keyCode:function(a){return"keydown"===a.type||"keyup"===a.type?a.keyCode:0},which:function(a){return"keypress"===
a.type?Ac(a):"keydown"===a.type||"keyup"===a.type?a.keyCode:0}}),hk=ec.extend({dataTransfer:null}),ik=dc.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:fe}),jk=R.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),kk=ec.extend({deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?
-a.wheelDelta:0},deltaZ:null,deltaMode:null}),lk={eventTypes:dg,extractEvents:function(a,b,c,d,e){e=cg.get(a);if(!e)return null;switch(a){case "keypress":if(0===Ac(c))return null;case "keydown":case "keyup":a=gk;break;case "blur":case "focus":a=dk;break;case "click":if(2===c.button)return null;case "auxclick":case "dblclick":case "mousedown":case "mousemove":case "mouseup":case "mouseout":case "mouseover":case "contextmenu":a=ec;break;case "drag":case "dragend":case "dragenter":case "dragexit":case "dragleave":case "dragover":case "dragstart":case "drop":a=
hk;break;case "touchcancel":case "touchend":case "touchmove":case "touchstart":a=ik;break;case $h:case ai:case bi:a=bk;break;case ci:a=jk;break;case "scroll":a=dc;break;case "wheel":a=kk;break;case "copy":case "cut":case "paste":a=ck;break;case "gotpointercapture":case "lostpointercapture":case "pointercancel":case "pointerdown":case "pointermove":case "pointerout":case "pointerover":case "pointerup":a=hi;break;default:a=R}b=a.getPooled(e,b,c,d);lb(b);return b}};(function(a){if(ic)throw Error(k(101));
ic=Array.prototype.slice.call(a);nf()})("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" "));(function(a,b,c){td=a;rf=b;mf=c})(ae,Hb,Pa);pf({SimpleEventPlugin:lk,EnterLeaveEventPlugin:Yj,ChangeEventPlugin:Xj,SelectEventPlugin:ak,BeforeInputEventPlugin:Wj});var ie=[],ob=-1,Ca={},B={current:Ca},G={current:!1},Ra=Ca,bj=Pd,je=$f,Rg=Lj,aj=Nj,Dc=Oj,Ig=Zh,Jg=ag,Kg=Pj,Lg=Qj,Qg={},yj=Mj,Cj=void 0!==Yh?Yh:function(){},qa=null,
Ec=null,ke=!1,ii=ff(),Y=1E4>ii?ff:function(){return ff()-ii},Ic={current:null},Hc=null,qb=null,Gc=null,Tg=0,Jc=2,Ga=!1,Vb=da.ReactCurrentBatchConfig,$g=(new ea.Component).refs,Mc={isMounted:function(a){return(a=a._reactInternalFiber)?Na(a)===a:!1},enqueueSetState:function(a,b,c){a=a._reactInternalFiber;var d=ka(),e=Vb.suspense;d=Va(d,a,e);e=Ea(d,e);e.payload=b;void 0!==c&&null!==c&&(e.callback=c);Fa(a,e);Ja(a,d)},enqueueReplaceState:function(a,b,c){a=a._reactInternalFiber;var d=ka(),e=Vb.suspense;
d=Va(d,a,e);e=Ea(d,e);e.tag=1;e.payload=b;void 0!==c&&null!==c&&(e.callback=c);Fa(a,e);Ja(a,d)},enqueueForceUpdate:function(a,b){a=a._reactInternalFiber;var c=ka(),d=Vb.suspense;c=Va(c,a,d);d=Ea(c,d);d.tag=Jc;void 0!==b&&null!==b&&(d.callback=b);Fa(a,d);Ja(a,c)}},Qc=Array.isArray,wb=ah(!0),Fe=ah(!1),Sb={},ja={current:Sb},Ub={current:Sb},Tb={current:Sb},D={current:0},Sc=da.ReactCurrentDispatcher,X=da.ReactCurrentBatchConfig,Ia=0,z=null,K=null,J=null,Uc=!1,Tc={readContext:W,useCallback:S,useContext:S,
useEffect:S,useImperativeHandle:S,useLayoutEffect:S,useMemo:S,useReducer:S,useRef:S,useState:S,useDebugValue:S,useResponder:S,useDeferredValue:S,useTransition:S},dj={readContext:W,useCallback:ih,useContext:W,useEffect:eh,useImperativeHandle:function(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return ze(4,2,gh.bind(null,b,a),c)},useLayoutEffect:function(a,b){return ze(4,2,a,b)},useMemo:function(a,b){var c=ub();b=void 0===b?null:b;a=a();c.memoizedState=[a,b];return a},useReducer:function(a,b,c){var d=
ub();b=void 0!==c?c(b):b;d.memoizedState=d.baseState=b;a=d.queue={pending:null,dispatch:null,lastRenderedReducer:a,lastRenderedState:b};a=a.dispatch=ch.bind(null,z,a);return[d.memoizedState,a]},useRef:function(a){var b=ub();a={current:a};return b.memoizedState=a},useState:xe,useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=xe(a),d=c[0],e=c[1];eh(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=
xe(!1),c=b[0];b=b[1];return[ih(Ce.bind(null,b,a),[b,a]),c]}},ej={readContext:W,useCallback:Yc,useContext:W,useEffect:Xc,useImperativeHandle:hh,useLayoutEffect:fh,useMemo:jh,useReducer:Vc,useRef:dh,useState:function(a){return Vc(Ua)},useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=Vc(Ua),d=c[0],e=c[1];Xc(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=Vc(Ua),c=b[0];b=b[1];return[Yc(Ce.bind(null,
b,a),[b,a]),c]}},fj={readContext:W,useCallback:Yc,useContext:W,useEffect:Xc,useImperativeHandle:hh,useLayoutEffect:fh,useMemo:jh,useReducer:Wc,useRef:dh,useState:function(a){return Wc(Ua)},useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=Wc(Ua),d=c[0],e=c[1];Xc(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=Wc(Ua),c=b[0];b=b[1];return[Yc(Ce.bind(null,b,a),[b,a]),c]}},ra=null,Ka=null,Wa=
!1,gj=da.ReactCurrentOwner,ia=!1,Je={dehydrated:null,retryTime:0};var jj=function(a,b,c,d){for(c=b.child;null!==c;){if(5===c.tag||6===c.tag)a.appendChild(c.stateNode);else if(4!==c.tag&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return}c.sibling.return=c.return;c=c.sibling}};var wh=function(a){};var ij=function(a,b,c,d,e){var f=a.memoizedProps;if(f!==d){var g=b.stateNode;Ta(ja.current);a=null;switch(c){case "input":f=
Cd(g,f);d=Cd(g,d);a=[];break;case "option":f=Fd(g,f);d=Fd(g,d);a=[];break;case "select":f=M({},f,{value:void 0});d=M({},d,{value:void 0});a=[];break;case "textarea":f=Gd(g,f);d=Gd(g,d);a=[];break;default:"function"!==typeof f.onClick&&"function"===typeof d.onClick&&(g.onclick=uc)}Ud(c,d);var h,m;c=null;for(h in f)if(!d.hasOwnProperty(h)&&f.hasOwnProperty(h)&&null!=f[h])if("style"===h)for(m in g=f[h],g)g.hasOwnProperty(m)&&(c||(c={}),c[m]="");else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==
h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(db.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in d){var k=d[h];g=null!=f?f[h]:void 0;if(d.hasOwnProperty(h)&&k!==g&&(null!=k||null!=g))if("style"===h)if(g){for(m in g)!g.hasOwnProperty(m)||k&&k.hasOwnProperty(m)||(c||(c={}),c[m]="");for(m in k)k.hasOwnProperty(m)&&g[m]!==k[m]&&(c||(c={}),c[m]=k[m])}else c||(a||(a=[]),a.push(h,c)),c=k;else"dangerouslySetInnerHTML"===h?(k=k?k.__html:void 0,g=g?g.__html:void 0,null!=k&&g!==k&&(a=a||
[]).push(h,k)):"children"===h?g===k||"string"!==typeof k&&"number"!==typeof k||(a=a||[]).push(h,""+k):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(db.hasOwnProperty(h)?(null!=k&&oa(e,h),a||g===k||(a=[])):(a=a||[]).push(h,k))}c&&(a=a||[]).push("style",c);e=a;if(b.updateQueue=e)b.effectTag|=4}};var kj=function(a,b,c,d){c!==d&&(b.effectTag|=4)};var pj="function"===typeof WeakSet?WeakSet:Set,wj="function"===typeof WeakMap?WeakMap:Map,sj=Math.ceil,gd=da.ReactCurrentDispatcher,
Uh=da.ReactCurrentOwner,H=0,Ye=8,ca=16,ma=32,Xa=0,hd=1,Oh=2,ad=3,bd=4,Xe=5,p=H,U=null,t=null,P=0,F=Xa,id=null,ta=1073741823,Yb=1073741823,kd=null,Xb=0,jd=!1,Re=0,Ph=500,l=null,cd=!1,Se=null,La=null,ld=!1,Zb=null,$b=90,bb=null,ac=0,af=null,dd=0,Ja=function(a,b){if(50<ac)throw ac=0,af=null,Error(k(185));a=ed(a,b);if(null!==a){var c=Cc();1073741823===b?(p&Ye)!==H&&(p&(ca|ma))===H?Te(a):(V(a),p===H&&ha()):V(a);(p&4)===H||98!==c&&99!==c||(null===bb?bb=new Map([[a,b]]):(c=bb.get(a),(void 0===c||c>b)&&bb.set(a,
b)))}};var zj=function(a,b,c){var d=b.expirationTime;if(null!==a){var e=b.pendingProps;if(a.memoizedProps!==e||G.current)ia=!0;else{if(d<c){ia=!1;switch(b.tag){case 3:sh(b);Ee();break;case 5:bh(b);if(b.mode&4&&1!==c&&e.hidden)return b.expirationTime=b.childExpirationTime=1,null;break;case 1:N(b.type)&&Bc(b);break;case 4:se(b,b.stateNode.containerInfo);break;case 10:d=b.memoizedProps.value;e=b.type._context;y(Ic,e._currentValue);e._currentValue=d;break;case 13:if(null!==b.memoizedState){d=b.child.childExpirationTime;
if(0!==d&&d>=c)return th(a,b,c);y(D,D.current&1);b=sa(a,b,c);return null!==b?b.sibling:null}y(D,D.current&1);break;case 19:d=b.childExpirationTime>=c;if(0!==(a.effectTag&64)){if(d)return vh(a,b,c);b.effectTag|=64}e=b.memoizedState;null!==e&&(e.rendering=null,e.tail=null);y(D,D.current);if(!d)return null}return sa(a,b,c)}ia=!1}}else ia=!1;b.expirationTime=0;switch(b.tag){case 2:d=b.type;null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;e=pb(b,B.current);rb(b,c);e=we(null,
b,d,a,e,c);b.effectTag|=1;if("object"===typeof e&&null!==e&&"function"===typeof e.render&&void 0===e.$$typeof){b.tag=1;b.memoizedState=null;b.updateQueue=null;if(N(d)){var f=!0;Bc(b)}else f=!1;b.memoizedState=null!==e.state&&void 0!==e.state?e.state:null;ne(b);var g=d.getDerivedStateFromProps;"function"===typeof g&&Lc(b,d,g,a);e.updater=Mc;b.stateNode=e;e._reactInternalFiber=b;pe(b,d,a,c);b=Ie(null,b,d,!0,f,c)}else b.tag=0,T(null,b,e,c),b=b.child;return b;case 16:a:{e=b.elementType;null!==a&&(a.alternate=
null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;ri(e);if(1!==e._status)throw e._result;e=e._result;b.type=e;f=b.tag=Gj(e);a=aa(e,a);switch(f){case 0:b=He(null,b,e,a,c);break a;case 1:b=rh(null,b,e,a,c);break a;case 11:b=nh(null,b,e,a,c);break a;case 14:b=oh(null,b,e,aa(e.type,a),d,c);break a}throw Error(k(306,e,""));}return b;case 0:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),He(a,b,d,e,c);case 1:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),rh(a,b,d,e,c);
case 3:sh(b);d=b.updateQueue;if(null===a||null===d)throw Error(k(282));d=b.pendingProps;e=b.memoizedState;e=null!==e?e.element:null;oe(a,b);Qb(b,d,null,c);d=b.memoizedState.element;if(d===e)Ee(),b=sa(a,b,c);else{if(e=b.stateNode.hydrate)Ka=kb(b.stateNode.containerInfo.firstChild),ra=b,e=Wa=!0;if(e)for(c=Fe(b,null,d,c),b.child=c;c;)c.effectTag=c.effectTag&-3|1024,c=c.sibling;else T(a,b,d,c),Ee();b=b.child}return b;case 5:return bh(b),null===a&&De(b),d=b.type,e=b.pendingProps,f=null!==a?a.memoizedProps:
null,g=e.children,Yd(d,e)?g=null:null!==f&&Yd(d,f)&&(b.effectTag|=16),qh(a,b),b.mode&4&&1!==c&&e.hidden?(b.expirationTime=b.childExpirationTime=1,b=null):(T(a,b,g,c),b=b.child),b;case 6:return null===a&&De(b),null;case 13:return th(a,b,c);case 4:return se(b,b.stateNode.containerInfo),d=b.pendingProps,null===a?b.child=wb(b,null,d,c):T(a,b,d,c),b.child;case 11:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),nh(a,b,d,e,c);case 7:return T(a,b,b.pendingProps,c),b.child;case 8:return T(a,
b,b.pendingProps.children,c),b.child;case 12:return T(a,b,b.pendingProps.children,c),b.child;case 10:a:{d=b.type._context;e=b.pendingProps;g=b.memoizedProps;f=e.value;var h=b.type._context;y(Ic,h._currentValue);h._currentValue=f;if(null!==g)if(h=g.value,f=Qa(h,f)?0:("function"===typeof d._calculateChangedBits?d._calculateChangedBits(h,f):1073741823)|0,0===f){if(g.children===e.children&&!G.current){b=sa(a,b,c);break a}}else for(h=b.child,null!==h&&(h.return=b);null!==h;){var m=h.dependencies;if(null!==
m){g=h.child;for(var l=m.firstContext;null!==l;){if(l.context===d&&0!==(l.observedBits&f)){1===h.tag&&(l=Ea(c,null),l.tag=Jc,Fa(h,l));h.expirationTime<c&&(h.expirationTime=c);l=h.alternate;null!==l&&l.expirationTime<c&&(l.expirationTime=c);Sg(h.return,c);m.expirationTime<c&&(m.expirationTime=c);break}l=l.next}}else g=10===h.tag?h.type===b.type?null:h.child:h.child;if(null!==g)g.return=h;else for(g=h;null!==g;){if(g===b){g=null;break}h=g.sibling;if(null!==h){h.return=g.return;g=h;break}g=g.return}h=
g}T(a,b,e.children,c);b=b.child}return b;case 9:return e=b.type,f=b.pendingProps,d=f.children,rb(b,c),e=W(e,f.unstable_observedBits),d=d(e),b.effectTag|=1,T(a,b,d,c),b.child;case 14:return e=b.type,f=aa(e,b.pendingProps),f=aa(e.type,f),oh(a,b,e,f,d,c);case 15:return ph(a,b,b.type,b.pendingProps,d,c);case 17:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),b.tag=1,N(d)?(a=!0,Bc(b)):a=!1,rb(b,c),Yg(b,d,e),pe(b,d,e,c),Ie(null,
b,d,!0,a,c);case 19:return vh(a,b,c)}throw Error(k(156,b.tag));};var bf=null,Ne=null,la=function(a,b,c,d){return new Fj(a,b,c,d)};ef.prototype.render=function(a){md(a,this._internalRoot,null,null)};ef.prototype.unmount=function(){var a=this._internalRoot,b=a.containerInfo;md(null,a,null,function(){b[Lb]=null})};var Di=function(a){if(13===a.tag){var b=Fc(ka(),150,100);Ja(a,b);df(a,b)}};var Yf=function(a){13===a.tag&&(Ja(a,3),df(a,3))};var Bi=function(a){if(13===a.tag){var b=ka();b=Va(b,a,null);Ja(a,
b);df(a,b)}};sd=function(a,b,c){switch(b){case "input":Dd(a,c);b=c.name;if("radio"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;c=c.querySelectorAll("input[name="+JSON.stringify(""+b)+'][type="radio"]');for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=ae(d);if(!e)throw Error(k(90));Gf(d);Dd(d,e)}}}break;case "textarea":Lf(a,c);break;case "select":b=c.value,null!=b&&hb(a,!!c.multiple,b,!1)}};(function(a,b,c,d){ee=a;eg=b;vd=c;vf=d})(Qh,function(a,b,c,d,e){var f=p;p|=4;
try{return Da(98,a.bind(null,b,c,d,e))}finally{p=f,p===H&&ha()}},function(){(p&(1|ca|ma))===H&&(uj(),xb())},function(a,b){var c=p;p|=2;try{return a(b)}finally{p=c,p===H&&ha()}});var mk={Events:[Hb,Pa,ae,pf,qd,lb,function(a){Kd(a,Ki)},sf,tf,sc,pc,xb,{current:!1}]};(function(a){var b=a.findFiberByHostInstance;return Ej(M({},a,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:da.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){a=Sf(a);
return null===a?null:a.stateNode},findFiberByHostInstance:function(a){return b?b(a):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))})({findFiberByHostInstance:Bb,bundleType:0,version:"16.13.1",rendererPackageName:"react-dom"});I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mk;I.createPortal=Xh;I.findDOMNode=function(a){if(null==a)return null;if(1===a.nodeType)return a;var b=a._reactInternalFiber;if(void 0===
b){if("function"===typeof a.render)throw Error(k(188));throw Error(k(268,Object.keys(a)));}a=Sf(b);a=null===a?null:a.stateNode;return a};I.flushSync=function(a,b){if((p&(ca|ma))!==H)throw Error(k(187));var c=p;p|=1;try{return Da(99,a.bind(null,b))}finally{p=c,ha()}};I.hydrate=function(a,b,c){if(!bc(b))throw Error(k(200));return nd(null,a,b,!0,c)};I.render=function(a,b,c){if(!bc(b))throw Error(k(200));return nd(null,a,b,!1,c)};I.unmountComponentAtNode=function(a){if(!bc(a))throw Error(k(40));return a._reactRootContainer?
(Rh(function(){nd(null,null,a,!1,function(){a._reactRootContainer=null;a[Lb]=null})}),!0):!1};I.unstable_batchedUpdates=Qh;I.unstable_createPortal=function(a,b){return Xh(a,b,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)};I.unstable_renderSubtreeIntoContainer=function(a,b,c,d){if(!bc(c))throw Error(k(200));if(null==a||void 0===a._reactInternalFiber)throw Error(k(38));return nd(a,b,c,!1,d)};I.version="16.13.1"});
</script>
    <script>const e = React.createElement;

function pathToString(path) {
  if (path[0] === '/') {
    return '/' + path.slice(1).join('/');
  } else {
    return path.join('/');
  }
}

function findCommonPath(files) {
  if (!files || !files.length) {
    return [];
  }

  function isPrefix(arr, prefix) {
    if (arr.length < prefix.length) {
      return false;
    }
    for (let i = prefix.length - 1; i >= 0; --i) {
      if (arr[i] !== prefix[i]) {
        return false;
      }
    }
    return true;
  }

  let commonPath = files[0].path.slice(0, -1);
  while (commonPath.length) {
    if (files.every(file => isPrefix(file.path, commonPath))) {
      break;
    }
    commonPath.pop();
  }
  return commonPath;
}

function findFolders(files) {
  if (!files || !files.length) {
    return [];
  }

  let folders = files.filter(file => file.path.length > 1).map(file => file.path[0]);
  folders = [...new Set(folders)]; // unique
  folders.sort();

  folders = folders.map(folder => {
    let filesInFolder = files
      .filter(file => file.path[0] === folder)
      .map(file => ({
        ...file,
        path: file.path.slice(1),
        parent: [...file.parent, file.path[0]],
      }));

    const children = findFolders(filesInFolder); // recursion

    return {
      is_folder: true,
      path: [folder],
      parent: files[0].parent,
      children,
      covered: children.reduce((sum, file) => sum + file.covered, 0),
      coverable: children.reduce((sum, file) => sum + file.coverable, 0),
      prevRun: {
        covered: children.reduce((sum, file) => sum + file.prevRun.covered, 0),
        coverable: children.reduce((sum, file) => sum + file.prevRun.coverable, 0),
      },
    };
  });

  return [...folders, ...files.filter(file => file.path.length === 1)];
}

class App extends React.Component {
  constructor(...args) {
    super(...args);

    this.state = {
      current: [],
    };
  }

  componentDidMount() {
    this.updateStateFromLocation();
    window.addEventListener('hashchange', () => this.updateStateFromLocation(), false);
  }

  updateStateFromLocation() {
    if (window.location.hash.length > 1) {
      const current = window.location.hash.slice(1).split('/');
      this.setState({current});
    } else {
      this.setState({current: []});
    }
  }

  getCurrentPath() {
    let file = this.props.root;
    let path = [file];
    for (let p of this.state.current) {
      file = file.children.find(file => file.path[0] === p);
      if (!file) {
        return path;
      }
      path.push(file);
    }
    return path;
  }

  render() {
    const path = this.getCurrentPath();
    const file = path[path.length - 1];

    let w = null;
    if (file.is_folder) {
      w = e(FilesList, {
        folder: file,
        onSelectFile: this.selectFile.bind(this),
        onBack: path.length > 1 ? this.back.bind(this) : null,
      });
    } else {
      w = e(DisplayFile, {
        file,
        onBack: this.back.bind(this),
      });
    }

    return e('div', {className: 'app'}, w);
  }

  selectFile(file) {
    this.setState(
      ({current}) => {
        return {current: [...current, file.path[0]]};
      },
      () => this.updateHash(),
    );
  }

  back(file) {
    this.setState(
      ({current}) => {
        return {current: current.slice(0, current.length - 1)};
      },
      () => this.updateHash(),
    );
  }

  updateHash() {
    if (!this.state.current || !this.state.current.length) {
      window.location = '#';
    } else {
      window.location = '#' + this.state.current.join('/');
    }
  }
}

function FilesList({folder, onSelectFile, onBack}) {
  let files = folder.children;
  return e(
    'div',
    {className: 'display-folder'},
    e(FileHeader, {file: folder, onBack}),
    e(
      'table',
      {className: 'files-list'},
      e('thead', {className: 'files-list__head'}, e('tr', null, e('th', null, 'Path'), e('th', null, 'Coverage'))),
      e(
        'tbody',
        {className: 'files-list__body'},
        files.map(file => e(File, {file, onClick: onSelectFile})),
      ),
    ),
  );
}

function File({file, onClick}) {
  const coverage = file.coverable ? (file.covered / file.coverable) * 100 : -1;
  const coverageDelta =
    file.prevRun && (file.covered / file.coverable) * 100 - (file.prevRun.covered / file.prevRun.coverable) * 100;

  return e(
    'tr',
    {
      className:
        'files-list__file' +
        (coverage >= 0 && coverage < 50 ? ' files-list__file_low' : '') +
        (coverage >= 50 && coverage < 80 ? ' files-list__file_medium' : '') +
        (coverage >= 80 ? ' files-list__file_high' : '') +
        (file.is_folder ? ' files-list__file_folder' : ''),
      onClick: () => onClick(file),
    },
    e('td', null, e('a', null, pathToString(file.path))),
    e(
      'td',
      null,
      file.covered + ' / ' + file.coverable + (coverage >= 0 ? ' (' + coverage.toFixed(2) + '%)' : ''),
      e(
        'span',
        {title: 'Change from the previous run'},
        coverageDelta ? ` (${coverageDelta > 0 ? '+' : ''}${coverageDelta.toFixed(2)}%)` : '',
      ),
    ),
  );
}

function DisplayFile({file, onBack}) {
  return e('div', {className: 'display-file'}, e(FileHeader, {file, onBack}), e(FileContent, {file}));
}

function FileHeader({file, onBack}) {
  const coverage = (file.covered / file.coverable) * 100;
  const coverageDelta = file.prevRun && coverage - (file.prevRun.covered / file.prevRun.coverable) * 100;

  return e(
    'div',
    {className: 'file-header'},
    onBack ? e('a', {className: 'file-header__back', onClick: onBack}, 'Back') : null,
    e('div', {className: 'file-header__name'}, pathToString([...file.parent, ...file.path])),
    e(
      'div',
      {className: 'file-header__stat'},
      'Covered: ' + file.covered + ' of ' + file.coverable + (file.coverable ? ' (' + coverage.toFixed(2) + '%)' : ''),
      e(
        'span',
        {title: 'Change from the previous run'},
        coverageDelta ? ` (${coverageDelta > 0 ? '+' : ''}${coverageDelta.toFixed(2)}%)` : '',
      ),
      e('input', {id: 'theme-toggle', type: 'checkbox', hidden: true}),
      e('label', {for: 'theme-toggle', id: 'theme-toggle-label'}, '🌙'),
    ),
  );
}

function FileContent({file}) {
  return e(
    'pre',
    {className: 'file-content'},
    file.content.split(/\r?\n/).map((line, index) => {
      const trace = file.traces.find(trace => trace.line === index + 1);
      const covered = trace && trace.stats.Line;
      const uncovered = trace && !trace.stats.Line;
      const nbHit = covered? trace.stats.Line: 0;
      return e(
        'div',
        { className: 'code-text-container' },
        e(
          'code',
          {
            className: 'code-line' + (covered ? ' code-line_covered' : '') + (uncovered ? ' code-line_uncovered' : ''),
          },
          line
        ),
        e(
          'div',
          { className: 'cover-indicator' + (covered? ' check-cover': '') + (uncovered? ' no-cover': '')},
          e(
            'div',
            { className: (covered? 'stat-line-hit': '')},
            covered? nbHit: ""
          )
        )
      );
    }),
  );
}

(function () {
  const commonPath = findCommonPath(data.files);
  const prevFilesMap = new Map();

  previousData &&
    previousData.files.forEach(file => {
      const path = file.path.slice(commonPath.length).join('/');
      prevFilesMap.set(path, file);
    });

  const files = data.files.map(file => {
    const path = file.path.slice(commonPath.length);
    const {covered = 0, coverable = 0} = prevFilesMap.get(path.join('/')) || {};
    return {
      ...file,
      path,
      parent: commonPath,
      prevRun: {covered, coverable},
    };
  });

  const children = findFolders(files);

  const root = {
    is_folder: true,
    children,
    path: commonPath,
    parent: [],
    covered: children.reduce((sum, file) => sum + file.covered, 0),
    coverable: children.reduce((sum, file) => sum + file.coverable, 0),
    prevRun: {
      covered: children.reduce((sum, file) => sum + file.prevRun.covered, 0),
      coverable: children.reduce((sum, file) => sum + file.prevRun.coverable, 0),
    },
  };

  ReactDOM.render(e(App, {root, prevFilesMap}), document.getElementById('root'));

  const toggle = document.getElementById('theme-toggle');
  const label = document.getElementById('theme-toggle-label');
  label.textContent = '🌙';

  toggle.addEventListener('change', () => {
    if (toggle.checked) {
      document.documentElement.setAttribute('data-theme', 'dark');
      label.textContent = '☀️';
    } else {
      document.documentElement.removeAttribute('data-theme');
      label.textContent = '🌙';
    }
  });
})();
</script>
</body>
</html>